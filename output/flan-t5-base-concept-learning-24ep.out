
{'loss': 0.0371, 'grad_norm': 0.13824481753574328, 'learning_rate': 5e-05, 'epoch': 3.94}
{'loss': 0.0368, 'grad_norm': 0.10383374886390703, 'learning_rate': 5e-05, 'epoch': 3.95}
{'loss': 0.0371, 'grad_norm': 0.15800122340436398, 'learning_rate': 5e-05, 'epoch': 3.96}
{'loss': 0.0385, 'grad_norm': 0.1045405151340953, 'learning_rate': 5e-05, 'epoch': 3.98}
{'loss': 0.037, 'grad_norm': 0.14596501788352195, 'learning_rate': 5e-05, 'epoch': 3.99}
 17%|█████████████████████████████████████▏                                                                                                                                                                                         | 2988/17928 [1:19:36<4:24:08,  1.06s/it][INFO|gner_trainer.py:60] 2024-11-19 20:41:24,551 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 20:41:24,551 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 20:41:24,551 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3597.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3622.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3613.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3620.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3631.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4052.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3630.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3633.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4076.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4040.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4070.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1385.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4055.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4068.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4045.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4060.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1382.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1384.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1078.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1082.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1080.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 981.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 965.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 950.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 946.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.20it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 950.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 943.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1069.00it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.37it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.20it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.15it/s]
{'eval_mit-movie_precision': 0.4145664739884297, 'eval_mit-movie_recall': 0.3358306799025972, 'eval_mit-movie_f1': 0.37106788074524477, 'eval_mit-restaurant_precision': 0.36876355748371104, 'eval_mit-restaurant_recall': 0.21587301587300903, 'eval_mit-restaurant_f1': 0.2723267921039893, 'eval_crossner_ai_precision': 0.3225270157938353, 'eval_crossner_ai_recall': 0.48288736776599356, 'eval_crossner_ai_f1': 0.38674308492579784, 'eval_crossner_literature_precision': 0.38042620363060853, 'eval_crossner_literature_recall': 0.48637739656909756, 'eval_crossner_literature_f1': 0.42692648356454566, 'eval_crossner_music_precision': 0.5226089339544937, 'eval_crossner_music_recall': 0.6104353393085592, 'eval_crossner_music_f1': 0.5631182636443631, 'eval_crossner_politics_precision': 0.4841685888026738, 'eval_crossner_politics_recall': 0.5920512820512669, 'eval_crossner_politics_f1': 0.5327027338298304, 'eval_crossner_science_precision': 0.4926450180405081, 'eval_crossner_science_recall': 0.7015810276679565, 'eval_crossner_science_f1': 0.5788358062453319, 'eval_wiki_passage_from_zero_precision': 0.7726502716280141, 'eval_wiki_passage_from_zero_recall': 0.7952104208416817, 'eval_wiki_passage_from_zero_f1': 0.783768035740127, 'eval_average_f1': 0.48943613509990375, 'eval_runtime': 508.9981, 'eval_samples_per_second': 26.878, 'eval_steps_per_second': 0.106, 'epoch': 4.0}
 17%|█████████████████████████████████████▏                                                                                                                                                                                         | 2988/17928 [1:28:05<4:24:08,  1.06s/it]
[INFO|trainer.py:3812] 2024-11-19 20:49:53,945 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-2988
[INFO|configuration_utils.py:414] 2024-11-19 20:49:53,947 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-2988/config.json
[INFO|configuration_utils.py:865] 2024-11-19 20:49:53,947 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-2988/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 20:49:54,507 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-2988/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 20:49:54,509 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-2988/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 20:49:54,509 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-2988/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 20:49:54,510 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-2988/spiece.model
[2024-11-19 20:49:54,528] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step2988 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 20:49:54,534] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/mp_rank_00_model_states.pt
[2024-11-19 20:49:54,534] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/mp_rank_00_model_states.pt...
[2024-11-19 20:49:55,184] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/mp_rank_00_model_states.pt.
[2024-11-19 20:49:55,185] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 20:49:55,795] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 20:49:55,795] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-2988/global_step2988/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 20:49:55,795] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2988 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0373, 'grad_norm': 0.13215797087729936, 'learning_rate': 5e-05, 'epoch': 4.0}
{'loss': 0.0367, 'grad_norm': 0.09764123324331292, 'learning_rate': 5e-05, 'epoch': 4.02}
{'loss': 0.0372, 'grad_norm': 0.08631282903911015, 'learning_rate': 5e-05, 'epoch': 4.03}
{'loss': 0.0369, 'grad_norm': 0.15638347527561286, 'learning_rate': 5e-05, 'epoch': 4.04}
{'loss': 0.0372, 'grad_norm': 0.15105534702588136, 'learning_rate': 5e-05, 'epoch': 4.06}
{'loss': 0.0364, 'grad_norm': 0.14603909525827288, 'learning_rate': 5e-05, 'epoch': 4.07}
{'loss': 0.0369, 'grad_norm': 0.10801202186397636, 'learning_rate': 5e-05, 'epoch': 4.08}
{'loss': 0.0361, 'grad_norm': 0.14033128609456133, 'learning_rate': 5e-05, 'epoch': 4.1}
{'loss': 0.038, 'grad_norm': 0.1513998181027034, 'learning_rate': 5e-05, 'epoch': 4.11}
{'loss': 0.0364, 'grad_norm': 0.16925332761378295, 'learning_rate': 5e-05, 'epoch': 4.12}
{'loss': 0.0373, 'grad_norm': 0.08784225775453063, 'learning_rate': 5e-05, 'epoch': 4.14}
{'loss': 0.0358, 'grad_norm': 0.12177245612840243, 'learning_rate': 5e-05, 'epoch': 4.15}
{'loss': 0.0366, 'grad_norm': 0.2817701986074203, 'learning_rate': 5e-05, 'epoch': 4.16}
{'loss': 0.0358, 'grad_norm': 0.19825396009545213, 'learning_rate': 5e-05, 'epoch': 4.18}
{'loss': 0.0377, 'grad_norm': 0.12782020106117525, 'learning_rate': 5e-05, 'epoch': 4.19}
{'loss': 0.0362, 'grad_norm': 0.154472010243727, 'learning_rate': 5e-05, 'epoch': 4.2}
{'loss': 0.037, 'grad_norm': 0.1302436963380042, 'learning_rate': 5e-05, 'epoch': 4.22}
{'loss': 0.0353, 'grad_norm': 0.11312623351963114, 'learning_rate': 5e-05, 'epoch': 4.23}
{'loss': 0.0368, 'grad_norm': 0.16871972540976013, 'learning_rate': 5e-05, 'epoch': 4.24}
{'loss': 0.0365, 'grad_norm': 0.11755708192486025, 'learning_rate': 5e-05, 'epoch': 4.26}
{'loss': 0.0378, 'grad_norm': 0.09558335419637712, 'learning_rate': 5e-05, 'epoch': 4.27}
{'loss': 0.0367, 'grad_norm': 0.09571378025762034, 'learning_rate': 5e-05, 'epoch': 4.28}
{'loss': 0.0362, 'grad_norm': 0.11069655714560964, 'learning_rate': 5e-05, 'epoch': 4.3}
{'loss': 0.0362, 'grad_norm': 0.10327673734106484, 'learning_rate': 5e-05, 'epoch': 4.31}
{'loss': 0.036, 'grad_norm': 0.20582494538284574, 'learning_rate': 5e-05, 'epoch': 4.32}
{'loss': 0.0372, 'grad_norm': 0.16272710395681517, 'learning_rate': 5e-05, 'epoch': 4.34}
{'loss': 0.0376, 'grad_norm': 0.09455231242761318, 'learning_rate': 5e-05, 'epoch': 4.35}
{'loss': 0.0366, 'grad_norm': 0.13850823673697785, 'learning_rate': 5e-05, 'epoch': 4.36}
{'loss': 0.037, 'grad_norm': 0.10729519136512516, 'learning_rate': 5e-05, 'epoch': 4.38}
{'loss': 0.0369, 'grad_norm': 0.12651105353157283, 'learning_rate': 5e-05, 'epoch': 4.39}
{'loss': 0.0366, 'grad_norm': 0.17752022470176584, 'learning_rate': 5e-05, 'epoch': 4.4}
{'loss': 0.0363, 'grad_norm': 0.14633449516137487, 'learning_rate': 5e-05, 'epoch': 4.42}
{'loss': 0.036, 'grad_norm': 0.09509056490291008, 'learning_rate': 5e-05, 'epoch': 4.43}
{'loss': 0.0356, 'grad_norm': 0.08678990776037743, 'learning_rate': 5e-05, 'epoch': 4.44}
{'loss': 0.0357, 'grad_norm': 0.14105379771456664, 'learning_rate': 5e-05, 'epoch': 4.46}
{'loss': 0.0358, 'grad_norm': 0.11725481801870417, 'learning_rate': 5e-05, 'epoch': 4.47}
{'loss': 0.0366, 'grad_norm': 0.168220785589656, 'learning_rate': 5e-05, 'epoch': 4.48}
{'loss': 0.0358, 'grad_norm': 0.14155742351953876, 'learning_rate': 5e-05, 'epoch': 4.5}
{'loss': 0.0359, 'grad_norm': 0.2382316459553994, 'learning_rate': 5e-05, 'epoch': 4.51}
{'loss': 0.0355, 'grad_norm': 0.0933494055783972, 'learning_rate': 5e-05, 'epoch': 4.52}
{'loss': 0.0358, 'grad_norm': 0.13010767781422075, 'learning_rate': 5e-05, 'epoch': 4.54}
{'loss': 0.0354, 'grad_norm': 0.22829854876167274, 'learning_rate': 5e-05, 'epoch': 4.55}
{'loss': 0.0357, 'grad_norm': 0.15973030413403433, 'learning_rate': 5e-05, 'epoch': 4.56}
{'loss': 0.0365, 'grad_norm': 0.09552031203155095, 'learning_rate': 5e-05, 'epoch': 4.58}
{'loss': 0.0352, 'grad_norm': 0.20294539140255616, 'learning_rate': 5e-05, 'epoch': 4.59}
{'loss': 0.0369, 'grad_norm': 0.07580254036922121, 'learning_rate': 5e-05, 'epoch': 4.61}
{'loss': 0.0352, 'grad_norm': 0.10143384212032026, 'learning_rate': 5e-05, 'epoch': 4.62}
{'loss': 0.0365, 'grad_norm': 0.12449039949893242, 'learning_rate': 5e-05, 'epoch': 4.63}
{'loss': 0.0358, 'grad_norm': 0.08698306130876267, 'learning_rate': 5e-05, 'epoch': 4.65}
{'loss': 0.0351, 'grad_norm': 0.12070516180276682, 'learning_rate': 5e-05, 'epoch': 4.66}
{'loss': 0.0361, 'grad_norm': 0.10484650514453346, 'learning_rate': 5e-05, 'epoch': 4.67}
{'loss': 0.0352, 'grad_norm': 0.10079993473991768, 'learning_rate': 5e-05, 'epoch': 4.69}
{'loss': 0.035, 'grad_norm': 0.1284988859110714, 'learning_rate': 5e-05, 'epoch': 4.7}
{'loss': 0.036, 'grad_norm': 0.21324174256565728, 'learning_rate': 5e-05, 'epoch': 4.71}
{'loss': 0.0364, 'grad_norm': 0.15104524769867803, 'learning_rate': 5e-05, 'epoch': 4.73}
{'loss': 0.0346, 'grad_norm': 0.15450290011026577, 'learning_rate': 5e-05, 'epoch': 4.74}
{'loss': 0.0367, 'grad_norm': 0.16471620163007392, 'learning_rate': 5e-05, 'epoch': 4.75}
{'loss': 0.0357, 'grad_norm': 0.124552630266759, 'learning_rate': 5e-05, 'epoch': 4.77}
{'loss': 0.0357, 'grad_norm': 0.10596879990435061, 'learning_rate': 5e-05, 'epoch': 4.78}
{'loss': 0.0359, 'grad_norm': 0.13169142255205055, 'learning_rate': 5e-05, 'epoch': 4.79}
{'loss': 0.0364, 'grad_norm': 0.16830555836782884, 'learning_rate': 5e-05, 'epoch': 4.81}
{'loss': 0.0359, 'grad_norm': 0.10216612434800748, 'learning_rate': 5e-05, 'epoch': 4.82}
{'loss': 0.0367, 'grad_norm': 0.16257028664387024, 'learning_rate': 5e-05, 'epoch': 4.83}
{'loss': 0.036, 'grad_norm': 0.10078187949701109, 'learning_rate': 5e-05, 'epoch': 4.85}
{'loss': 0.0363, 'grad_norm': 0.13668495169175415, 'learning_rate': 5e-05, 'epoch': 4.86}
{'loss': 0.0357, 'grad_norm': 0.10511224593331321, 'learning_rate': 5e-05, 'epoch': 4.87}
{'loss': 0.0358, 'grad_norm': 0.12487077739142205, 'learning_rate': 5e-05, 'epoch': 4.89}
{'loss': 0.0352, 'grad_norm': 0.11237436703693571, 'learning_rate': 5e-05, 'epoch': 4.9}
{'loss': 0.0357, 'grad_norm': 0.13678348234968263, 'learning_rate': 5e-05, 'epoch': 4.91}
{'loss': 0.035, 'grad_norm': 0.12045353033230419, 'learning_rate': 5e-05, 'epoch': 4.93}
{'loss': 0.0351, 'grad_norm': 0.08961885230043057, 'learning_rate': 5e-05, 'epoch': 4.94}
{'loss': 0.0351, 'grad_norm': 0.11017561279051367, 'learning_rate': 5e-05, 'epoch': 4.95}
{'loss': 0.0352, 'grad_norm': 0.13040031505666233, 'learning_rate': 5e-05, 'epoch': 4.97}
{'loss': 0.0365, 'grad_norm': 0.11124474766205296, 'learning_rate': 5e-05, 'epoch': 4.98}
{'loss': 0.0353, 'grad_norm': 0.11191680515383823, 'learning_rate': 5e-05, 'epoch': 4.99}
 21%|██████████████████████████████████████████████▍                                                                                                                                                                                | 3735/17928 [1:41:32<4:30:04,  1.14s/it][INFO|gner_trainer.py:60] 2024-11-19 21:03:20,083 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 21:03:20,084 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 21:03:20,084 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3616.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3592.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3660.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3638.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3592.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3618.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3645.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4063.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4081.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4036.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4074.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4043.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4069.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4052.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4073.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1377.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1398.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1327.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1344.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1393.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1369.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1079.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1086.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1084.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1102.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 967.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 966.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 944.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 949.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 941.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.29it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.67it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.55it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.56it/s]
{'eval_mit-movie_precision': 0.4400194269062545, 'eval_mit-movie_recall': 0.3393893987638071, 'eval_mit-movie_f1': 0.3832082055128429, 'eval_mit-restaurant_precision': 0.382048331415398, 'eval_mit-restaurant_recall': 0.2107936507936441, 'eval_mit-restaurant_f1': 0.2716857610016244, 'eval_crossner_ai_precision': 0.36062132661627366, 'eval_crossner_ai_recall': 0.5345364032358099, 'eval_crossner_ai_f1': 0.430684382002505, 'eval_crossner_literature_precision': 0.39976689976688423, 'eval_crossner_literature_recall': 0.5191725529767649, 'eval_crossner_literature_f1': 0.45171202804564436, 'eval_crossner_music_precision': 0.541598694942889, 'eval_crossner_music_recall': 0.6376440460947299, 'eval_crossner_music_f1': 0.585710085219353, 'eval_crossner_politics_precision': 0.48592436974788894, 'eval_crossner_politics_recall': 0.5930769230769078, 'eval_crossner_politics_f1': 0.53418013851861, 'eval_crossner_science_precision': 0.500984528832616, 'eval_crossner_science_recall': 0.7039525691699327, 'eval_crossner_science_f1': 0.5853738701239549, 'eval_wiki_passage_from_zero_precision': 0.8148124763227663, 'eval_wiki_passage_from_zero_recall': 0.7758517034068121, 'eval_wiki_passage_from_zero_f1': 0.7948549489306678, 'eval_average_f1': 0.5046761774194003, 'eval_runtime': 510.9771, 'eval_samples_per_second': 26.774, 'eval_steps_per_second': 0.106, 'epoch': 5.0}
 21%|██████████████████████████████████████████████▍                                                                                                                                                                                | 3735/17928 [1:50:03<4:30:04,  1.14s/it]
[INFO|trainer.py:3812] 2024-11-19 21:11:51,442 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-3735
[INFO|configuration_utils.py:414] 2024-11-19 21:11:51,444 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-3735/config.json
[INFO|configuration_utils.py:865] 2024-11-19 21:11:51,444 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-3735/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 21:11:52,004 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-3735/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 21:11:52,006 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-3735/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 21:11:52,006 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-3735/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 21:11:52,007 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-3735/spiece.model
[2024-11-19 21:11:52,023] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step3735 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 21:11:52,029] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/mp_rank_00_model_states.pt
[2024-11-19 21:11:52,029] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/mp_rank_00_model_states.pt...
[2024-11-19 21:11:52,669] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/mp_rank_00_model_states.pt.
[2024-11-19 21:11:52,671] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 21:11:53,252] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 21:11:53,252] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-3735/global_step3735/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 21:11:53,253] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step3735 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0357, 'grad_norm': 0.10170540475978775, 'learning_rate': 5e-05, 'epoch': 5.01}
{'loss': 0.0347, 'grad_norm': 0.09735524996707784, 'learning_rate': 5e-05, 'epoch': 5.02}
{'loss': 0.0347, 'grad_norm': 0.11282479056114479, 'learning_rate': 5e-05, 'epoch': 5.03}
{'loss': 0.0349, 'grad_norm': 0.11500946013785869, 'learning_rate': 5e-05, 'epoch': 5.05}
{'loss': 0.0349, 'grad_norm': 0.13325909951498693, 'learning_rate': 5e-05, 'epoch': 5.06}
{'loss': 0.0354, 'grad_norm': 0.13379548746539116, 'learning_rate': 5e-05, 'epoch': 5.07}
{'loss': 0.0352, 'grad_norm': 0.08292956591205065, 'learning_rate': 5e-05, 'epoch': 5.09}
{'loss': 0.0353, 'grad_norm': 0.07363692722409426, 'learning_rate': 5e-05, 'epoch': 5.1}
{'loss': 0.0353, 'grad_norm': 0.10004773174260431, 'learning_rate': 5e-05, 'epoch': 5.11}
{'loss': 0.0352, 'grad_norm': 0.13907850446650355, 'learning_rate': 5e-05, 'epoch': 5.13}
{'loss': 0.0347, 'grad_norm': 0.1101527194884497, 'learning_rate': 5e-05, 'epoch': 5.14}
{'loss': 0.0346, 'grad_norm': 0.07317777980640434, 'learning_rate': 5e-05, 'epoch': 5.15}
{'loss': 0.0356, 'grad_norm': 0.12375370867185931, 'learning_rate': 5e-05, 'epoch': 5.17}
{'loss': 0.0343, 'grad_norm': 0.08522909694854261, 'learning_rate': 5e-05, 'epoch': 5.18}
{'loss': 0.0354, 'grad_norm': 0.10966303908562242, 'learning_rate': 5e-05, 'epoch': 5.19}
{'loss': 0.0352, 'grad_norm': 0.11782686340745246, 'learning_rate': 5e-05, 'epoch': 5.21}
{'loss': 0.0342, 'grad_norm': 0.11056084325583117, 'learning_rate': 5e-05, 'epoch': 5.22}
{'loss': 0.035, 'grad_norm': 0.12310738816384671, 'learning_rate': 5e-05, 'epoch': 5.23}
{'loss': 0.035, 'grad_norm': 0.17234595214356796, 'learning_rate': 5e-05, 'epoch': 5.25}
{'loss': 0.0352, 'grad_norm': 0.11589002778669724, 'learning_rate': 5e-05, 'epoch': 5.26}
{'loss': 0.0345, 'grad_norm': 0.09257073594233989, 'learning_rate': 5e-05, 'epoch': 5.27}
{'loss': 0.0345, 'grad_norm': 0.12440997810186924, 'learning_rate': 5e-05, 'epoch': 5.29}
{'loss': 0.0345, 'grad_norm': 0.08519068708461267, 'learning_rate': 5e-05, 'epoch': 5.3}
{'loss': 0.0344, 'grad_norm': 0.1558006142391454, 'learning_rate': 5e-05, 'epoch': 5.31}
{'loss': 0.0343, 'grad_norm': 0.10252365268991949, 'learning_rate': 5e-05, 'epoch': 5.33}
{'loss': 0.0344, 'grad_norm': 0.10902030089488475, 'learning_rate': 5e-05, 'epoch': 5.34}
{'loss': 0.035, 'grad_norm': 0.09524247673284261, 'learning_rate': 5e-05, 'epoch': 5.35}
{'loss': 0.0345, 'grad_norm': 0.11717171165286036, 'learning_rate': 5e-05, 'epoch': 5.37}
{'loss': 0.0347, 'grad_norm': 0.08717413364006701, 'learning_rate': 5e-05, 'epoch': 5.38}
{'loss': 0.0352, 'grad_norm': 0.11591573695385982, 'learning_rate': 5e-05, 'epoch': 5.39}
{'loss': 0.0337, 'grad_norm': 0.11270896045545013, 'learning_rate': 5e-05, 'epoch': 5.41}
{'loss': 0.0345, 'grad_norm': 0.15594385075871864, 'learning_rate': 5e-05, 'epoch': 5.42}
{'loss': 0.0338, 'grad_norm': 0.13916761144109882, 'learning_rate': 5e-05, 'epoch': 5.44}
{'loss': 0.035, 'grad_norm': 0.18955715508728377, 'learning_rate': 5e-05, 'epoch': 5.45}
{'loss': 0.0348, 'grad_norm': 0.10674473009234134, 'learning_rate': 5e-05, 'epoch': 5.46}
{'loss': 0.0344, 'grad_norm': 0.12571803631012207, 'learning_rate': 5e-05, 'epoch': 5.48}
{'loss': 0.0349, 'grad_norm': 0.1995504833621329, 'learning_rate': 5e-05, 'epoch': 5.49}
{'loss': 0.0346, 'grad_norm': 0.0822189488363236, 'learning_rate': 5e-05, 'epoch': 5.5}
{'loss': 0.0344, 'grad_norm': 0.10897248145120647, 'learning_rate': 5e-05, 'epoch': 5.52}
{'loss': 0.0334, 'grad_norm': 0.09840321019293849, 'learning_rate': 5e-05, 'epoch': 5.53}
{'loss': 0.0351, 'grad_norm': 0.12369035689358931, 'learning_rate': 5e-05, 'epoch': 5.54}
{'loss': 0.0343, 'grad_norm': 0.10429833604025014, 'learning_rate': 5e-05, 'epoch': 5.56}
{'loss': 0.0349, 'grad_norm': 0.14559846652698463, 'learning_rate': 5e-05, 'epoch': 5.57}
{'loss': 0.0339, 'grad_norm': 0.1353940272357763, 'learning_rate': 5e-05, 'epoch': 5.58}
{'loss': 0.0344, 'grad_norm': 0.1032020389462199, 'learning_rate': 5e-05, 'epoch': 5.6}
{'loss': 0.0345, 'grad_norm': 0.10972033207642858, 'learning_rate': 5e-05, 'epoch': 5.61}
{'loss': 0.034, 'grad_norm': 0.1694938156883174, 'learning_rate': 5e-05, 'epoch': 5.62}
{'loss': 0.0329, 'grad_norm': 0.08865084356705659, 'learning_rate': 5e-05, 'epoch': 5.64}
{'loss': 0.034, 'grad_norm': 0.16779582969971518, 'learning_rate': 5e-05, 'epoch': 5.65}
{'loss': 0.0349, 'grad_norm': 0.09013213645057916, 'learning_rate': 5e-05, 'epoch': 5.66}
{'loss': 0.0333, 'grad_norm': 0.10337658307109934, 'learning_rate': 5e-05, 'epoch': 5.68}
{'loss': 0.0356, 'grad_norm': 0.23849857300605368, 'learning_rate': 5e-05, 'epoch': 5.69}
{'loss': 0.0335, 'grad_norm': 0.2930025971251987, 'learning_rate': 5e-05, 'epoch': 5.7}
{'loss': 0.0351, 'grad_norm': 0.1092081969337759, 'learning_rate': 5e-05, 'epoch': 5.72}
{'loss': 0.0353, 'grad_norm': 0.1131280282113175, 'learning_rate': 5e-05, 'epoch': 5.73}
{'loss': 0.0344, 'grad_norm': 0.12761571809163844, 'learning_rate': 5e-05, 'epoch': 5.74}
{'loss': 0.0334, 'grad_norm': 0.1236860725521414, 'learning_rate': 5e-05, 'epoch': 5.76}
{'loss': 0.0337, 'grad_norm': 0.08448536176442137, 'learning_rate': 5e-05, 'epoch': 5.77}
{'loss': 0.0338, 'grad_norm': 0.10035975497413055, 'learning_rate': 5e-05, 'epoch': 5.78}
{'loss': 0.0354, 'grad_norm': 0.17465788254936387, 'learning_rate': 5e-05, 'epoch': 5.8}
{'loss': 0.0334, 'grad_norm': 0.11195125527693997, 'learning_rate': 5e-05, 'epoch': 5.81}
{'loss': 0.0341, 'grad_norm': 0.12141775806974368, 'learning_rate': 5e-05, 'epoch': 5.82}
{'loss': 0.0333, 'grad_norm': 0.16000985223268988, 'learning_rate': 5e-05, 'epoch': 5.84}
{'loss': 0.034, 'grad_norm': 0.1022102032458442, 'learning_rate': 5e-05, 'epoch': 5.85}
{'loss': 0.0345, 'grad_norm': 0.09566986226063111, 'learning_rate': 5e-05, 'epoch': 5.86}
{'loss': 0.0337, 'grad_norm': 0.10962433579672116, 'learning_rate': 5e-05, 'epoch': 5.88}
{'loss': 0.0333, 'grad_norm': 0.11192667409062586, 'learning_rate': 5e-05, 'epoch': 5.89}
{'loss': 0.0336, 'grad_norm': 0.14029918782734255, 'learning_rate': 5e-05, 'epoch': 5.9}
{'loss': 0.033, 'grad_norm': 0.09434270755492628, 'learning_rate': 5e-05, 'epoch': 5.92}
{'loss': 0.0333, 'grad_norm': 0.16466542560186767, 'learning_rate': 5e-05, 'epoch': 5.93}
{'loss': 0.0335, 'grad_norm': 0.10809608339474912, 'learning_rate': 5e-05, 'epoch': 5.94}
{'loss': 0.0331, 'grad_norm': 0.11563999909982925, 'learning_rate': 5e-05, 'epoch': 5.96}
{'loss': 0.035, 'grad_norm': 0.09557365885800648, 'learning_rate': 5e-05, 'epoch': 5.97}
{'loss': 0.0335, 'grad_norm': 0.11973458507474112, 'learning_rate': 5e-05, 'epoch': 5.98}
{'loss': 0.0347, 'grad_norm': 0.11404239692943152, 'learning_rate': 5e-05, 'epoch': 6.0}
 25%|███████████████████████████████████████████████████████▊                                                                                                                                                                       | 4482/17928 [2:03:26<3:47:54,  1.02s/it][INFO|gner_trainer.py:60] 2024-11-19 21:25:14,360 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 21:25:14,360 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 21:25:14,360 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3607.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3673.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3647.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3665.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3660.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3567.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3648.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4085.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4099.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4095.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4057.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4087.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 3998.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3684.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4072.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1408.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1390.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4126.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1410.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 967.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 953.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.77it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 963.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1084.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1080.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.73it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.74it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.44it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 537.31it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.09it/s]
{'eval_mit-movie_precision': 0.462156242394732, 'eval_mit-movie_recall': 0.35568458512829454, 'eval_mit-movie_f1': 0.4019898390702292, 'eval_mit-restaurant_precision': 0.39510294936002255, 'eval_mit-restaurant_recall': 0.22539682539681824, 'eval_mit-restaurant_f1': 0.2870426520661198, 'eval_crossner_ai_precision': 0.38018628281116085, 'eval_crossner_ai_recall': 0.5588052271312658, 'eval_crossner_ai_f1': 0.4525069286491913, 'eval_crossner_literature_precision': 0.4336859235150352, 'eval_crossner_literature_recall': 0.5378405650857448, 'eval_crossner_literature_f1': 0.48018018013073316, 'eval_crossner_music_precision': 0.5925925925925759, 'eval_crossner_music_recall': 0.6760563380281474, 'eval_crossner_music_f1': 0.6315789473186184, 'eval_crossner_politics_precision': 0.5193087262641237, 'eval_crossner_politics_recall': 0.624102564102548, 'eval_crossner_politics_f1': 0.5669034586670715, 'eval_crossner_science_precision': 0.5176470588235146, 'eval_crossner_science_recall': 0.7130434782608414, 'eval_crossner_science_f1': 0.5998337489121714, 'eval_wiki_passage_from_zero_precision': 0.8173175850858043, 'eval_wiki_passage_from_zero_recall': 0.7959919839679342, 'eval_wiki_passage_from_zero_f1': 0.8065138377944303, 'eval_average_f1': 0.5283186990760707, 'eval_runtime': 518.4271, 'eval_samples_per_second': 26.389, 'eval_steps_per_second': 0.104, 'epoch': 6.0}
 25%|███████████████████████████████████████████████████████▊                                                                                                                                                                       | 4482/17928 [2:12:05<3:47:54,  1.02s/it]
[INFO|trainer.py:3812] 2024-11-19 21:33:53,104 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-4482
[INFO|configuration_utils.py:414] 2024-11-19 21:33:53,106 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-4482/config.json
[INFO|configuration_utils.py:865] 2024-11-19 21:33:53,106 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-4482/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 21:33:53,657 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-4482/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 21:33:53,659 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-4482/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 21:33:53,659 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-4482/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 21:33:53,660 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-4482/spiece.model
[2024-11-19 21:33:53,677] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step4482 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 21:33:53,683] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/mp_rank_00_model_states.pt
[2024-11-19 21:33:53,683] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/mp_rank_00_model_states.pt...
[2024-11-19 21:33:54,330] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/mp_rank_00_model_states.pt.
[2024-11-19 21:33:54,332] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 21:33:54,888] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 21:33:54,889] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-4482/global_step4482/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 21:33:54,889] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step4482 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0332, 'grad_norm': 0.1316035943059878, 'learning_rate': 5e-05, 'epoch': 6.01}
{'loss': 0.0322, 'grad_norm': 0.10033294193150818, 'learning_rate': 5e-05, 'epoch': 6.02}
{'loss': 0.0331, 'grad_norm': 0.10713746393983337, 'learning_rate': 5e-05, 'epoch': 6.04}
{'loss': 0.0335, 'grad_norm': 0.12583323760797427, 'learning_rate': 5e-05, 'epoch': 6.05}
{'loss': 0.0331, 'grad_norm': 0.12463575057112393, 'learning_rate': 5e-05, 'epoch': 6.06}
{'loss': 0.0329, 'grad_norm': 0.09420673553924014, 'learning_rate': 5e-05, 'epoch': 6.08}
{'loss': 0.0333, 'grad_norm': 0.18005237643507044, 'learning_rate': 5e-05, 'epoch': 6.09}
{'loss': 0.0339, 'grad_norm': 0.13465368763620783, 'learning_rate': 5e-05, 'epoch': 6.1}
{'loss': 0.0334, 'grad_norm': 0.08287546040693332, 'learning_rate': 5e-05, 'epoch': 6.12}
{'loss': 0.0333, 'grad_norm': 0.0735333092902108, 'learning_rate': 5e-05, 'epoch': 6.13}
{'loss': 0.0321, 'grad_norm': 0.14075714763419334, 'learning_rate': 5e-05, 'epoch': 6.14}
{'loss': 0.0337, 'grad_norm': 0.12125467943349515, 'learning_rate': 5e-05, 'epoch': 6.16}
{'loss': 0.0338, 'grad_norm': 0.08538194460431665, 'learning_rate': 5e-05, 'epoch': 6.17}
{'loss': 0.0328, 'grad_norm': 0.11718365345046114, 'learning_rate': 5e-05, 'epoch': 6.18}
{'loss': 0.0336, 'grad_norm': 0.08489163356419202, 'learning_rate': 5e-05, 'epoch': 6.2}
{'loss': 0.0344, 'grad_norm': 0.06332454819017337, 'learning_rate': 5e-05, 'epoch': 6.21}
{'loss': 0.0329, 'grad_norm': 0.12796803256475348, 'learning_rate': 5e-05, 'epoch': 6.22}
{'loss': 0.0329, 'grad_norm': 0.11572118750175324, 'learning_rate': 5e-05, 'epoch': 6.24}
{'loss': 0.034, 'grad_norm': 0.13603507491723427, 'learning_rate': 5e-05, 'epoch': 6.25}
{'loss': 0.0342, 'grad_norm': 0.10977448583792856, 'learning_rate': 5e-05, 'epoch': 6.27}
{'loss': 0.0333, 'grad_norm': 0.10667424562780659, 'learning_rate': 5e-05, 'epoch': 6.28}
{'loss': 0.033, 'grad_norm': 0.10818422045632065, 'learning_rate': 5e-05, 'epoch': 6.29}
{'loss': 0.034, 'grad_norm': 0.11987337706728209, 'learning_rate': 5e-05, 'epoch': 6.31}
{'loss': 0.0333, 'grad_norm': 0.12682957873252051, 'learning_rate': 5e-05, 'epoch': 6.32}
{'loss': 0.0327, 'grad_norm': 0.1096289742865624, 'learning_rate': 5e-05, 'epoch': 6.33}
{'loss': 0.0332, 'grad_norm': 0.09179694094554075, 'learning_rate': 5e-05, 'epoch': 6.35}
{'loss': 0.0333, 'grad_norm': 0.09360118817304784, 'learning_rate': 5e-05, 'epoch': 6.36}
{'loss': 0.0343, 'grad_norm': 0.11911726159697489, 'learning_rate': 5e-05, 'epoch': 6.37}
{'loss': 0.0326, 'grad_norm': 0.06705259180110759, 'learning_rate': 5e-05, 'epoch': 6.39}
{'loss': 0.0345, 'grad_norm': 0.11230018026180567, 'learning_rate': 5e-05, 'epoch': 6.4}
{'loss': 0.0331, 'grad_norm': 0.13664680359024783, 'learning_rate': 5e-05, 'epoch': 6.41}
{'loss': 0.0331, 'grad_norm': 0.08959957299504594, 'learning_rate': 5e-05, 'epoch': 6.43}
{'loss': 0.0332, 'grad_norm': 0.08412486900217363, 'learning_rate': 5e-05, 'epoch': 6.44}
{'loss': 0.0332, 'grad_norm': 0.13128846547184822, 'learning_rate': 5e-05, 'epoch': 6.45}
{'loss': 0.0328, 'grad_norm': 0.12108657031155723, 'learning_rate': 5e-05, 'epoch': 6.47}
{'loss': 0.0334, 'grad_norm': 0.10287465175011187, 'learning_rate': 5e-05, 'epoch': 6.48}
{'loss': 0.0333, 'grad_norm': 0.07631906629882958, 'learning_rate': 5e-05, 'epoch': 6.49}
{'loss': 0.0328, 'grad_norm': 0.1727945589372039, 'learning_rate': 5e-05, 'epoch': 6.51}
{'loss': 0.0335, 'grad_norm': 0.12695778324677612, 'learning_rate': 5e-05, 'epoch': 6.52}
{'loss': 0.0326, 'grad_norm': 0.09835200892704744, 'learning_rate': 5e-05, 'epoch': 6.53}
{'loss': 0.0339, 'grad_norm': 0.15209181445677022, 'learning_rate': 5e-05, 'epoch': 6.55}
{'loss': 0.0324, 'grad_norm': 0.09689223882127515, 'learning_rate': 5e-05, 'epoch': 6.56}
{'loss': 0.0322, 'grad_norm': 0.09158320110742924, 'learning_rate': 5e-05, 'epoch': 6.57}
{'loss': 0.0327, 'grad_norm': 0.07881071047675987, 'learning_rate': 5e-05, 'epoch': 6.59}
{'loss': 0.0328, 'grad_norm': 0.08100995874868186, 'learning_rate': 5e-05, 'epoch': 6.6}
{'loss': 0.0322, 'grad_norm': 0.15677083351815393, 'learning_rate': 5e-05, 'epoch': 6.61}
{'loss': 0.0338, 'grad_norm': 0.22308509085068232, 'learning_rate': 5e-05, 'epoch': 6.63}
{'loss': 0.0326, 'grad_norm': 0.14207575751152524, 'learning_rate': 5e-05, 'epoch': 6.64}
{'loss': 0.0328, 'grad_norm': 0.12470271103798244, 'learning_rate': 5e-05, 'epoch': 6.65}
{'loss': 0.0329, 'grad_norm': 0.05357740014504538, 'learning_rate': 5e-05, 'epoch': 6.67}
{'loss': 0.0339, 'grad_norm': 0.11506102745708355, 'learning_rate': 5e-05, 'epoch': 6.68}
{'loss': 0.0328, 'grad_norm': 0.09710078097068911, 'learning_rate': 5e-05, 'epoch': 6.69}
{'loss': 0.0318, 'grad_norm': 0.12066808225827601, 'learning_rate': 5e-05, 'epoch': 6.71}
{'loss': 0.0336, 'grad_norm': 0.10788649735506929, 'learning_rate': 5e-05, 'epoch': 6.72}
{'loss': 0.0338, 'grad_norm': 0.12517466114416212, 'learning_rate': 5e-05, 'epoch': 6.73}
{'loss': 0.0337, 'grad_norm': 0.09684207072037614, 'learning_rate': 5e-05, 'epoch': 6.75}
{'loss': 0.0323, 'grad_norm': 0.12429195157531663, 'learning_rate': 5e-05, 'epoch': 6.76}
{'loss': 0.0326, 'grad_norm': 0.11011543160209449, 'learning_rate': 5e-05, 'epoch': 6.77}
{'loss': 0.0325, 'grad_norm': 0.11033195557729295, 'learning_rate': 5e-05, 'epoch': 6.79}
{'loss': 0.0341, 'grad_norm': 0.15852173758199697, 'learning_rate': 5e-05, 'epoch': 6.8}
{'loss': 0.0329, 'grad_norm': 0.13449480654171514, 'learning_rate': 5e-05, 'epoch': 6.81}
{'loss': 0.0334, 'grad_norm': 0.17849003840079475, 'learning_rate': 5e-05, 'epoch': 6.83}
{'loss': 0.0328, 'grad_norm': 0.09025132981903033, 'learning_rate': 5e-05, 'epoch': 6.84}
{'loss': 0.0328, 'grad_norm': 0.09586115362884749, 'learning_rate': 5e-05, 'epoch': 6.85}
{'loss': 0.0328, 'grad_norm': 0.12185125914448655, 'learning_rate': 5e-05, 'epoch': 6.87}
{'loss': 0.0331, 'grad_norm': 0.15204141645558159, 'learning_rate': 5e-05, 'epoch': 6.88}
{'loss': 0.0329, 'grad_norm': 0.10298111859392099, 'learning_rate': 5e-05, 'epoch': 6.89}
{'loss': 0.0326, 'grad_norm': 0.10425013734387652, 'learning_rate': 5e-05, 'epoch': 6.91}
{'loss': 0.0338, 'grad_norm': 0.1238465023242691, 'learning_rate': 5e-05, 'epoch': 6.92}
{'loss': 0.0322, 'grad_norm': 0.09897533279101875, 'learning_rate': 5e-05, 'epoch': 6.93}
{'loss': 0.0324, 'grad_norm': 0.12406125205562979, 'learning_rate': 5e-05, 'epoch': 6.95}
{'loss': 0.0324, 'grad_norm': 0.09606598650705238, 'learning_rate': 5e-05, 'epoch': 6.96}
{'loss': 0.0318, 'grad_norm': 0.07358233621494299, 'learning_rate': 5e-05, 'epoch': 6.97}
{'loss': 0.0321, 'grad_norm': 0.09589543774918446, 'learning_rate': 5e-05, 'epoch': 6.99}
 29%|█████████████████████████████████████████████████████████████████                                                                                                                                                              | 5229/17928 [2:25:30<3:41:25,  1.05s/it][INFO|gner_trainer.py:60] 2024-11-19 21:47:17,841 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 21:47:17,841 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 21:47:17,841 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3677.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3630.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3643.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3587.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3630.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3626.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3620.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4105.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4077.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4059.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4046.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 3972.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4061.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1390.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4051.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3647.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1367.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1378.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4079.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1075.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1080.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1371.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 986.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 963.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 965.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.20it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 944.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1101.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1085.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1071.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1080.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.00it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 534.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.26it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.60it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.34it/s]
{'eval_mit-movie_precision': 0.49154092363967783, 'eval_mit-movie_recall': 0.4026971342948042, 'eval_mit-movie_f1': 0.4427056521691604, 'eval_mit-restaurant_precision': 0.3987206823027506, 'eval_mit-restaurant_recall': 0.2374603174603099, 'eval_mit-restaurant_f1': 0.29765220846891904, 'eval_crossner_ai_precision': 0.389696717906091, 'eval_crossner_ai_recall': 0.5836963285625025, 'eval_crossner_ai_f1': 0.4673642251637216, 'eval_crossner_literature_precision': 0.4104538087520093, 'eval_crossner_literature_recall': 0.5110998990918006, 'eval_crossner_literature_f1': 0.4552808988269804, 'eval_crossner_music_precision': 0.5904121110176453, 'eval_crossner_music_recall': 0.6741357234314765, 'eval_crossner_music_f1': 0.6295023164948125, 'eval_crossner_politics_precision': 0.5297872340425419, 'eval_crossner_politics_recall': 0.6384615384615221, 'eval_crossner_politics_f1': 0.5790697673922797, 'eval_crossner_science_precision': 0.5108509423186605, 'eval_crossner_science_recall': 0.7071146245059009, 'eval_crossner_science_f1': 0.5931697612244882, 'eval_wiki_passage_from_zero_precision': 0.822371668311943, 'eval_wiki_passage_from_zero_recall': 0.8013426853707398, 'eval_wiki_passage_from_zero_f1': 0.8117210019393697, 'eval_average_f1': 0.5345582289599664, 'eval_runtime': 513.119, 'eval_samples_per_second': 26.662, 'eval_steps_per_second': 0.105, 'epoch': 7.0}
 29%|█████████████████████████████████████████████████████████████████                                                                                                                                                              | 5229/17928 [2:34:03<3:41:25,  1.05s/it]
[INFO|trainer.py:3812] 2024-11-19 21:55:51,747 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-5229
[INFO|configuration_utils.py:414] 2024-11-19 21:55:51,749 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-5229/config.json
[INFO|configuration_utils.py:865] 2024-11-19 21:55:51,749 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-5229/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 21:55:52,334 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-5229/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 21:55:52,336 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-5229/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 21:55:52,336 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-5229/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 21:55:52,337 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-5229/spiece.model
[2024-11-19 21:55:52,352] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step5229 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 21:55:52,362] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/mp_rank_00_model_states.pt
[2024-11-19 21:55:52,362] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/mp_rank_00_model_states.pt...
[2024-11-19 21:55:52,993] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/mp_rank_00_model_states.pt.
[2024-11-19 21:55:52,995] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 21:55:53,576] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 21:55:53,577] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-5229/global_step5229/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 21:55:53,577] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step5229 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0324, 'grad_norm': 0.09272842319031638, 'learning_rate': 5e-05, 'epoch': 7.0}
{'loss': 0.0319, 'grad_norm': 0.10686412714841517, 'learning_rate': 5e-05, 'epoch': 7.01}
{'loss': 0.0325, 'grad_norm': 0.06352548181408517, 'learning_rate': 5e-05, 'epoch': 7.03}
{'loss': 0.0317, 'grad_norm': 0.1344269006324639, 'learning_rate': 5e-05, 'epoch': 7.04}
{'loss': 0.0325, 'grad_norm': 0.12834970668849116, 'learning_rate': 5e-05, 'epoch': 7.05}
{'loss': 0.0325, 'grad_norm': 0.08526580471892288, 'learning_rate': 5e-05, 'epoch': 7.07}
{'loss': 0.0318, 'grad_norm': 0.09161669213743419, 'learning_rate': 5e-05, 'epoch': 7.08}
{'loss': 0.0322, 'grad_norm': 0.09955903258395149, 'learning_rate': 5e-05, 'epoch': 7.1}
{'loss': 0.032, 'grad_norm': 0.11172693746082532, 'learning_rate': 5e-05, 'epoch': 7.11}
{'loss': 0.0319, 'grad_norm': 0.1148203305285117, 'learning_rate': 5e-05, 'epoch': 7.12}
{'loss': 0.0332, 'grad_norm': 0.15058850609039617, 'learning_rate': 5e-05, 'epoch': 7.14}
{'loss': 0.0321, 'grad_norm': 0.10140321234751293, 'learning_rate': 5e-05, 'epoch': 7.15}
{'loss': 0.0326, 'grad_norm': 0.14484891905917868, 'learning_rate': 5e-05, 'epoch': 7.16}
{'loss': 0.0313, 'grad_norm': 0.13774968149317976, 'learning_rate': 5e-05, 'epoch': 7.18}
{'loss': 0.0329, 'grad_norm': 0.06257835334564724, 'learning_rate': 5e-05, 'epoch': 7.19}
{'loss': 0.0328, 'grad_norm': 0.26035731910929094, 'learning_rate': 5e-05, 'epoch': 7.2}
{'loss': 0.0324, 'grad_norm': 0.10337591640084677, 'learning_rate': 5e-05, 'epoch': 7.22}
{'loss': 0.0317, 'grad_norm': 0.19781216363742668, 'learning_rate': 5e-05, 'epoch': 7.23}
{'loss': 0.0332, 'grad_norm': 0.11911536558695297, 'learning_rate': 5e-05, 'epoch': 7.24}
{'loss': 0.0321, 'grad_norm': 0.09032346323980257, 'learning_rate': 5e-05, 'epoch': 7.26}
{'loss': 0.0319, 'grad_norm': 0.1022707061510674, 'learning_rate': 5e-05, 'epoch': 7.27}
{'loss': 0.0324, 'grad_norm': 0.10432751327005081, 'learning_rate': 5e-05, 'epoch': 7.28}
{'loss': 0.0319, 'grad_norm': 0.11566044547658637, 'learning_rate': 5e-05, 'epoch': 7.3}
{'loss': 0.0322, 'grad_norm': 0.22339574250251393, 'learning_rate': 5e-05, 'epoch': 7.31}
{'loss': 0.0319, 'grad_norm': 0.13537199325824062, 'learning_rate': 5e-05, 'epoch': 7.32}
{'loss': 0.0312, 'grad_norm': 0.10458739123777021, 'learning_rate': 5e-05, 'epoch': 7.34}
{'loss': 0.0321, 'grad_norm': 0.11825124031095888, 'learning_rate': 5e-05, 'epoch': 7.35}
{'loss': 0.033, 'grad_norm': 0.1457373709229093, 'learning_rate': 5e-05, 'epoch': 7.36}
{'loss': 0.0317, 'grad_norm': 0.09495659063849723, 'learning_rate': 5e-05, 'epoch': 7.38}
{'loss': 0.0313, 'grad_norm': 0.05872655758458704, 'learning_rate': 5e-05, 'epoch': 7.39}
{'loss': 0.0323, 'grad_norm': 0.08911011054892441, 'learning_rate': 5e-05, 'epoch': 7.4}
{'loss': 0.033, 'grad_norm': 0.11504895438134001, 'learning_rate': 5e-05, 'epoch': 7.42}
{'loss': 0.0324, 'grad_norm': 0.12626186120383678, 'learning_rate': 5e-05, 'epoch': 7.43}
{'loss': 0.0318, 'grad_norm': 0.08861385644596134, 'learning_rate': 5e-05, 'epoch': 7.44}
{'loss': 0.0321, 'grad_norm': 0.10220523261862807, 'learning_rate': 5e-05, 'epoch': 7.46}
{'loss': 0.0312, 'grad_norm': 0.1318255314428851, 'learning_rate': 5e-05, 'epoch': 7.47}
{'loss': 0.0313, 'grad_norm': 0.1064753533765684, 'learning_rate': 5e-05, 'epoch': 7.48}
{'loss': 0.0323, 'grad_norm': 0.1581366894004894, 'learning_rate': 5e-05, 'epoch': 7.5}
{'loss': 0.0324, 'grad_norm': 0.11883082133462466, 'learning_rate': 5e-05, 'epoch': 7.51}
{'loss': 0.0319, 'grad_norm': 0.08454162064695273, 'learning_rate': 5e-05, 'epoch': 7.52}
{'loss': 0.0321, 'grad_norm': 0.15321370081018995, 'learning_rate': 5e-05, 'epoch': 7.54}
{'loss': 0.0327, 'grad_norm': 0.12498479243992214, 'learning_rate': 5e-05, 'epoch': 7.55}
{'loss': 0.0322, 'grad_norm': 0.07512471985010984, 'learning_rate': 5e-05, 'epoch': 7.56}
{'loss': 0.032, 'grad_norm': 0.1396723239984069, 'learning_rate': 5e-05, 'epoch': 7.58}
{'loss': 0.0327, 'grad_norm': 0.09919363101874938, 'learning_rate': 5e-05, 'epoch': 7.59}
{'loss': 0.0319, 'grad_norm': 0.12872752891659775, 'learning_rate': 5e-05, 'epoch': 7.6}
{'loss': 0.0322, 'grad_norm': 0.15214787019126813, 'learning_rate': 5e-05, 'epoch': 7.62}
{'loss': 0.0325, 'grad_norm': 0.08149826800463814, 'learning_rate': 5e-05, 'epoch': 7.63}
{'loss': 0.0316, 'grad_norm': 0.12387395470959596, 'learning_rate': 5e-05, 'epoch': 7.64}
{'loss': 0.032, 'grad_norm': 0.09472414387240297, 'learning_rate': 5e-05, 'epoch': 7.66}
{'loss': 0.0326, 'grad_norm': 0.14671793437767622, 'learning_rate': 5e-05, 'epoch': 7.67}
{'loss': 0.0325, 'grad_norm': 0.1449815526996532, 'learning_rate': 5e-05, 'epoch': 7.68}
{'loss': 0.0316, 'grad_norm': 0.12454554528400072, 'learning_rate': 5e-05, 'epoch': 7.7}
{'loss': 0.0318, 'grad_norm': 0.08151787240336082, 'learning_rate': 5e-05, 'epoch': 7.71}
{'loss': 0.0316, 'grad_norm': 0.09191681756828304, 'learning_rate': 5e-05, 'epoch': 7.72}
{'loss': 0.0314, 'grad_norm': 0.08412859698334971, 'learning_rate': 5e-05, 'epoch': 7.74}
{'loss': 0.0324, 'grad_norm': 0.11646327903549852, 'learning_rate': 5e-05, 'epoch': 7.75}
{'loss': 0.0308, 'grad_norm': 0.08108822002555773, 'learning_rate': 5e-05, 'epoch': 7.76}
{'loss': 0.032, 'grad_norm': 0.13369777795224436, 'learning_rate': 5e-05, 'epoch': 7.78}
{'loss': 0.0321, 'grad_norm': 0.08033040767784702, 'learning_rate': 5e-05, 'epoch': 7.79}
{'loss': 0.0313, 'grad_norm': 0.1334996259957336, 'learning_rate': 5e-05, 'epoch': 7.8}
{'loss': 0.0329, 'grad_norm': 0.16569030526879078, 'learning_rate': 5e-05, 'epoch': 7.82}
{'loss': 0.031, 'grad_norm': 0.16579459005465064, 'learning_rate': 5e-05, 'epoch': 7.83}
{'loss': 0.0315, 'grad_norm': 0.059046675609555815, 'learning_rate': 5e-05, 'epoch': 7.84}
{'loss': 0.0318, 'grad_norm': 0.11822046557378338, 'learning_rate': 5e-05, 'epoch': 7.86}
{'loss': 0.0313, 'grad_norm': 0.10412705880393125, 'learning_rate': 5e-05, 'epoch': 7.87}
{'loss': 0.0305, 'grad_norm': 0.07590718313199553, 'learning_rate': 5e-05, 'epoch': 7.88}
{'loss': 0.0318, 'grad_norm': 0.1358836623710111, 'learning_rate': 5e-05, 'epoch': 7.9}
{'loss': 0.0318, 'grad_norm': 0.12317793542057787, 'learning_rate': 5e-05, 'epoch': 7.91}
{'loss': 0.0328, 'grad_norm': 0.08570714171341506, 'learning_rate': 5e-05, 'epoch': 7.93}
{'loss': 0.0316, 'grad_norm': 0.09880994245004962, 'learning_rate': 5e-05, 'epoch': 7.94}
{'loss': 0.0314, 'grad_norm': 0.0983446604923227, 'learning_rate': 5e-05, 'epoch': 7.95}
{'loss': 0.0315, 'grad_norm': 0.17264815932947583, 'learning_rate': 5e-05, 'epoch': 7.97}
{'loss': 0.0309, 'grad_norm': 0.05238391177057326, 'learning_rate': 5e-05, 'epoch': 7.98}
{'loss': 0.0319, 'grad_norm': 0.07258605155118811, 'learning_rate': 5e-05, 'epoch': 7.99}
 33%|██████████████████████████████████████████████████████████████████████████▎                                                                                                                                                    | 5976/17928 [2:47:30<3:35:08,  1.08s/it][INFO|gner_trainer.py:60] 2024-11-19 22:09:17,755 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 22:09:17,756 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 22:09:17,756 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3650.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3659.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3645.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3647.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3629.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3679.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3666.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4089.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3605.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4102.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4063.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4074.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4077.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4004.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4016.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4017.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1348.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1379.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 985.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 967.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 966.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.53it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 945.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1103.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1085.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1080.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 537.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.76it/s]
{'eval_mit-movie_precision': 0.4935370152761341, 'eval_mit-movie_recall': 0.3933320846600413, 'eval_mit-movie_f1': 0.43777360845594493, 'eval_mit-restaurant_precision': 0.40231150247658765, 'eval_mit-restaurant_recall': 0.2320634920634847, 'eval_mit-restaurant_f1': 0.29434266151992716, 'eval_crossner_ai_precision': 0.4023870417732139, 'eval_crossner_ai_recall': 0.5874299937771881, 'eval_crossner_ai_f1': 0.47761194025023074, 'eval_crossner_literature_precision': 0.43494423791819764, 'eval_crossner_literature_recall': 0.5312815338042113, 'eval_crossner_literature_f1': 0.47831024296660063, 'eval_crossner_music_precision': 0.5871428571428403, 'eval_crossner_music_recall': 0.6578104993597741, 'eval_crossner_music_f1': 0.620471014442896, 'eval_crossner_politics_precision': 0.5417830290010625, 'eval_crossner_politics_recall': 0.6466666666666501, 'eval_crossner_politics_f1': 0.5895967270105743, 'eval_crossner_science_precision': 0.511278195488707, 'eval_crossner_science_recall': 0.6988142292489842, 'eval_crossner_science_f1': 0.5905143620086293, 'eval_wiki_passage_from_zero_precision': 0.8332219530532101, 'eval_wiki_passage_from_zero_recall': 0.7995591182364713, 'eval_wiki_passage_from_zero_f1': 0.8160435244530057, 'eval_average_f1': 0.5380830101384761, 'eval_runtime': 505.876, 'eval_samples_per_second': 27.044, 'eval_steps_per_second': 0.107, 'epoch': 8.0}
 33%|██████████████████████████████████████████████████████████████████████████▎                                                                                                                                                    | 5976/17928 [2:55:55<3:35:08,  1.08s/it]
[INFO|trainer.py:3812] 2024-11-19 22:17:44,157 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-5976
[INFO|configuration_utils.py:414] 2024-11-19 22:17:44,159 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-5976/config.json
[INFO|configuration_utils.py:865] 2024-11-19 22:17:44,159 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-5976/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 22:17:44,723 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-5976/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 22:17:44,725 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-5976/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 22:17:44,725 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-5976/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 22:17:44,726 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-5976/spiece.model
[2024-11-19 22:17:44,741] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step5976 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 22:17:44,747] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/mp_rank_00_model_states.pt
[2024-11-19 22:17:44,747] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/mp_rank_00_model_states.pt...
[2024-11-19 22:17:45,371] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/mp_rank_00_model_states.pt.
[2024-11-19 22:17:45,372] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 22:17:45,954] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 22:17:45,954] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-5976/global_step5976/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 22:17:45,954] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step5976 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.032, 'grad_norm': 0.1336688803622168, 'learning_rate': 5e-05, 'epoch': 8.01}
{'loss': 0.0305, 'grad_norm': 0.11446300242639619, 'learning_rate': 5e-05, 'epoch': 8.02}
{'loss': 0.0308, 'grad_norm': 0.14789117486552264, 'learning_rate': 5e-05, 'epoch': 8.03}
{'loss': 0.0312, 'grad_norm': 0.10204238948358978, 'learning_rate': 5e-05, 'epoch': 8.05}
{'loss': 0.031, 'grad_norm': 0.10476232530601837, 'learning_rate': 5e-05, 'epoch': 8.06}
{'loss': 0.0309, 'grad_norm': 0.10663176751293761, 'learning_rate': 5e-05, 'epoch': 8.07}
{'loss': 0.033, 'grad_norm': 0.06245407078377338, 'learning_rate': 5e-05, 'epoch': 8.09}
{'loss': 0.0318, 'grad_norm': 0.11337329561478074, 'learning_rate': 5e-05, 'epoch': 8.1}
{'loss': 0.0314, 'grad_norm': 0.19980317764979594, 'learning_rate': 5e-05, 'epoch': 8.11}
{'loss': 0.032, 'grad_norm': 0.13555243835245406, 'learning_rate': 5e-05, 'epoch': 8.13}
{'loss': 0.0318, 'grad_norm': 0.1114303596284814, 'learning_rate': 5e-05, 'epoch': 8.14}
{'loss': 0.0315, 'grad_norm': 0.07953084619565726, 'learning_rate': 5e-05, 'epoch': 8.15}
{'loss': 0.0318, 'grad_norm': 0.08260309344887722, 'learning_rate': 5e-05, 'epoch': 8.17}
{'loss': 0.0314, 'grad_norm': 0.09226107409282015, 'learning_rate': 5e-05, 'epoch': 8.18}
{'loss': 0.0309, 'grad_norm': 0.12521326230968974, 'learning_rate': 5e-05, 'epoch': 8.19}
{'loss': 0.0309, 'grad_norm': 0.1056872682597069, 'learning_rate': 5e-05, 'epoch': 8.21}
{'loss': 0.0315, 'grad_norm': 0.10338538001305661, 'learning_rate': 5e-05, 'epoch': 8.22}
{'loss': 0.0313, 'grad_norm': 0.10824609481658995, 'learning_rate': 5e-05, 'epoch': 8.23}
{'loss': 0.0317, 'grad_norm': 0.14364082321349175, 'learning_rate': 5e-05, 'epoch': 8.25}
{'loss': 0.031, 'grad_norm': 0.09692131058428503, 'learning_rate': 5e-05, 'epoch': 8.26}
{'loss': 0.0315, 'grad_norm': 0.11359529291519217, 'learning_rate': 5e-05, 'epoch': 8.27}
{'loss': 0.0307, 'grad_norm': 0.08713650099322304, 'learning_rate': 5e-05, 'epoch': 8.29}
{'loss': 0.0305, 'grad_norm': 0.1200780494630138, 'learning_rate': 5e-05, 'epoch': 8.3}
{'loss': 0.0307, 'grad_norm': 0.09734569761921018, 'learning_rate': 5e-05, 'epoch': 8.31}
{'loss': 0.0315, 'grad_norm': 0.10387834392913685, 'learning_rate': 5e-05, 'epoch': 8.33}
{'loss': 0.0305, 'grad_norm': 0.07020070871469353, 'learning_rate': 5e-05, 'epoch': 8.34}
{'loss': 0.032, 'grad_norm': 0.10508020675468942, 'learning_rate': 5e-05, 'epoch': 8.35}
{'loss': 0.0305, 'grad_norm': 0.12927089038215422, 'learning_rate': 5e-05, 'epoch': 8.37}
{'loss': 0.0323, 'grad_norm': 0.0886437310495486, 'learning_rate': 5e-05, 'epoch': 8.38}
{'loss': 0.03, 'grad_norm': 0.09716448466126515, 'learning_rate': 5e-05, 'epoch': 8.39}
{'loss': 0.0306, 'grad_norm': 0.14782123254582724, 'learning_rate': 5e-05, 'epoch': 8.41}
{'loss': 0.0311, 'grad_norm': 0.06911907062118974, 'learning_rate': 5e-05, 'epoch': 8.42}
{'loss': 0.0304, 'grad_norm': 0.08084700012880781, 'learning_rate': 5e-05, 'epoch': 8.43}
{'loss': 0.0317, 'grad_norm': 0.09555726224124998, 'learning_rate': 5e-05, 'epoch': 8.45}
{'loss': 0.0307, 'grad_norm': 0.15284257310091698, 'learning_rate': 5e-05, 'epoch': 8.46}
{'loss': 0.0314, 'grad_norm': 0.1260023903799758, 'learning_rate': 5e-05, 'epoch': 8.47}
{'loss': 0.0299, 'grad_norm': 0.10152037370439286, 'learning_rate': 5e-05, 'epoch': 8.49}
{'loss': 0.031, 'grad_norm': 0.08821811063861129, 'learning_rate': 5e-05, 'epoch': 8.5}
{'loss': 0.031, 'grad_norm': 0.1291924247771908, 'learning_rate': 5e-05, 'epoch': 8.51}
{'loss': 0.0309, 'grad_norm': 0.09514127481163168, 'learning_rate': 5e-05, 'epoch': 8.53}
{'loss': 0.0314, 'grad_norm': 0.11158811177052586, 'learning_rate': 5e-05, 'epoch': 8.54}
{'loss': 0.0306, 'grad_norm': 0.0905307028434265, 'learning_rate': 5e-05, 'epoch': 8.55}
{'loss': 0.0309, 'grad_norm': 0.15935478643249543, 'learning_rate': 5e-05, 'epoch': 8.57}
{'loss': 0.0302, 'grad_norm': 0.07587778036590653, 'learning_rate': 5e-05, 'epoch': 8.58}
{'loss': 0.0309, 'grad_norm': 0.08082761901123377, 'learning_rate': 5e-05, 'epoch': 8.59}
{'loss': 0.0319, 'grad_norm': 0.07630036594076883, 'learning_rate': 5e-05, 'epoch': 8.61}
{'loss': 0.0297, 'grad_norm': 0.11846992614326282, 'learning_rate': 5e-05, 'epoch': 8.62}
{'loss': 0.0306, 'grad_norm': 0.1288409790325836, 'learning_rate': 5e-05, 'epoch': 8.63}
{'loss': 0.0297, 'grad_norm': 0.07161064317730201, 'learning_rate': 5e-05, 'epoch': 8.65}
{'loss': 0.0312, 'grad_norm': 0.1733286786849029, 'learning_rate': 5e-05, 'epoch': 8.66}
{'loss': 0.0312, 'grad_norm': 0.1458518294684903, 'learning_rate': 5e-05, 'epoch': 8.67}
{'loss': 0.0306, 'grad_norm': 0.0833475313782399, 'learning_rate': 5e-05, 'epoch': 8.69}
{'loss': 0.0303, 'grad_norm': 0.10983299261706828, 'learning_rate': 5e-05, 'epoch': 8.7}
{'loss': 0.0315, 'grad_norm': 0.09979523821178768, 'learning_rate': 5e-05, 'epoch': 8.71}
{'loss': 0.0308, 'grad_norm': 0.11056576675232797, 'learning_rate': 5e-05, 'epoch': 8.73}
{'loss': 0.0307, 'grad_norm': 0.1742881784103318, 'learning_rate': 5e-05, 'epoch': 8.74}
{'loss': 0.0309, 'grad_norm': 0.09189855240426553, 'learning_rate': 5e-05, 'epoch': 8.76}
{'loss': 0.0309, 'grad_norm': 0.11274861623835802, 'learning_rate': 5e-05, 'epoch': 8.77}
{'loss': 0.0314, 'grad_norm': 0.10252272157797723, 'learning_rate': 5e-05, 'epoch': 8.78}
{'loss': 0.0313, 'grad_norm': 0.07247074438704856, 'learning_rate': 5e-05, 'epoch': 8.8}
{'loss': 0.0301, 'grad_norm': 0.14842486955212256, 'learning_rate': 5e-05, 'epoch': 8.81}
{'loss': 0.0323, 'grad_norm': 0.13257312941707108, 'learning_rate': 5e-05, 'epoch': 8.82}
{'loss': 0.0313, 'grad_norm': 0.13616061043121166, 'learning_rate': 5e-05, 'epoch': 8.84}
{'loss': 0.0309, 'grad_norm': 0.07399338776597003, 'learning_rate': 5e-05, 'epoch': 8.85}
{'loss': 0.0314, 'grad_norm': 0.07375302190873242, 'learning_rate': 5e-05, 'epoch': 8.86}
{'loss': 0.0309, 'grad_norm': 0.06947247064655211, 'learning_rate': 5e-05, 'epoch': 8.88}
{'loss': 0.0299, 'grad_norm': 0.09531774584607905, 'learning_rate': 5e-05, 'epoch': 8.89}
{'loss': 0.032, 'grad_norm': 0.13915160972719232, 'learning_rate': 5e-05, 'epoch': 8.9}
{'loss': 0.0312, 'grad_norm': 0.05361557861784029, 'learning_rate': 5e-05, 'epoch': 8.92}
{'loss': 0.0314, 'grad_norm': 0.10541814455386692, 'learning_rate': 5e-05, 'epoch': 8.93}
{'loss': 0.0302, 'grad_norm': 0.12144090512567496, 'learning_rate': 5e-05, 'epoch': 8.94}
{'loss': 0.0304, 'grad_norm': 0.11466140056414871, 'learning_rate': 5e-05, 'epoch': 8.96}
{'loss': 0.0312, 'grad_norm': 0.09756290265897688, 'learning_rate': 5e-05, 'epoch': 8.97}
{'loss': 0.0303, 'grad_norm': 0.13221008051555228, 'learning_rate': 5e-05, 'epoch': 8.98}
{'loss': 0.0312, 'grad_norm': 0.09666027008962566, 'learning_rate': 5e-05, 'epoch': 9.0}
 38%|███████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                           | 6723/17928 [3:09:17<3:36:39,  1.16s/it][INFO|gner_trainer.py:60] 2024-11-19 22:31:05,668 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 22:31:05,668 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 22:31:05,668 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3681.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3670.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3623.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3652.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3652.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3655.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3636.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4104.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4096.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4064.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4041.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4079.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4065.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4075.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1405.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4025.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1373.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1078.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1082.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 965.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.13it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 944.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.98it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 949.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1077.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.48it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 545.24it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.26it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 528.39it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 524.27it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.65it/s]
{'eval_mit-movie_precision': 0.519132057862797, 'eval_mit-movie_recall': 0.4167447087469485, 'eval_mit-movie_f1': 0.4623376622882511, 'eval_mit-restaurant_precision': 0.4456404736275325, 'eval_mit-restaurant_recall': 0.2628571428571345, 'eval_mit-restaurant_f1': 0.33067092647088653, 'eval_crossner_ai_precision': 0.41065292096218164, 'eval_crossner_ai_recall': 0.594897324206559, 'eval_crossner_ai_f1': 0.4858958068131532, 'eval_crossner_literature_precision': 0.44126315789471826, 'eval_crossner_literature_recall': 0.52875882946516, 'eval_crossner_literature_f1': 0.48106495289966167, 'eval_crossner_music_precision': 0.5935262102549242, 'eval_crossner_music_recall': 0.6632522407170082, 'eval_crossner_music_f1': 0.6264550264051614, 'eval_crossner_politics_precision': 0.5221505376343973, 'eval_crossner_politics_recall': 0.6225641025640866, 'eval_crossner_politics_f1': 0.5679532163246404, 'eval_crossner_science_precision': 0.5089080459769969, 'eval_crossner_science_recall': 0.6999999999999723, 'eval_crossner_science_f1': 0.5893510814820118, 'eval_wiki_passage_from_zero_precision': 0.8331298752353544, 'eval_wiki_passage_from_zero_recall': 0.8069338677354693, 'eval_wiki_passage_from_zero_f1': 0.8198226628568328, 'eval_average_f1': 0.5454439169425749, 'eval_runtime': 508.0228, 'eval_samples_per_second': 26.93, 'eval_steps_per_second': 0.106, 'epoch': 9.0}
 38%|███████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                           | 6723/17928 [3:17:45<3:36:39,  1.16s/it]
[INFO|trainer.py:3812] 2024-11-19 22:39:34,605 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-6723
[INFO|configuration_utils.py:414] 2024-11-19 22:39:34,607 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-6723/config.json
[INFO|configuration_utils.py:865] 2024-11-19 22:39:34,607 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-6723/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 22:39:35,171 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-6723/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 22:39:35,173 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-6723/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 22:39:35,173 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-6723/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 22:39:35,174 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-6723/spiece.model
[2024-11-19 22:39:35,190] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step6723 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 22:39:35,196] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/mp_rank_00_model_states.pt
[2024-11-19 22:39:35,196] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/mp_rank_00_model_states.pt...
[2024-11-19 22:39:35,844] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/mp_rank_00_model_states.pt.
[2024-11-19 22:39:35,846] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 22:39:36,474] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 22:39:36,475] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-6723/global_step6723/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 22:39:36,475] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step6723 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0302, 'grad_norm': 0.10276497522948824, 'learning_rate': 5e-05, 'epoch': 9.01}
{'loss': 0.0298, 'grad_norm': 0.13101109207400616, 'learning_rate': 5e-05, 'epoch': 9.02}
{'loss': 0.0315, 'grad_norm': 0.1064558898850039, 'learning_rate': 5e-05, 'epoch': 9.04}
{'loss': 0.0298, 'grad_norm': 0.34575793806977473, 'learning_rate': 5e-05, 'epoch': 9.05}
{'loss': 0.0312, 'grad_norm': 0.13142523902784617, 'learning_rate': 5e-05, 'epoch': 9.06}
{'loss': 0.03, 'grad_norm': 0.07952544175206397, 'learning_rate': 5e-05, 'epoch': 9.08}
{'loss': 0.0313, 'grad_norm': 0.1266083584226443, 'learning_rate': 5e-05, 'epoch': 9.09}
{'loss': 0.0304, 'grad_norm': 0.19348537308710367, 'learning_rate': 5e-05, 'epoch': 9.1}
{'loss': 0.0298, 'grad_norm': 0.10825598437796048, 'learning_rate': 5e-05, 'epoch': 9.12}
{'loss': 0.03, 'grad_norm': 0.08045760813676323, 'learning_rate': 5e-05, 'epoch': 9.13}
{'loss': 0.0305, 'grad_norm': 0.10614395792807725, 'learning_rate': 5e-05, 'epoch': 9.14}
{'loss': 0.031, 'grad_norm': 0.10391846133303469, 'learning_rate': 5e-05, 'epoch': 9.16}
{'loss': 0.0298, 'grad_norm': 0.11591832804443415, 'learning_rate': 5e-05, 'epoch': 9.17}
{'loss': 0.0301, 'grad_norm': 0.09400234434319092, 'learning_rate': 5e-05, 'epoch': 9.18}
{'loss': 0.0307, 'grad_norm': 0.07041991823540523, 'learning_rate': 5e-05, 'epoch': 9.2}
{'loss': 0.0304, 'grad_norm': 0.08703607396020813, 'learning_rate': 5e-05, 'epoch': 9.21}
{'loss': 0.0316, 'grad_norm': 0.09498231321626976, 'learning_rate': 5e-05, 'epoch': 9.22}
{'loss': 0.0313, 'grad_norm': 0.26500673427212307, 'learning_rate': 5e-05, 'epoch': 9.24}
{'loss': 0.0309, 'grad_norm': 0.3034979020962173, 'learning_rate': 5e-05, 'epoch': 9.25}
{'loss': 0.0303, 'grad_norm': 0.1650412407003368, 'learning_rate': 5e-05, 'epoch': 9.26}
{'loss': 0.0307, 'grad_norm': 0.12664924345159487, 'learning_rate': 5e-05, 'epoch': 9.28}
{'loss': 0.0297, 'grad_norm': 0.06510171965132953, 'learning_rate': 5e-05, 'epoch': 9.29}
{'loss': 0.0297, 'grad_norm': 0.08990376996971176, 'learning_rate': 5e-05, 'epoch': 9.3}
{'loss': 0.0304, 'grad_norm': 0.10069900472452438, 'learning_rate': 5e-05, 'epoch': 9.32}
{'loss': 0.0302, 'grad_norm': 0.11823823665776975, 'learning_rate': 5e-05, 'epoch': 9.33}
{'loss': 0.0308, 'grad_norm': 0.10496130923711824, 'learning_rate': 5e-05, 'epoch': 9.34}
{'loss': 0.031, 'grad_norm': 0.11837807498168613, 'learning_rate': 5e-05, 'epoch': 9.36}
{'loss': 0.0309, 'grad_norm': 0.15514265706774175, 'learning_rate': 5e-05, 'epoch': 9.37}
{'loss': 0.0306, 'grad_norm': 0.09402476220649829, 'learning_rate': 5e-05, 'epoch': 9.38}
{'loss': 0.0301, 'grad_norm': 0.08351550239165025, 'learning_rate': 5e-05, 'epoch': 9.4}
{'loss': 0.0304, 'grad_norm': 0.14596423308599793, 'learning_rate': 5e-05, 'epoch': 9.41}
{'loss': 0.0309, 'grad_norm': 0.10771584601121885, 'learning_rate': 5e-05, 'epoch': 9.42}
{'loss': 0.0305, 'grad_norm': 0.10956061740216393, 'learning_rate': 5e-05, 'epoch': 9.44}
{'loss': 0.0298, 'grad_norm': 0.15272095638365038, 'learning_rate': 5e-05, 'epoch': 9.45}
{'loss': 0.0298, 'grad_norm': 0.0942394177462184, 'learning_rate': 5e-05, 'epoch': 9.46}
{'loss': 0.0296, 'grad_norm': 0.11572935189622305, 'learning_rate': 5e-05, 'epoch': 9.48}
{'loss': 0.0305, 'grad_norm': 0.08641208389275298, 'learning_rate': 5e-05, 'epoch': 9.49}
{'loss': 0.0305, 'grad_norm': 0.15345370813058334, 'learning_rate': 5e-05, 'epoch': 9.5}
{'loss': 0.0299, 'grad_norm': 0.1342038178714157, 'learning_rate': 5e-05, 'epoch': 9.52}
{'loss': 0.03, 'grad_norm': 0.13900156856113235, 'learning_rate': 5e-05, 'epoch': 9.53}
{'loss': 0.0307, 'grad_norm': 0.18569421439484307, 'learning_rate': 5e-05, 'epoch': 9.54}
{'loss': 0.0297, 'grad_norm': 0.13401921517178836, 'learning_rate': 5e-05, 'epoch': 9.56}
{'loss': 0.0302, 'grad_norm': 0.12678008390834877, 'learning_rate': 5e-05, 'epoch': 9.57}
{'loss': 0.0305, 'grad_norm': 0.18515180389281166, 'learning_rate': 5e-05, 'epoch': 9.59}
{'loss': 0.03, 'grad_norm': 0.1737489091200854, 'learning_rate': 5e-05, 'epoch': 9.6}
{'loss': 0.0312, 'grad_norm': 0.16397379566177248, 'learning_rate': 5e-05, 'epoch': 9.61}
{'loss': 0.031, 'grad_norm': 0.07550956344646495, 'learning_rate': 5e-05, 'epoch': 9.63}
{'loss': 0.0306, 'grad_norm': 0.12027118859166197, 'learning_rate': 5e-05, 'epoch': 9.64}
{'loss': 0.0301, 'grad_norm': 0.09833337635642797, 'learning_rate': 5e-05, 'epoch': 9.65}
{'loss': 0.0302, 'grad_norm': 0.1407457005879964, 'learning_rate': 5e-05, 'epoch': 9.67}
{'loss': 0.0307, 'grad_norm': 0.13379092806886758, 'learning_rate': 5e-05, 'epoch': 9.68}
{'loss': 0.0295, 'grad_norm': 0.09981605181408854, 'learning_rate': 5e-05, 'epoch': 9.69}
{'loss': 0.0301, 'grad_norm': 0.11958231894658776, 'learning_rate': 5e-05, 'epoch': 9.71}
{'loss': 0.0297, 'grad_norm': 0.09616711595444512, 'learning_rate': 5e-05, 'epoch': 9.72}
{'loss': 0.0293, 'grad_norm': 0.11026900503133077, 'learning_rate': 5e-05, 'epoch': 9.73}
{'loss': 0.0295, 'grad_norm': 0.1071574250532566, 'learning_rate': 5e-05, 'epoch': 9.75}
{'loss': 0.0292, 'grad_norm': 0.15429344656310215, 'learning_rate': 5e-05, 'epoch': 9.76}
{'loss': 0.0297, 'grad_norm': 0.07814934470433713, 'learning_rate': 5e-05, 'epoch': 9.77}
{'loss': 0.0298, 'grad_norm': 0.08930639055236878, 'learning_rate': 5e-05, 'epoch': 9.79}
{'loss': 0.0299, 'grad_norm': 0.11372205046350657, 'learning_rate': 5e-05, 'epoch': 9.8}
{'loss': 0.0298, 'grad_norm': 0.05796478374233105, 'learning_rate': 5e-05, 'epoch': 9.81}
{'loss': 0.03, 'grad_norm': 0.05741441331118541, 'learning_rate': 5e-05, 'epoch': 9.83}
{'loss': 0.0308, 'grad_norm': 0.0761821782650978, 'learning_rate': 5e-05, 'epoch': 9.84}
{'loss': 0.0308, 'grad_norm': 0.12574236191651264, 'learning_rate': 5e-05, 'epoch': 9.85}
{'loss': 0.0295, 'grad_norm': 0.0950613888231051, 'learning_rate': 5e-05, 'epoch': 9.87}
{'loss': 0.0293, 'grad_norm': 0.07168852572301773, 'learning_rate': 5e-05, 'epoch': 9.88}
{'loss': 0.03, 'grad_norm': 0.08459628160156611, 'learning_rate': 5e-05, 'epoch': 9.89}
{'loss': 0.0308, 'grad_norm': 0.12626644169095214, 'learning_rate': 5e-05, 'epoch': 9.91}
{'loss': 0.0296, 'grad_norm': 0.09235148090106911, 'learning_rate': 5e-05, 'epoch': 9.92}
{'loss': 0.03, 'grad_norm': 0.10083495490816861, 'learning_rate': 5e-05, 'epoch': 9.93}
{'loss': 0.0294, 'grad_norm': 0.1204179588011226, 'learning_rate': 5e-05, 'epoch': 9.95}
{'loss': 0.0297, 'grad_norm': 0.11117763553956299, 'learning_rate': 5e-05, 'epoch': 9.96}
{'loss': 0.0289, 'grad_norm': 0.09147391423164591, 'learning_rate': 5e-05, 'epoch': 9.97}
{'loss': 0.0302, 'grad_norm': 0.151168834793708, 'learning_rate': 5e-05, 'epoch': 9.99}
{'loss': 0.0298, 'grad_norm': 0.08950476342849917, 'learning_rate': 5e-05, 'epoch': 10.0}
 42%|████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                  | 7470/17928 [3:31:11<3:19:59,  1.15s/it][INFO|gner_trainer.py:60] 2024-11-19 22:52:58,993 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 22:52:58,993 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 22:52:58,993 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3686.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3648.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3671.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3650.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3633.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3653.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3603.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3623.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4089.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4056.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4079.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4047.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4027.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4086.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4036.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4026.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1367.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1392.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1382.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1383.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1080.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.77it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 958.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 973.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1103.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1081.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.47it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.89it/s]
{'eval_mit-movie_precision': 0.5491842610364551, 'eval_mit-movie_recall': 0.42873197227944504, 'eval_mit-movie_f1': 0.48153991790593936, 'eval_mit-restaurant_precision': 0.46929824561400935, 'eval_mit-restaurant_recall': 0.27174603174602313, 'eval_mit-restaurant_f1': 0.34418978684537715, 'eval_crossner_ai_precision': 0.4429744525547243, 'eval_crossner_ai_recall': 0.6042314872432729, 'eval_crossner_ai_f1': 0.5111871544655046, 'eval_crossner_literature_precision': 0.44963251188930176, 'eval_crossner_literature_recall': 0.5247225025226778, 'eval_crossner_literature_f1': 0.4842840511726259, 'eval_crossner_music_precision': 0.6182779900087976, 'eval_crossner_music_recall': 0.6734955185659195, 'eval_crossner_music_f1': 0.644706603290044, 'eval_crossner_politics_precision': 0.5367419212040607, 'eval_crossner_politics_recall': 0.6217948717948558, 'eval_crossner_politics_f1': 0.5761463530032375, 'eval_crossner_science_precision': 0.5266165413533677, 'eval_crossner_science_recall': 0.6920948616600516, 'eval_crossner_science_f1': 0.5981212638279295, 'eval_wiki_passage_from_zero_precision': 0.8465572661140228, 'eval_wiki_passage_from_zero_recall': 0.8022444889779543, 'eval_wiki_passage_from_zero_f1': 0.8238054080251053, 'eval_average_f1': 0.5579975673169704, 'eval_runtime': 512.1027, 'eval_samples_per_second': 26.715, 'eval_steps_per_second': 0.105, 'epoch': 10.0}
 42%|████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                  | 7470/17928 [3:39:43<3:19:59,  1.15s/it]
[INFO|trainer.py:3812] 2024-11-19 23:01:31,665 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-7470
[INFO|configuration_utils.py:414] 2024-11-19 23:01:31,667 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-7470/config.json
[INFO|configuration_utils.py:865] 2024-11-19 23:01:31,667 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-7470/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 23:01:32,247 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-7470/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 23:01:32,248 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-7470/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 23:01:32,249 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-7470/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 23:01:32,249 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-7470/spiece.model
[2024-11-19 23:01:32,265] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step7470 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 23:01:32,271] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/mp_rank_00_model_states.pt
[2024-11-19 23:01:32,271] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/mp_rank_00_model_states.pt...
[2024-11-19 23:01:32,904] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/mp_rank_00_model_states.pt.
[2024-11-19 23:01:32,905] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 23:01:33,486] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 23:01:33,486] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-7470/global_step7470/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 23:01:33,486] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step7470 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0293, 'grad_norm': 0.11204905648422596, 'learning_rate': 5e-05, 'epoch': 10.01}
{'loss': 0.0305, 'grad_norm': 0.10170053766551798, 'learning_rate': 5e-05, 'epoch': 10.03}
{'loss': 0.0293, 'grad_norm': 0.12659087216287376, 'learning_rate': 5e-05, 'epoch': 10.04}
{'loss': 0.0297, 'grad_norm': 0.07671093929138088, 'learning_rate': 5e-05, 'epoch': 10.05}
{'loss': 0.0299, 'grad_norm': 0.0955672857079189, 'learning_rate': 5e-05, 'epoch': 10.07}
{'loss': 0.0293, 'grad_norm': 0.11720241610647412, 'learning_rate': 5e-05, 'epoch': 10.08}
{'loss': 0.0299, 'grad_norm': 0.17696130746276723, 'learning_rate': 5e-05, 'epoch': 10.09}
{'loss': 0.0309, 'grad_norm': 0.14415297752526146, 'learning_rate': 5e-05, 'epoch': 10.11}
{'loss': 0.0305, 'grad_norm': 0.1319640914262757, 'learning_rate': 5e-05, 'epoch': 10.12}
{'loss': 0.0307, 'grad_norm': 0.0844013762308042, 'learning_rate': 5e-05, 'epoch': 10.13}
{'loss': 0.0299, 'grad_norm': 0.08183258557340164, 'learning_rate': 5e-05, 'epoch': 10.15}
{'loss': 0.0301, 'grad_norm': 0.09908056605101845, 'learning_rate': 5e-05, 'epoch': 10.16}
{'loss': 0.0303, 'grad_norm': 0.06568308768529757, 'learning_rate': 5e-05, 'epoch': 10.17}
{'loss': 0.0299, 'grad_norm': 0.105558185274933, 'learning_rate': 5e-05, 'epoch': 10.19}
{'loss': 0.0295, 'grad_norm': 0.1147228420318021, 'learning_rate': 5e-05, 'epoch': 10.2}
{'loss': 0.0292, 'grad_norm': 0.1185223255576774, 'learning_rate': 5e-05, 'epoch': 10.21}
{'loss': 0.0293, 'grad_norm': 0.09773927973600123, 'learning_rate': 5e-05, 'epoch': 10.23}
{'loss': 0.0291, 'grad_norm': 0.09013825846108155, 'learning_rate': 5e-05, 'epoch': 10.24}
{'loss': 0.0296, 'grad_norm': 0.20196958360436515, 'learning_rate': 5e-05, 'epoch': 10.25}
{'loss': 0.0284, 'grad_norm': 0.13605559826003094, 'learning_rate': 5e-05, 'epoch': 10.27}
{'loss': 0.03, 'grad_norm': 0.09003750495639212, 'learning_rate': 5e-05, 'epoch': 10.28}
{'loss': 0.03, 'grad_norm': 0.1534949359105053, 'learning_rate': 5e-05, 'epoch': 10.29}
{'loss': 0.0297, 'grad_norm': 0.1686406006118077, 'learning_rate': 5e-05, 'epoch': 10.31}
{'loss': 0.0297, 'grad_norm': 0.11191100071418628, 'learning_rate': 5e-05, 'epoch': 10.32}
{'loss': 0.0295, 'grad_norm': 0.1755970307474942, 'learning_rate': 5e-05, 'epoch': 10.33}
{'loss': 0.0294, 'grad_norm': 0.08239868728290232, 'learning_rate': 5e-05, 'epoch': 10.35}
{'loss': 0.0293, 'grad_norm': 0.07661512595221612, 'learning_rate': 5e-05, 'epoch': 10.36}
{'loss': 0.0301, 'grad_norm': 0.11031808598561506, 'learning_rate': 5e-05, 'epoch': 10.37}
{'loss': 0.0291, 'grad_norm': 0.13052828024540086, 'learning_rate': 5e-05, 'epoch': 10.39}
{'loss': 0.0297, 'grad_norm': 0.07508687151493759, 'learning_rate': 5e-05, 'epoch': 10.4}
{'loss': 0.0293, 'grad_norm': 0.11064189089581675, 'learning_rate': 5e-05, 'epoch': 10.41}
{'loss': 0.0295, 'grad_norm': 0.0880642553402248, 'learning_rate': 5e-05, 'epoch': 10.43}
{'loss': 0.0301, 'grad_norm': 0.12159175527515394, 'learning_rate': 5e-05, 'epoch': 10.44}
{'loss': 0.0293, 'grad_norm': 0.08966895909511345, 'learning_rate': 5e-05, 'epoch': 10.46}
{'loss': 0.0289, 'grad_norm': 0.11370767704683547, 'learning_rate': 5e-05, 'epoch': 10.47}
{'loss': 0.0294, 'grad_norm': 0.15547904311184618, 'learning_rate': 5e-05, 'epoch': 10.48}
{'loss': 0.029, 'grad_norm': 0.12070332931451881, 'learning_rate': 5e-05, 'epoch': 10.5}
{'loss': 0.0294, 'grad_norm': 0.1438592482672239, 'learning_rate': 5e-05, 'epoch': 10.51}
{'loss': 0.03, 'grad_norm': 0.14601515323405545, 'learning_rate': 5e-05, 'epoch': 10.52}
{'loss': 0.0286, 'grad_norm': 0.1729077070186193, 'learning_rate': 5e-05, 'epoch': 10.54}
{'loss': 0.0289, 'grad_norm': 0.0779815817739518, 'learning_rate': 5e-05, 'epoch': 10.55}
{'loss': 0.0295, 'grad_norm': 0.10167678949781747, 'learning_rate': 5e-05, 'epoch': 10.56}
{'loss': 0.029, 'grad_norm': 0.0786104260986457, 'learning_rate': 5e-05, 'epoch': 10.58}
{'loss': 0.0286, 'grad_norm': 0.0852660013251365, 'learning_rate': 5e-05, 'epoch': 10.59}
{'loss': 0.0295, 'grad_norm': 0.09662912954176728, 'learning_rate': 5e-05, 'epoch': 10.6}
{'loss': 0.03, 'grad_norm': 0.1088123495220303, 'learning_rate': 5e-05, 'epoch': 10.62}
{'loss': 0.0285, 'grad_norm': 0.12785056630418679, 'learning_rate': 5e-05, 'epoch': 10.63}
{'loss': 0.0294, 'grad_norm': 0.10189752158657298, 'learning_rate': 5e-05, 'epoch': 10.64}
{'loss': 0.0292, 'grad_norm': 0.1596556434190494, 'learning_rate': 5e-05, 'epoch': 10.66}
{'loss': 0.0285, 'grad_norm': 0.11768984018132347, 'learning_rate': 5e-05, 'epoch': 10.67}
{'loss': 0.0292, 'grad_norm': 0.18934141385276862, 'learning_rate': 5e-05, 'epoch': 10.68}
{'loss': 0.0293, 'grad_norm': 0.09053746653463643, 'learning_rate': 5e-05, 'epoch': 10.7}
{'loss': 0.0303, 'grad_norm': 0.07395722716919101, 'learning_rate': 5e-05, 'epoch': 10.71}
{'loss': 0.0297, 'grad_norm': 0.11371960588239519, 'learning_rate': 5e-05, 'epoch': 10.72}
{'loss': 0.03, 'grad_norm': 0.08899747813159828, 'learning_rate': 5e-05, 'epoch': 10.74}
{'loss': 0.0286, 'grad_norm': 0.15891662461576653, 'learning_rate': 5e-05, 'epoch': 10.75}
{'loss': 0.0293, 'grad_norm': 0.09579254371621261, 'learning_rate': 5e-05, 'epoch': 10.76}
{'loss': 0.0294, 'grad_norm': 0.12142631793260203, 'learning_rate': 5e-05, 'epoch': 10.78}
{'loss': 0.0293, 'grad_norm': 0.09779101609615157, 'learning_rate': 5e-05, 'epoch': 10.79}
{'loss': 0.029, 'grad_norm': 0.18876435242646977, 'learning_rate': 5e-05, 'epoch': 10.8}
{'loss': 0.0299, 'grad_norm': 0.1386398560536949, 'learning_rate': 5e-05, 'epoch': 10.82}
{'loss': 0.029, 'grad_norm': 0.14303896513882514, 'learning_rate': 5e-05, 'epoch': 10.83}
{'loss': 0.0288, 'grad_norm': 0.09029878055913756, 'learning_rate': 5e-05, 'epoch': 10.84}
{'loss': 0.0289, 'grad_norm': 0.10494428942717053, 'learning_rate': 5e-05, 'epoch': 10.86}
{'loss': 0.0288, 'grad_norm': 0.07527089964424406, 'learning_rate': 5e-05, 'epoch': 10.87}
{'loss': 0.0293, 'grad_norm': 0.12710562130122188, 'learning_rate': 5e-05, 'epoch': 10.88}
{'loss': 0.0303, 'grad_norm': 0.08741859998781497, 'learning_rate': 5e-05, 'epoch': 10.9}
{'loss': 0.0286, 'grad_norm': 0.09433002157201907, 'learning_rate': 5e-05, 'epoch': 10.91}
{'loss': 0.0301, 'grad_norm': 0.0998336053971862, 'learning_rate': 5e-05, 'epoch': 10.92}
{'loss': 0.0293, 'grad_norm': 0.09052980269432953, 'learning_rate': 5e-05, 'epoch': 10.94}
{'loss': 0.0303, 'grad_norm': 0.08257295921682782, 'learning_rate': 5e-05, 'epoch': 10.95}
{'loss': 0.0296, 'grad_norm': 0.07511617161921322, 'learning_rate': 5e-05, 'epoch': 10.96}
{'loss': 0.0299, 'grad_norm': 0.1050400365342403, 'learning_rate': 5e-05, 'epoch': 10.98}
{'loss': 0.0286, 'grad_norm': 0.08575277632411701, 'learning_rate': 5e-05, 'epoch': 10.99}
 46%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                        | 8217/17928 [3:53:09<2:42:34,  1.00s/it][INFO|gner_trainer.py:60] 2024-11-19 23:14:57,006 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 23:14:57,006 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 23:14:57,006 >>   Batch size = 32
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3646.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3661.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3639.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3630.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3605.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3591.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3646.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4075.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4060.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4049.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4042.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4009.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4079.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4011.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4094.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1392.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1382.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1393.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1083.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1079.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 966.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.42it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 941.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1074.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.69it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 537.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.63it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 534.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.73it/s]
{'eval_mit-movie_precision': 0.5515109890109764, 'eval_mit-movie_recall': 0.451208091402876, 'eval_mit-movie_f1': 0.4963428453198112, 'eval_mit-restaurant_precision': 0.49945652173910327, 'eval_mit-restaurant_recall': 0.2917460317460225, 'eval_mit-restaurant_f1': 0.36833667330012465, 'eval_crossner_ai_precision': 0.4404076207354701, 'eval_crossner_ai_recall': 0.618543870566234, 'eval_crossner_ai_f1': 0.5144927535745767, 'eval_crossner_literature_precision': 0.4548566538296767, 'eval_crossner_literature_recall': 0.536326942482314, 'eval_crossner_literature_f1': 0.49224357485191256, 'eval_crossner_music_precision': 0.6252906976744004, 'eval_crossner_music_recall': 0.6885403329065081, 'eval_crossner_music_f1': 0.6553930529665493, 'eval_crossner_politics_precision': 0.5278745644599188, 'eval_crossner_politics_recall': 0.6215384615384456, 'eval_crossner_politics_f1': 0.5708902495970449, 'eval_crossner_science_precision': 0.5198830409356573, 'eval_crossner_science_recall': 0.7027667984189445, 'eval_crossner_science_f1': 0.597647058774628, 'eval_wiki_passage_from_zero_precision': 0.8393030009680524, 'eval_wiki_passage_from_zero_recall': 0.8166132264529041, 'eval_wiki_passage_from_zero_f1': 0.827802663203809, 'eval_average_f1': 0.5653936089485571, 'eval_runtime': 509.8783, 'eval_samples_per_second': 26.832, 'eval_steps_per_second': 0.106, 'epoch': 11.0}
 46%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                        | 8217/17928 [4:01:39<2:42:34,  1.00s/it]
[INFO|trainer.py:3812] 2024-11-19 23:23:27,116 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-8217
[INFO|configuration_utils.py:414] 2024-11-19 23:23:27,118 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-8217/config.json
[INFO|configuration_utils.py:865] 2024-11-19 23:23:27,118 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-8217/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 23:23:27,753 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-8217/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 23:23:27,755 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-8217/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 23:23:27,755 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-8217/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 23:23:27,755 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-8217/spiece.model
[2024-11-19 23:23:27,771] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step8217 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 23:23:27,777] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/mp_rank_00_model_states.pt
[2024-11-19 23:23:27,777] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/mp_rank_00_model_states.pt...
[2024-11-19 23:23:28,409] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/mp_rank_00_model_states.pt.
[2024-11-19 23:23:28,410] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 23:23:28,990] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 23:23:28,990] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-8217/global_step8217/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 23:23:28,990] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step8217 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0294, 'grad_norm': 0.09030828937198884, 'learning_rate': 5e-05, 'epoch': 11.0}
{'loss': 0.0292, 'grad_norm': 0.07250861285799287, 'learning_rate': 5e-05, 'epoch': 11.02}
{'loss': 0.03, 'grad_norm': 0.145336773854846, 'learning_rate': 5e-05, 'epoch': 11.03}
{'loss': 0.0296, 'grad_norm': 0.11515108428196952, 'learning_rate': 5e-05, 'epoch': 11.04}
{'loss': 0.029, 'grad_norm': 0.12969850786440126, 'learning_rate': 5e-05, 'epoch': 11.06}
{'loss': 0.0288, 'grad_norm': 0.10217976062526167, 'learning_rate': 5e-05, 'epoch': 11.07}
{'loss': 0.0291, 'grad_norm': 0.14481190547442405, 'learning_rate': 5e-05, 'epoch': 11.08}
{'loss': 0.0294, 'grad_norm': 0.09059161956751993, 'learning_rate': 5e-05, 'epoch': 11.1}
{'loss': 0.0287, 'grad_norm': 0.09216382866364374, 'learning_rate': 5e-05, 'epoch': 11.11}
{'loss': 0.0291, 'grad_norm': 0.12897938041097293, 'learning_rate': 5e-05, 'epoch': 11.12}
{'loss': 0.028, 'grad_norm': 0.08615078792581163, 'learning_rate': 5e-05, 'epoch': 11.14}
{'loss': 0.0289, 'grad_norm': 0.2186148174705299, 'learning_rate': 5e-05, 'epoch': 11.15}
{'loss': 0.0285, 'grad_norm': 0.08855176323469842, 'learning_rate': 5e-05, 'epoch': 11.16}
{'loss': 0.0289, 'grad_norm': 0.0597834273078661, 'learning_rate': 5e-05, 'epoch': 11.18}
{'loss': 0.0284, 'grad_norm': 0.08653564259403597, 'learning_rate': 5e-05, 'epoch': 11.19}
{'loss': 0.0288, 'grad_norm': 0.136420551437373, 'learning_rate': 5e-05, 'epoch': 11.2}
{'loss': 0.0286, 'grad_norm': 0.08655159892375042, 'learning_rate': 5e-05, 'epoch': 11.22}
{'loss': 0.0291, 'grad_norm': 0.09300432586382996, 'learning_rate': 5e-05, 'epoch': 11.23}
{'loss': 0.0278, 'grad_norm': 0.0851207031199723, 'learning_rate': 5e-05, 'epoch': 11.24}
{'loss': 0.0292, 'grad_norm': 0.07562314357331187, 'learning_rate': 5e-05, 'epoch': 11.26}
{'loss': 0.0299, 'grad_norm': 0.07547840483138236, 'learning_rate': 5e-05, 'epoch': 11.27}
{'loss': 0.0286, 'grad_norm': 0.08646954759099647, 'learning_rate': 5e-05, 'epoch': 11.29}
{'loss': 0.0288, 'grad_norm': 0.0735842695274979, 'learning_rate': 5e-05, 'epoch': 11.3}
{'loss': 0.0291, 'grad_norm': 0.07719489400985904, 'learning_rate': 5e-05, 'epoch': 11.31}
{'loss': 0.0289, 'grad_norm': 0.06939232910510121, 'learning_rate': 5e-05, 'epoch': 11.33}
{'loss': 0.0289, 'grad_norm': 0.09863112231024466, 'learning_rate': 5e-05, 'epoch': 11.34}
{'loss': 0.0305, 'grad_norm': 0.10561136034925041, 'learning_rate': 5e-05, 'epoch': 11.35}
{'loss': 0.0282, 'grad_norm': 0.25203409298583984, 'learning_rate': 5e-05, 'epoch': 11.37}
{'loss': 0.0291, 'grad_norm': 0.1573897989312554, 'learning_rate': 5e-05, 'epoch': 11.38}
{'loss': 0.0293, 'grad_norm': 0.09306691080539024, 'learning_rate': 5e-05, 'epoch': 11.39}
{'loss': 0.029, 'grad_norm': 0.10659195047630465, 'learning_rate': 5e-05, 'epoch': 11.41}
{'loss': 0.0285, 'grad_norm': 0.09869143660601691, 'learning_rate': 5e-05, 'epoch': 11.42}
{'loss': 0.0282, 'grad_norm': 0.14938964519572423, 'learning_rate': 5e-05, 'epoch': 11.43}
 48%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                   48%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                   48%|███████████████████████████████████████████████████████▎                                                            | 8549/17928 [4:07:38<2:50:43,  1.09s/it]{'loss': 0.0282, 'grad_norm': 0.14440819940693803, 'learning_rate': 5e-05, 'epoch': 11.45}
{'loss': 0.0292, 'grad_norm': 0.07389529228131125, 'learning_rate': 5e-05, 'epoch': 11.46}
{'loss': 0.0287, 'grad_norm': 0.10358912629529567, 'learning_rate': 5e-05, 'epoch': 11.47}
{'loss': 0.0288, 'grad_norm': 0.11735367119673977, 'learning_rate': 5e-05, 'epoch': 11.49}
{'loss': 0.0295, 'grad_norm': 0.1660499929869615, 'learning_rate': 5e-05, 'epoch': 11.5}
{'loss': 0.0282, 'grad_norm': 0.13159033185323826, 'learning_rate': 5e-05, 'epoch': 11.51}
{'loss': 0.0291, 'grad_norm': 0.07168951305017433, 'learning_rate': 5e-05, 'epoch': 11.53}
{'loss': 0.0293, 'grad_norm': 0.12208649337338334, 'learning_rate': 5e-05, 'epoch': 11.54}
{'loss': 0.0286, 'grad_norm': 0.07074524575842048, 'learning_rate': 5e-05, 'epoch': 11.55}
{'loss': 0.0277, 'grad_norm': 0.06364869108134341, 'learning_rate': 5e-05, 'epoch': 11.57}
{'loss': 0.0284, 'grad_norm': 0.07921761076952608, 'learning_rate': 5e-05, 'epoch': 11.58}
{'loss': 0.0284, 'grad_norm': 0.08393050839412305, 'learning_rate': 5e-05, 'epoch': 11.59}
{'loss': 0.0292, 'grad_norm': 0.1427349834606646, 'learning_rate': 5e-05, 'epoch': 11.61}
{'loss': 0.0296, 'grad_norm': 0.1743388442015772, 'learning_rate': 5e-05, 'epoch': 11.62}
{'loss': 0.0285, 'grad_norm': 0.13220044361258654, 'learning_rate': 5e-05, 'epoch': 11.63}
{'loss': 0.0288, 'grad_norm': 0.0996791931506038, 'learning_rate': 5e-05, 'epoch': 11.65}
{'loss': 0.029, 'grad_norm': 0.10658865647488819, 'learning_rate': 5e-05, 'epoch': 11.66}
{'loss': 0.029, 'grad_norm': 0.07445421324652107, 'learning_rate': 5e-05, 'epoch': 11.67}
{'loss': 0.0283, 'grad_norm': 0.11966940136041529, 'learning_rate': 5e-05, 'epoch': 11.69}
{'loss': 0.0291, 'grad_norm': 0.12046515066679914, 'learning_rate': 5e-05, 'epoch': 11.7}
{'loss': 0.0293, 'grad_norm': 0.08574937690363899, 'learning_rate': 5e-05, 'epoch': 11.71}
{'loss': 0.0292, 'grad_norm': 0.12399725750324556, 'learning_rate': 5e-05, 'epoch': 11.73}
{'loss': 0.0294, 'grad_norm': 0.20475298219938004, 'learning_rate': 5e-05, 'epoch': 11.74}
{'loss': 0.0287, 'grad_norm': 0.09170432193356504, 'learning_rate': 5e-05, 'epoch': 11.75}
{'loss': 0.0287, 'grad_norm': 0.0667463736334859, 'learning_rate': 5e-05, 'epoch': 11.77}
{'loss': 0.0295, 'grad_norm': 0.11957974494211643, 'learning_rate': 5e-05, 'epoch': 11.78}
{'loss': 0.0286, 'grad_norm': 0.112843894196204, 'learning_rate': 5e-05, 'epoch': 11.79}
{'loss': 0.0286, 'grad_norm': 0.10336320379810841, 'learning_rate': 5e-05, 'epoch': 11.81}
{'loss': 0.0292, 'grad_norm': 0.09897667365610281, 'learning_rate': 5e-05, 'epoch': 11.82}
{'loss': 0.0285, 'grad_norm': 0.15108336018459328, 'learning_rate': 5e-05, 'epoch': 11.83}
{'loss': 0.0283, 'grad_norm': 0.09135320664941338, 'learning_rate': 5e-05, 'epoch': 11.85}
{'loss': 0.0291, 'grad_norm': 0.07617683883534557, 'learning_rate': 5e-05, 'epoch': 11.86}
{'loss': 0.0291, 'grad_norm': 0.07286682263108439, 'learning_rate': 5e-05, 'epoch': 11.87}
{'loss': 0.0284, 'grad_norm': 0.09005512892726668, 'learning_rate': 5e-05, 'epoch': 11.89}
{'loss': 0.0289, 'grad_norm': 0.07092327833457615, 'learning_rate': 5e-05, 'epoch': 11.9}
{'loss': 0.0287, 'grad_norm': 0.06211789308172911, 'learning_rate': 5e-05, 'epoch': 11.91}
{'loss': 0.0281, 'grad_norm': 0.08124982943883746, 'learning_rate': 5e-05, 'epoch': 11.93}
{'loss': 0.0288, 'grad_norm': 0.0735653772097325, 'learning_rate': 5e-05, 'epoch': 11.94}
{'loss': 0.0293, 'grad_norm': 0.09694911040909422, 'learning_rate': 5e-05, 'epoch': 11.95}
{'loss': 0.0289, 'grad_norm': 0.1621074676401463, 'learning_rate': 5e-05, 'epoch': 11.97}
{'loss': 0.029, 'grad_norm': 0.21168246996512066, 'learning_rate': 5e-05, 'epoch': 11.98}
{'loss': 0.0292, 'grad_norm': 0.08149261976026305, 'learning_rate': 5e-05, 'epoch': 11.99}
 50%|██████████████████████████████████████████████████████████                                                          | 8964/17928 [4:15:03<2:29:33,  1.00s/it][INFO|gner_trainer.py:60] 2024-11-19 23:36:51,106 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 23:36:51,106 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 23:36:51,106 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3668.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3651.25it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3632.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3646.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3643.67it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3597.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3682.31it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3628.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4084.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4053.69it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4050.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4093.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4059.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4018.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4091.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4020.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1379.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1086.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1070.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1084.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 967.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 963.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 941.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 943.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1081.20it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 546.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.55it/s]
{'eval_mit-movie_precision': 0.5439282428702726, 'eval_mit-movie_recall': 0.44296684772428463, 'eval_mit-movie_f1': 0.4882832661836091, 'eval_mit-restaurant_precision': 0.46846846846844364, 'eval_mit-restaurant_recall': 0.28063492063491174, 'eval_mit-restaurant_f1': 0.3510025808544599, 'eval_crossner_ai_precision': 0.43324491600351756, 'eval_crossner_ai_recall': 0.6098319850653012, 'eval_crossner_ai_f1': 0.5065908503003342, 'eval_crossner_literature_precision': 0.45369184805802587, 'eval_crossner_literature_recall': 0.536326942482314, 'eval_crossner_literature_f1': 0.49156069359194415, 'eval_crossner_music_precision': 0.6251079758133998, 'eval_crossner_music_recall': 0.6949423815620777, 'eval_crossner_music_f1': 0.6581779596287619, 'eval_crossner_politics_precision': 0.5365638766519706, 'eval_crossner_politics_recall': 0.6246153846153686, 'eval_crossner_politics_f1': 0.5772511847843971, 'eval_crossner_science_precision': 0.5210384959713363, 'eval_crossner_science_recall': 0.6901185770750715, 'eval_crossner_science_f1': 0.5937765685617348, 'eval_wiki_passage_from_zero_precision': 0.8451302555132112, 'eval_wiki_passage_from_zero_recall': 0.8133066132264513, 'eval_wiki_passage_from_zero_f1': 0.8289131033701206, 'eval_average_f1': 0.5619445259094202, 'eval_runtime': 512.9477, 'eval_samples_per_second': 26.671, 'eval_steps_per_second': 0.105, 'epoch': 12.0}
 50%|██████████████████████████████████████████████████████████                                                          | 8964/17928 [4:23:36<2:29:33,  1.00s/it]
[INFO|trainer.py:3812] 2024-11-19 23:45:24,809 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-8964
[INFO|configuration_utils.py:414] 2024-11-19 23:45:24,812 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-8964/config.json
[INFO|configuration_utils.py:865] 2024-11-19 23:45:24,812 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-8964/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 23:45:25,424 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-8964/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 23:45:25,426 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-8964/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 23:45:25,426 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-8964/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 23:45:25,427 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-8964/spiece.model
[2024-11-19 23:45:25,444] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step8964 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 23:45:25,450] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/mp_rank_00_model_states.pt
[2024-11-19 23:45:25,450] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/mp_rank_00_model_states.pt...
[2024-11-19 23:45:26,092] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/mp_rank_00_model_states.pt.
[2024-11-19 23:45:26,094] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 23:45:26,791] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 23:45:26,791] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-8964/global_step8964/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 23:45:26,791] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step8964 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0276, 'grad_norm': 0.17599192815797007, 'learning_rate': 5e-05, 'epoch': 12.01}
{'loss': 0.0278, 'grad_norm': 0.23642129086276123, 'learning_rate': 5e-05, 'epoch': 12.02}
{'loss': 0.0286, 'grad_norm': 0.12380311198871083, 'learning_rate': 5e-05, 'epoch': 12.03}
{'loss': 0.0283, 'grad_norm': 0.11876657662012298, 'learning_rate': 5e-05, 'epoch': 12.05}
{'loss': 0.0288, 'grad_norm': 0.09273072815644312, 'learning_rate': 5e-05, 'epoch': 12.06}
{'loss': 0.0281, 'grad_norm': 0.09602591031159974, 'learning_rate': 5e-05, 'epoch': 12.07}
{'loss': 0.0288, 'grad_norm': 0.09386199480410536, 'learning_rate': 5e-05, 'epoch': 12.09}
{'loss': 0.0282, 'grad_norm': 0.10683987486451353, 'learning_rate': 5e-05, 'epoch': 12.1}
{'loss': 0.0278, 'grad_norm': 0.16187250112386958, 'learning_rate': 5e-05, 'epoch': 12.12}
{'loss': 0.0288, 'grad_norm': 0.0730153959447434, 'learning_rate': 5e-05, 'epoch': 12.13}
{'loss': 0.0287, 'grad_norm': 0.13925708941770837, 'learning_rate': 5e-05, 'epoch': 12.14}
{'loss': 0.0279, 'grad_norm': 0.13307323527313533, 'learning_rate': 5e-05, 'epoch': 12.16}
{'loss': 0.028, 'grad_norm': 0.06770663266919373, 'learning_rate': 5e-05, 'epoch': 12.17}
{'loss': 0.0279, 'grad_norm': 0.09171352254602448, 'learning_rate': 5e-05, 'epoch': 12.18}
{'loss': 0.0287, 'grad_norm': 0.13305710258753664, 'learning_rate': 5e-05, 'epoch': 12.2}
{'loss': 0.0288, 'grad_norm': 0.10516814821362083, 'learning_rate': 5e-05, 'epoch': 12.21}
{'loss': 0.0281, 'grad_norm': 0.07529508795520391, 'learning_rate': 5e-05, 'epoch': 12.22}
{'loss': 0.0288, 'grad_norm': 0.1303095011286012, 'learning_rate': 5e-05, 'epoch': 12.24}
{'loss': 0.0285, 'grad_norm': 0.14415526457879144, 'learning_rate': 5e-05, 'epoch': 12.25}
{'loss': 0.0283, 'grad_norm': 0.0707983148079449, 'learning_rate': 5e-05, 'epoch': 12.26}
{'loss': 0.0293, 'grad_norm': 0.09382034682432779, 'learning_rate': 5e-05, 'epoch': 12.28}
{'loss': 0.0288, 'grad_norm': 0.13918736509719978, 'learning_rate': 5e-05, 'epoch': 12.29}
{'loss': 0.0283, 'grad_norm': 0.09760198515978606, 'learning_rate': 5e-05, 'epoch': 12.3}
{'loss': 0.0291, 'grad_norm': 0.09139453698777929, 'learning_rate': 5e-05, 'epoch': 12.32}
{'loss': 0.0283, 'grad_norm': 0.07005642912311985, 'learning_rate': 5e-05, 'epoch': 12.33}
{'loss': 0.0286, 'grad_norm': 0.06691713368949906, 'learning_rate': 5e-05, 'epoch': 12.34}
{'loss': 0.0281, 'grad_norm': 0.05822588160493042, 'learning_rate': 5e-05, 'epoch': 12.36}
{'loss': 0.0287, 'grad_norm': 0.09763867696960586, 'learning_rate': 5e-05, 'epoch': 12.37}
{'loss': 0.0289, 'grad_norm': 0.09643461009669115, 'learning_rate': 5e-05, 'epoch': 12.38}
{'loss': 0.0292, 'grad_norm': 0.08141557942049726, 'learning_rate': 5e-05, 'epoch': 12.4}
{'loss': 0.027, 'grad_norm': 0.09447117918483278, 'learning_rate': 5e-05, 'epoch': 12.41}
{'loss': 0.0288, 'grad_norm': 0.13137992831131956, 'learning_rate': 5e-05, 'epoch': 12.42}
{'loss': 0.0294, 'grad_norm': 0.1139641435694821, 'learning_rate': 5e-05, 'epoch': 12.44}
{'loss': 0.0278, 'grad_norm': 0.13120012612985518, 'learning_rate': 5e-05, 'epoch': 12.45}
{'loss': 0.0282, 'grad_norm': 0.10043615930151432, 'learning_rate': 5e-05, 'epoch': 12.46}
{'loss': 0.0293, 'grad_norm': 0.10190518501746482, 'learning_rate': 5e-05, 'epoch': 12.48}
{'loss': 0.0281, 'grad_norm': 0.14388079808547266, 'learning_rate': 5e-05, 'epoch': 12.49}
{'loss': 0.0293, 'grad_norm': 0.13757016196267863, 'learning_rate': 5e-05, 'epoch': 12.5}
{'loss': 0.0287, 'grad_norm': 0.12547597565040758, 'learning_rate': 5e-05, 'epoch': 12.52}
{'loss': 0.028, 'grad_norm': 0.07303945776566911, 'learning_rate': 5e-05, 'epoch': 12.53}
{'loss': 0.029, 'grad_norm': 0.12091857406595329, 'learning_rate': 5e-05, 'epoch': 12.54}
{'loss': 0.0281, 'grad_norm': 0.10777295137042044, 'learning_rate': 5e-05, 'epoch': 12.56}
{'loss': 0.0274, 'grad_norm': 0.08009704215208036, 'learning_rate': 5e-05, 'epoch': 12.57}
{'loss': 0.028, 'grad_norm': 0.0759950842014572, 'learning_rate': 5e-05, 'epoch': 12.58}
{'loss': 0.0279, 'grad_norm': 0.07153787369827116, 'learning_rate': 5e-05, 'epoch': 12.6}
{'loss': 0.0284, 'grad_norm': 0.14345452973201847, 'learning_rate': 5e-05, 'epoch': 12.61}
{'loss': 0.0293, 'grad_norm': 0.14217444323232334, 'learning_rate': 5e-05, 'epoch': 12.62}
{'loss': 0.0289, 'grad_norm': 0.08108324386642629, 'learning_rate': 5e-05, 'epoch': 12.64}
{'loss': 0.0277, 'grad_norm': 0.13965349254928974, 'learning_rate': 5e-05, 'epoch': 12.65}
{'loss': 0.0289, 'grad_norm': 0.13134907434541748, 'learning_rate': 5e-05, 'epoch': 12.66}
{'loss': 0.0288, 'grad_norm': 0.09294266575243783, 'learning_rate': 5e-05, 'epoch': 12.68}
{'loss': 0.0282, 'grad_norm': 0.10473054812116982, 'learning_rate': 5e-05, 'epoch': 12.69}
{'loss': 0.0279, 'grad_norm': 0.10229505843925009, 'learning_rate': 5e-05, 'epoch': 12.7}
{'loss': 0.0286, 'grad_norm': 0.0985761139568269, 'learning_rate': 5e-05, 'epoch': 12.72}
{'loss': 0.0291, 'grad_norm': 0.10795634994156583, 'learning_rate': 5e-05, 'epoch': 12.73}
{'loss': 0.0287, 'grad_norm': 0.2775606462433484, 'learning_rate': 5e-05, 'epoch': 12.74}
{'loss': 0.0277, 'grad_norm': 0.0996840141248956, 'learning_rate': 5e-05, 'epoch': 12.76}
{'loss': 0.0276, 'grad_norm': 0.09730888098092094, 'learning_rate': 5e-05, 'epoch': 12.77}
{'loss': 0.0281, 'grad_norm': 0.08947384398612387, 'learning_rate': 5e-05, 'epoch': 12.78}
{'loss': 0.0276, 'grad_norm': 0.16806657293512034, 'learning_rate': 5e-05, 'epoch': 12.8}
{'loss': 0.0278, 'grad_norm': 0.055271085362210856, 'learning_rate': 5e-05, 'epoch': 12.81}
{'loss': 0.0289, 'grad_norm': 0.10692184418529137, 'learning_rate': 5e-05, 'epoch': 12.82}
{'loss': 0.0279, 'grad_norm': 0.1106870244741322, 'learning_rate': 5e-05, 'epoch': 12.84}
{'loss': 0.0282, 'grad_norm': 0.09385508369960287, 'learning_rate': 5e-05, 'epoch': 12.85}
{'loss': 0.0282, 'grad_norm': 0.06299420631988831, 'learning_rate': 5e-05, 'epoch': 12.86}
{'loss': 0.0283, 'grad_norm': 0.0771918928917571, 'learning_rate': 5e-05, 'epoch': 12.88}
{'loss': 0.0276, 'grad_norm': 0.1493873821696973, 'learning_rate': 5e-05, 'epoch': 12.89}
{'loss': 0.0288, 'grad_norm': 0.1380989165728345, 'learning_rate': 5e-05, 'epoch': 12.9}
{'loss': 0.029, 'grad_norm': 0.0672916680494452, 'learning_rate': 5e-05, 'epoch': 12.92}
{'loss': 0.0288, 'grad_norm': 0.09645939785525785, 'learning_rate': 5e-05, 'epoch': 12.93}
{'loss': 0.0283, 'grad_norm': 0.1067040867666476, 'learning_rate': 5e-05, 'epoch': 12.95}
{'loss': 0.0295, 'grad_norm': 0.10294635355477216, 'learning_rate': 5e-05, 'epoch': 12.96}
{'loss': 0.0286, 'grad_norm': 0.08099925202227436, 'learning_rate': 5e-05, 'epoch': 12.97}
{'loss': 0.027, 'grad_norm': 0.08175706738671483, 'learning_rate': 5e-05, 'epoch': 12.99}
{'loss': 0.0281, 'grad_norm': 0.13423798417727723, 'learning_rate': 5e-05, 'epoch': 13.0}
 54%|██████████████████████████████████████████████████████████████▊                                                     | 9711/17928 [4:37:02<2:22:54,  1.04s/it][INFO|gner_trainer.py:60] 2024-11-19 23:58:49,732 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 23:58:49,732 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-19 23:58:49,732 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3623.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3591.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3632.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3634.26it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3580.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3650.22it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3629.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4054.65it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4058.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3669.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4064.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4109.44it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4056.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4069.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1398.63it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4051.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1401.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1393.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4092.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.20it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1083.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 981.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.92it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 528.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.26it/s]
{'eval_mit-movie_precision': 0.5526742301458543, 'eval_mit-movie_recall': 0.4470874695635803, 'eval_mit-movie_f1': 0.49430523913050195, 'eval_mit-restaurant_precision': 0.5219780219779933, 'eval_mit-restaurant_recall': 0.301587301587292, 'eval_mit-restaurant_f1': 0.3822937625290179, 'eval_crossner_ai_precision': 0.4348410210478981, 'eval_crossner_ai_recall': 0.6042314872432729, 'eval_crossner_ai_f1': 0.5057291666179692, 'eval_crossner_literature_precision': 0.4708654670094057, 'eval_crossner_literature_recall': 0.5544904137234836, 'eval_crossner_literature_f1': 0.5092678405434508, 'eval_crossner_music_precision': 0.6196372012668984, 'eval_crossner_music_recall': 0.6888604353392865, 'eval_crossner_music_f1': 0.6524177656011737, 'eval_crossner_politics_precision': 0.5709930313588726, 'eval_crossner_politics_recall': 0.6723076923076751, 'eval_crossner_politics_f1': 0.6175223739493755, 'eval_crossner_science_precision': 0.5399172087522016, 'eval_crossner_science_recall': 0.721739130434754, 'eval_crossner_science_f1': 0.6177266575964843, 'eval_wiki_passage_from_zero_precision': 0.8336718482916708, 'eval_wiki_passage_from_zero_recall': 0.8307815631262508, 'eval_wiki_passage_from_zero_f1': 0.8322241962020185, 'eval_average_f1': 0.576435875271249, 'eval_runtime': 519.1648, 'eval_samples_per_second': 26.352, 'eval_steps_per_second': 0.104, 'epoch': 13.0}
 54%|██████████████████████████████████████████████████████████████▊                                                     | 9711/17928 [4:45:41<2:22:54,  1.04s/it]
[INFO|trainer.py:3812] 2024-11-20 00:07:29,367 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-9711
[INFO|configuration_utils.py:414] 2024-11-20 00:07:29,370 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-9711/config.json
[INFO|configuration_utils.py:865] 2024-11-20 00:07:29,370 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-9711/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 00:07:30,000 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-9711/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 00:07:30,002 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-9711/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 00:07:30,002 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-9711/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 00:07:30,003 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-9711/spiece.model
[2024-11-20 00:07:30,025] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step9711 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 00:07:30,030] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/mp_rank_00_model_states.pt
[2024-11-20 00:07:30,031] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/mp_rank_00_model_states.pt...
[2024-11-20 00:07:30,698] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/mp_rank_00_model_states.pt.
[2024-11-20 00:07:30,700] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 00:07:31,401] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 00:07:31,401] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-9711/global_step9711/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 00:07:31,401] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step9711 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.028, 'grad_norm': 0.10828176869850271, 'learning_rate': 5e-05, 'epoch': 13.01}
{'loss': 0.029, 'grad_norm': 0.1513281187275111, 'learning_rate': 5e-05, 'epoch': 13.03}
{'loss': 0.0283, 'grad_norm': 0.07250374791512516, 'learning_rate': 5e-05, 'epoch': 13.04}
{'loss': 0.0273, 'grad_norm': 0.11895519428515261, 'learning_rate': 5e-05, 'epoch': 13.05}
{'loss': 0.0278, 'grad_norm': 0.08813122295751603, 'learning_rate': 5e-05, 'epoch': 13.07}
{'loss': 0.0283, 'grad_norm': 0.0891070325678343, 'learning_rate': 5e-05, 'epoch': 13.08}
{'loss': 0.0278, 'grad_norm': 0.06469031242577769, 'learning_rate': 5e-05, 'epoch': 13.09}
{'loss': 0.0285, 'grad_norm': 0.2926439392058599, 'learning_rate': 5e-05, 'epoch': 13.11}
{'loss': 0.0282, 'grad_norm': 0.10499504343039205, 'learning_rate': 5e-05, 'epoch': 13.12}
{'loss': 0.0285, 'grad_norm': 0.10673598315809293, 'learning_rate': 5e-05, 'epoch': 13.13}
{'loss': 0.0273, 'grad_norm': 0.08121387522247779, 'learning_rate': 5e-05, 'epoch': 13.15}
{'loss': 0.0279, 'grad_norm': 0.07344810150608155, 'learning_rate': 5e-05, 'epoch': 13.16}
{'loss': 0.0264, 'grad_norm': 0.057530329586065826, 'learning_rate': 5e-05, 'epoch': 13.17}
{'loss': 0.029, 'grad_norm': 0.05608335486338893, 'learning_rate': 5e-05, 'epoch': 13.19}
{'loss': 0.0281, 'grad_norm': 0.09043547403759272, 'learning_rate': 5e-05, 'epoch': 13.2}
{'loss': 0.0274, 'grad_norm': 0.0850064796851265, 'learning_rate': 5e-05, 'epoch': 13.21}
{'loss': 0.0281, 'grad_norm': 0.07215743730071282, 'learning_rate': 5e-05, 'epoch': 13.23}
{'loss': 0.0284, 'grad_norm': 0.1281109828375836, 'learning_rate': 5e-05, 'epoch': 13.24}
{'loss': 0.0286, 'grad_norm': 0.1146068499195299, 'learning_rate': 5e-05, 'epoch': 13.25}
{'loss': 0.0283, 'grad_norm': 0.08884938554303112, 'learning_rate': 5e-05, 'epoch': 13.27}
{'loss': 0.0284, 'grad_norm': 0.09534836235130317, 'learning_rate': 5e-05, 'epoch': 13.28}
{'loss': 0.0273, 'grad_norm': 0.09800960508724033, 'learning_rate': 5e-05, 'epoch': 13.29}
{'loss': 0.0283, 'grad_norm': 0.0712228787873285, 'learning_rate': 5e-05, 'epoch': 13.31}
{'loss': 0.0279, 'grad_norm': 0.07338639368111248, 'learning_rate': 5e-05, 'epoch': 13.32}
{'loss': 0.0269, 'grad_norm': 0.05661579319453124, 'learning_rate': 5e-05, 'epoch': 13.33}
{'loss': 0.0279, 'grad_norm': 0.05755676722273958, 'learning_rate': 5e-05, 'epoch': 13.35}
{'loss': 0.0271, 'grad_norm': 0.09275441727665151, 'learning_rate': 5e-05, 'epoch': 13.36}
{'loss': 0.0275, 'grad_norm': 0.1254639434962682, 'learning_rate': 5e-05, 'epoch': 13.37}
{'loss': 0.0277, 'grad_norm': 0.08844171052351942, 'learning_rate': 5e-05, 'epoch': 13.39}
{'loss': 0.0286, 'grad_norm': 0.0646208041390473, 'learning_rate': 5e-05, 'epoch': 13.4}
{'loss': 0.028, 'grad_norm': 0.07969334080738918, 'learning_rate': 5e-05, 'epoch': 13.41}
{'loss': 0.0286, 'grad_norm': 0.10399671090895798, 'learning_rate': 5e-05, 'epoch': 13.43}
{'loss': 0.0287, 'grad_norm': 0.08323418380070133, 'learning_rate': 5e-05, 'epoch': 13.44}
{'loss': 0.0276, 'grad_norm': 0.08814720214002443, 'learning_rate': 5e-05, 'epoch': 13.45}
{'loss': 0.0279, 'grad_norm': 0.09332228486446571, 'learning_rate': 5e-05, 'epoch': 13.47}
{'loss': 0.028, 'grad_norm': 0.08396910096046549, 'learning_rate': 5e-05, 'epoch': 13.48}
{'loss': 0.0278, 'grad_norm': 0.06867167457078277, 'learning_rate': 5e-05, 'epoch': 13.49}
{'loss': 0.027, 'grad_norm': 0.08627224339062346, 'learning_rate': 5e-05, 'epoch': 13.51}
{'loss': 0.0276, 'grad_norm': 0.0864847838513601, 'learning_rate': 5e-05, 'epoch': 13.52}
{'loss': 0.0284, 'grad_norm': 0.0695854720317125, 'learning_rate': 5e-05, 'epoch': 13.53}
{'loss': 0.0279, 'grad_norm': 0.08087911894603804, 'learning_rate': 5e-05, 'epoch': 13.55}
{'loss': 0.0287, 'grad_norm': 0.08454742870879159, 'learning_rate': 5e-05, 'epoch': 13.56}
{'loss': 0.0279, 'grad_norm': 0.08691008430120324, 'learning_rate': 5e-05, 'epoch': 13.57}
{'loss': 0.0286, 'grad_norm': 0.08062368148827119, 'learning_rate': 5e-05, 'epoch': 13.59}
{'loss': 0.0277, 'grad_norm': 0.12645683852380107, 'learning_rate': 5e-05, 'epoch': 13.6}
{'loss': 0.0287, 'grad_norm': 0.0641854282871738, 'learning_rate': 5e-05, 'epoch': 13.61}
{'loss': 0.0285, 'grad_norm': 0.12429093251987676, 'learning_rate': 5e-05, 'epoch': 13.63}
{'loss': 0.0273, 'grad_norm': 0.11999819063769651, 'learning_rate': 5e-05, 'epoch': 13.64}
{'loss': 0.027, 'grad_norm': 0.06536554281067536, 'learning_rate': 5e-05, 'epoch': 13.65}
{'loss': 0.0276, 'grad_norm': 0.08754780189521176, 'learning_rate': 5e-05, 'epoch': 13.67}
{'loss': 0.0273, 'grad_norm': 0.07863989669717225, 'learning_rate': 5e-05, 'epoch': 13.68}
{'loss': 0.0274, 'grad_norm': 0.09816751163615009, 'learning_rate': 5e-05, 'epoch': 13.69}
{'loss': 0.0279, 'grad_norm': 0.09414207904531671, 'learning_rate': 5e-05, 'epoch': 13.71}
{'loss': 0.0281, 'grad_norm': 0.08827258664639497, 'learning_rate': 5e-05, 'epoch': 13.72}
{'loss': 0.0275, 'grad_norm': 0.11510530209808398, 'learning_rate': 5e-05, 'epoch': 13.73}
{'loss': 0.0282, 'grad_norm': 0.10417114387268225, 'learning_rate': 5e-05, 'epoch': 13.75}
{'loss': 0.0272, 'grad_norm': 0.12681652936836915, 'learning_rate': 5e-05, 'epoch': 13.76}
{'loss': 0.0278, 'grad_norm': 0.09264328007842984, 'learning_rate': 5e-05, 'epoch': 13.78}
{'loss': 0.0275, 'grad_norm': 0.09659842245024898, 'learning_rate': 5e-05, 'epoch': 13.79}
{'loss': 0.0274, 'grad_norm': 0.10837833114969157, 'learning_rate': 5e-05, 'epoch': 13.8}
{'loss': 0.0273, 'grad_norm': 0.07913779382640597, 'learning_rate': 5e-05, 'epoch': 13.82}
{'loss': 0.0274, 'grad_norm': 0.09497413530987853, 'learning_rate': 5e-05, 'epoch': 13.83}
{'loss': 0.0282, 'grad_norm': 0.13135999316735605, 'learning_rate': 5e-05, 'epoch': 13.84}
{'loss': 0.0279, 'grad_norm': 0.08301854344735515, 'learning_rate': 5e-05, 'epoch': 13.86}
{'loss': 0.0278, 'grad_norm': 0.09004010119221764, 'learning_rate': 5e-05, 'epoch': 13.87}
{'loss': 0.0281, 'grad_norm': 0.08136533760260761, 'learning_rate': 5e-05, 'epoch': 13.88}
{'loss': 0.0271, 'grad_norm': 0.15802567738187326, 'learning_rate': 5e-05, 'epoch': 13.9}
{'loss': 0.0278, 'grad_norm': 0.14438756037649655, 'learning_rate': 5e-05, 'epoch': 13.91}
{'loss': 0.0267, 'grad_norm': 0.09720709506587102, 'learning_rate': 5e-05, 'epoch': 13.92}
{'loss': 0.0272, 'grad_norm': 0.10892006230983553, 'learning_rate': 5e-05, 'epoch': 13.94}
{'loss': 0.0276, 'grad_norm': 0.06573336147055626, 'learning_rate': 5e-05, 'epoch': 13.95}
{'loss': 0.0272, 'grad_norm': 0.09127480600838485, 'learning_rate': 5e-05, 'epoch': 13.96}
{'loss': 0.0282, 'grad_norm': 0.18346605527052479, 'learning_rate': 5e-05, 'epoch': 13.98}
{'loss': 0.0273, 'grad_norm': 0.06539137985677967, 'learning_rate': 5e-05, 'epoch': 13.99}
 58%|███████████████████████████████████████████████████████████████████                                                | 10458/17928 [4:59:06<2:14:10,  1.08s/it][INFO|gner_trainer.py:60] 2024-11-20 00:20:54,418 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 00:20:54,418 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 00:20:54,418 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3660.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3666.29it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3619.47it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3620.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3675.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3673.50it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3591.74it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4102.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4075.01it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4105.35it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4037.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4090.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4026.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4079.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4004.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1387.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1385.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1083.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 983.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 981.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 949.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 946.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 534.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 538.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.62it/s]
{'eval_mit-movie_precision': 0.5559233861432832, 'eval_mit-movie_recall': 0.44034463382655104, 'eval_mit-movie_f1': 0.49142976583695036, 'eval_mit-restaurant_precision': 0.5190502484814733, 'eval_mit-restaurant_recall': 0.2984126984126889, 'eval_mit-restaurant_f1': 0.37895585562788636, 'eval_crossner_ai_precision': 0.4504792332268165, 'eval_crossner_ai_recall': 0.6141879278157676, 'eval_crossner_ai_f1': 0.5197472353382006, 'eval_crossner_literature_precision': 0.4769230769230565, 'eval_crossner_literature_recall': 0.5630676084762581, 'eval_crossner_literature_f1': 0.5164275797744747, 'eval_crossner_music_precision': 0.6252516537244571, 'eval_crossner_music_recall': 0.6959026888604131, 'eval_crossner_music_f1': 0.6586880775141285, 'eval_crossner_politics_precision': 0.5541248363160071, 'eval_crossner_politics_recall': 0.6510256410256243, 'eval_crossner_politics_f1': 0.5986795566586327, 'eval_crossner_science_precision': 0.5402605091770118, 'eval_crossner_science_recall': 0.7213438735177581, 'eval_crossner_science_f1': 0.6178063642028712, 'eval_wiki_passage_from_zero_precision': 0.8475613551023777, 'eval_wiki_passage_from_zero_recall': 0.8187374749498981, 'eval_wiki_passage_from_zero_f1': 0.8329001151350738, 'eval_average_f1': 0.5768293187610273, 'eval_runtime': 512.4411, 'eval_samples_per_second': 26.698, 'eval_steps_per_second': 0.105, 'epoch': 14.0}
 58%|███████████████████████████████████████████████████████████████████                                                | 10458/17928 [5:07:39<2:14:10,  1.08s/it]
[INFO|trainer.py:3812] 2024-11-20 00:29:27,350 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-10458
[INFO|configuration_utils.py:414] 2024-11-20 00:29:27,352 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-10458/config.json
[INFO|configuration_utils.py:865] 2024-11-20 00:29:27,352 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-10458/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 00:29:28,079 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-10458/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 00:29:28,081 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-10458/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 00:29:28,081 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-10458/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 00:29:28,082 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-10458/spiece.model
[2024-11-20 00:29:28,104] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step10458 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 00:29:28,116] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/mp_rank_00_model_states.pt
[2024-11-20 00:29:28,116] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/mp_rank_00_model_states.pt...
[2024-11-20 00:29:28,841] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/mp_rank_00_model_states.pt.
[2024-11-20 00:29:28,843] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 00:29:29,593] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 00:29:29,593] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-10458/global_step10458/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 00:29:29,593] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step10458 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0276, 'grad_norm': 0.10309495108813349, 'learning_rate': 5e-05, 'epoch': 14.0}
{'loss': 0.0279, 'grad_norm': 0.06931655236704698, 'learning_rate': 5e-05, 'epoch': 14.02}
{'loss': 0.0284, 'grad_norm': 0.15206037355128543, 'learning_rate': 5e-05, 'epoch': 14.03}
{'loss': 0.0279, 'grad_norm': 0.11159205939343067, 'learning_rate': 5e-05, 'epoch': 14.04}
{'loss': 0.0268, 'grad_norm': 0.06812427488102982, 'learning_rate': 5e-05, 'epoch': 14.06}
{'loss': 0.0275, 'grad_norm': 0.078203263420798, 'learning_rate': 5e-05, 'epoch': 14.07}
{'loss': 0.0281, 'grad_norm': 0.10047917116203248, 'learning_rate': 5e-05, 'epoch': 14.08}
{'loss': 0.0267, 'grad_norm': 0.07584790574752935, 'learning_rate': 5e-05, 'epoch': 14.1}
{'loss': 0.0282, 'grad_norm': 0.05067609711332983, 'learning_rate': 5e-05, 'epoch': 14.11}
{'loss': 0.0272, 'grad_norm': 0.06017578523060737, 'learning_rate': 5e-05, 'epoch': 14.12}
{'loss': 0.0275, 'grad_norm': 0.15745598776023284, 'learning_rate': 5e-05, 'epoch': 14.14}
{'loss': 0.0282, 'grad_norm': 0.1357491443415629, 'learning_rate': 5e-05, 'epoch': 14.15}
{'loss': 0.0275, 'grad_norm': 0.08136651368944964, 'learning_rate': 5e-05, 'epoch': 14.16}
{'loss': 0.0272, 'grad_norm': 0.12908855465038616, 'learning_rate': 5e-05, 'epoch': 14.18}
{'loss': 0.0271, 'grad_norm': 0.09309235018061572, 'learning_rate': 5e-05, 'epoch': 14.19}
{'loss': 0.0273, 'grad_norm': 0.21403403719439154, 'learning_rate': 5e-05, 'epoch': 14.2}
{'loss': 0.0279, 'grad_norm': 0.09232261442465456, 'learning_rate': 5e-05, 'epoch': 14.22}
{'loss': 0.028, 'grad_norm': 0.07403972013849025, 'learning_rate': 5e-05, 'epoch': 14.23}
{'loss': 0.0266, 'grad_norm': 0.08662706578170204, 'learning_rate': 5e-05, 'epoch': 14.24}
{'loss': 0.0279, 'grad_norm': 0.1397707010459397, 'learning_rate': 5e-05, 'epoch': 14.26}
{'loss': 0.027, 'grad_norm': 0.12597398977092245, 'learning_rate': 5e-05, 'epoch': 14.27}
{'loss': 0.0279, 'grad_norm': 0.08215171052849134, 'learning_rate': 5e-05, 'epoch': 14.28}
{'loss': 0.0274, 'grad_norm': 0.07007581558164606, 'learning_rate': 5e-05, 'epoch': 14.3}
{'loss': 0.0275, 'grad_norm': 0.15503335782236596, 'learning_rate': 5e-05, 'epoch': 14.31}
{'loss': 0.0277, 'grad_norm': 0.2021042042864492, 'learning_rate': 5e-05, 'epoch': 14.32}
{'loss': 0.0271, 'grad_norm': 0.08871170737345271, 'learning_rate': 5e-05, 'epoch': 14.34}
{'loss': 0.0268, 'grad_norm': 0.09441705162389182, 'learning_rate': 5e-05, 'epoch': 14.35}
{'loss': 0.027, 'grad_norm': 0.123852089539503, 'learning_rate': 5e-05, 'epoch': 14.36}
{'loss': 0.0278, 'grad_norm': 0.06586918615250538, 'learning_rate': 5e-05, 'epoch': 14.38}
{'loss': 0.0275, 'grad_norm': 0.2250676828151526, 'learning_rate': 5e-05, 'epoch': 14.39}
{'loss': 0.0271, 'grad_norm': 0.08937925011859728, 'learning_rate': 5e-05, 'epoch': 14.4}
{'loss': 0.027, 'grad_norm': 0.07446163676722733, 'learning_rate': 5e-05, 'epoch': 14.42}
{'loss': 0.0267, 'grad_norm': 0.12902707881564796, 'learning_rate': 5e-05, 'epoch': 14.43}
{'loss': 0.0272, 'grad_norm': 0.10479838971194654, 'learning_rate': 5e-05, 'epoch': 14.44}
{'loss': 0.0271, 'grad_norm': 0.17572043744490828, 'learning_rate': 5e-05, 'epoch': 14.46}
{'loss': 0.0274, 'grad_norm': 0.1207804780765161, 'learning_rate': 5e-05, 'epoch': 14.47}
{'loss': 0.0277, 'grad_norm': 0.16123951933312178, 'learning_rate': 5e-05, 'epoch': 14.48}
{'loss': 0.0274, 'grad_norm': 0.0816340651454827, 'learning_rate': 5e-05, 'epoch': 14.5}
{'loss': 0.0278, 'grad_norm': 0.060931667329953726, 'learning_rate': 5e-05, 'epoch': 14.51}
{'loss': 0.0276, 'grad_norm': 0.08054789128111019, 'learning_rate': 5e-05, 'epoch': 14.52}
{'loss': 0.0276, 'grad_norm': 0.08515123726588623, 'learning_rate': 5e-05, 'epoch': 14.54}
{'loss': 0.0282, 'grad_norm': 0.19931117886870695, 'learning_rate': 5e-05, 'epoch': 14.55}
{'loss': 0.0281, 'grad_norm': 0.059870580691801574, 'learning_rate': 5e-05, 'epoch': 14.56}
{'loss': 0.0276, 'grad_norm': 0.147316508267753, 'learning_rate': 5e-05, 'epoch': 14.58}
{'loss': 0.0273, 'grad_norm': 0.12210720649131201, 'learning_rate': 5e-05, 'epoch': 14.59}
{'loss': 0.0271, 'grad_norm': 0.11569754815039357, 'learning_rate': 5e-05, 'epoch': 14.61}
{'loss': 0.0281, 'grad_norm': 0.08991330502003979, 'learning_rate': 5e-05, 'epoch': 14.62}
{'loss': 0.0275, 'grad_norm': 0.1062588546022526, 'learning_rate': 5e-05, 'epoch': 14.63}
{'loss': 0.0271, 'grad_norm': 0.0969773248199836, 'learning_rate': 5e-05, 'epoch': 14.65}
{'loss': 0.0275, 'grad_norm': 0.09557398529997113, 'learning_rate': 5e-05, 'epoch': 14.66}
{'loss': 0.0278, 'grad_norm': 0.06202605975270892, 'learning_rate': 5e-05, 'epoch': 14.67}
{'loss': 0.0281, 'grad_norm': 0.056972180682640663, 'learning_rate': 5e-05, 'epoch': 14.69}
{'loss': 0.0276, 'grad_norm': 0.0825098810817052, 'learning_rate': 5e-05, 'epoch': 14.7}
{'loss': 0.0268, 'grad_norm': 0.09067541274091706, 'learning_rate': 5e-05, 'epoch': 14.71}
{'loss': 0.0276, 'grad_norm': 0.1335957515856614, 'learning_rate': 5e-05, 'epoch': 14.73}
{'loss': 0.0266, 'grad_norm': 0.19033285760284213, 'learning_rate': 5e-05, 'epoch': 14.74}
{'loss': 0.0274, 'grad_norm': 0.07045641714007043, 'learning_rate': 5e-05, 'epoch': 14.75}
{'loss': 0.0279, 'grad_norm': 0.1306930025265863, 'learning_rate': 5e-05, 'epoch': 14.77}
{'loss': 0.0268, 'grad_norm': 0.062247631052817574, 'learning_rate': 5e-05, 'epoch': 14.78}
{'loss': 0.0265, 'grad_norm': 0.09049376365937628, 'learning_rate': 5e-05, 'epoch': 14.79}
{'loss': 0.0273, 'grad_norm': 0.09543276570649364, 'learning_rate': 5e-05, 'epoch': 14.81}
{'loss': 0.0274, 'grad_norm': 0.16516382253279455, 'learning_rate': 5e-05, 'epoch': 14.82}
{'loss': 0.0271, 'grad_norm': 0.07192952378893373, 'learning_rate': 5e-05, 'epoch': 14.83}
{'loss': 0.0278, 'grad_norm': 0.1968020288777635, 'learning_rate': 5e-05, 'epoch': 14.85}
{'loss': 0.0278, 'grad_norm': 0.07544569650141283, 'learning_rate': 5e-05, 'epoch': 14.86}
{'loss': 0.0269, 'grad_norm': 0.11429155291710308, 'learning_rate': 5e-05, 'epoch': 14.87}
{'loss': 0.0271, 'grad_norm': 0.1362901782369823, 'learning_rate': 5e-05, 'epoch': 14.89}
{'loss': 0.026, 'grad_norm': 0.08765108792426951, 'learning_rate': 5e-05, 'epoch': 14.9}
{'loss': 0.0268, 'grad_norm': 0.08821905284985683, 'learning_rate': 5e-05, 'epoch': 14.91}
{'loss': 0.0276, 'grad_norm': 0.11849737054436561, 'learning_rate': 5e-05, 'epoch': 14.93}
{'loss': 0.027, 'grad_norm': 0.09697452055492223, 'learning_rate': 5e-05, 'epoch': 14.94}
{'loss': 0.0271, 'grad_norm': 0.0894003895895905, 'learning_rate': 5e-05, 'epoch': 14.95}
{'loss': 0.0275, 'grad_norm': 0.08807040477244663, 'learning_rate': 5e-05, 'epoch': 14.97}
{'loss': 0.0278, 'grad_norm': 0.15570198157235646, 'learning_rate': 5e-05, 'epoch': 14.98}
{'loss': 0.027, 'grad_norm': 0.0734243162982828, 'learning_rate': 5e-05, 'epoch': 14.99}
 62%|███████████████████████████████████████████████████████████████████████▉                                           | 11205/17928 [5:21:04<1:59:22,  1.07s/it][INFO|gner_trainer.py:60] 2024-11-20 00:42:52,186 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 00:42:52,187 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 00:42:52,187 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3666.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3638.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3642.67it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3666.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3670.68it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3657.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3651.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4094.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4054.35it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4063.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4091.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4088.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4062.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4050.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.27it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4012.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1398.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1391.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1393.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1374.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1379.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1080.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1085.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1080.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 538.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.19it/s]
{'eval_mit-movie_precision': 0.5443962565624162, 'eval_mit-movie_recall': 0.4467128675781898, 'eval_mit-movie_f1': 0.4907407406912163, 'eval_mit-restaurant_precision': 0.5023771790807975, 'eval_mit-restaurant_recall': 0.3019047619047523, 'eval_mit-restaurant_f1': 0.37715645444446566, 'eval_crossner_ai_precision': 0.44409519533002045, 'eval_crossner_ai_recall': 0.6154324828873294, 'eval_crossner_ai_f1': 0.5159102764249374, 'eval_crossner_literature_precision': 0.47889750215329546, 'eval_crossner_literature_recall': 0.5610494450050171, 'eval_crossner_literature_f1': 0.516728624485604, 'eval_crossner_music_precision': 0.6302888824044169, 'eval_crossner_music_recall': 0.6914212548015144, 'eval_crossner_music_f1': 0.659441306620824, 'eval_crossner_politics_precision': 0.5375773651635601, 'eval_crossner_politics_recall': 0.6235897435897276, 'eval_crossner_politics_f1': 0.5773979106815047, 'eval_crossner_science_precision': 0.5428230378991183, 'eval_crossner_science_recall': 0.7189723320157818, 'eval_crossner_science_f1': 0.6186022784750138, 'eval_wiki_passage_from_zero_precision': 0.8425846505738658, 'eval_wiki_passage_from_zero_recall': 0.8268136272545074, 'eval_wiki_passage_from_zero_f1': 0.8346246434068028, 'eval_average_f1': 0.5738252794037961, 'eval_runtime': 508.5569, 'eval_samples_per_second': 26.902, 'eval_steps_per_second': 0.106, 'epoch': 15.0}
 62%|███████████████████████████████████████████████████████████████████████▉                                           | 11205/17928 [5:29:33<1:59:22,  1.07s/it]
[INFO|trainer.py:3812] 2024-11-20 00:51:21,702 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-11205
[INFO|configuration_utils.py:414] 2024-11-20 00:51:21,704 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-11205/config.json
[INFO|configuration_utils.py:865] 2024-11-20 00:51:21,704 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-11205/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 00:51:22,540 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-11205/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 00:51:22,542 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-11205/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 00:51:22,542 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-11205/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 00:51:22,543 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-11205/spiece.model
[2024-11-20 00:51:22,565] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step11205 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 00:51:22,574] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/mp_rank_00_model_states.pt
[2024-11-20 00:51:22,574] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/mp_rank_00_model_states.pt...
[2024-11-20 00:51:23,398] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/mp_rank_00_model_states.pt.
[2024-11-20 00:51:23,399] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 00:51:24,225] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 00:51:24,225] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-11205/global_step11205/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 00:51:24,225] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step11205 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0276, 'grad_norm': 0.10744910328583185, 'learning_rate': 5e-05, 'epoch': 15.01}
{'loss': 0.0272, 'grad_norm': 0.07344628824243823, 'learning_rate': 5e-05, 'epoch': 15.02}
{'loss': 0.0271, 'grad_norm': 0.19309473712617584, 'learning_rate': 5e-05, 'epoch': 15.03}
{'loss': 0.0264, 'grad_norm': 0.06972123267268703, 'learning_rate': 5e-05, 'epoch': 15.05}
{'loss': 0.0274, 'grad_norm': 0.06033903643172416, 'learning_rate': 5e-05, 'epoch': 15.06}
{'loss': 0.0266, 'grad_norm': 0.16359223223895755, 'learning_rate': 5e-05, 'epoch': 15.07}
{'loss': 0.0271, 'grad_norm': 0.08807159971116939, 'learning_rate': 5e-05, 'epoch': 15.09}
{'loss': 0.0271, 'grad_norm': 0.09013188329520062, 'learning_rate': 5e-05, 'epoch': 15.1}
{'loss': 0.0278, 'grad_norm': 0.09688005491881375, 'learning_rate': 5e-05, 'epoch': 15.11}
{'loss': 0.0265, 'grad_norm': 0.06863171618915291, 'learning_rate': 5e-05, 'epoch': 15.13}
{'loss': 0.0281, 'grad_norm': 0.1037524007539584, 'learning_rate': 5e-05, 'epoch': 15.14}
{'loss': 0.0266, 'grad_norm': 0.0870048953762133, 'learning_rate': 5e-05, 'epoch': 15.15}
{'loss': 0.0268, 'grad_norm': 0.18302593283984145, 'learning_rate': 5e-05, 'epoch': 15.17}
{'loss': 0.0265, 'grad_norm': 0.0649822938168017, 'learning_rate': 5e-05, 'epoch': 15.18}
{'loss': 0.0274, 'grad_norm': 0.09832080743943206, 'learning_rate': 5e-05, 'epoch': 15.19}
{'loss': 0.0269, 'grad_norm': 0.08907294818594484, 'learning_rate': 5e-05, 'epoch': 15.21}
{'loss': 0.0266, 'grad_norm': 0.10798058865173481, 'learning_rate': 5e-05, 'epoch': 15.22}
{'loss': 0.027, 'grad_norm': 0.0974508987485623, 'learning_rate': 5e-05, 'epoch': 15.23}
{'loss': 0.028, 'grad_norm': 0.07031522851524229, 'learning_rate': 5e-05, 'epoch': 15.25}
{'loss': 0.0271, 'grad_norm': 0.08748158799750225, 'learning_rate': 5e-05, 'epoch': 15.26}
{'loss': 0.0273, 'grad_norm': 0.11676957391850347, 'learning_rate': 5e-05, 'epoch': 15.27}
{'loss': 0.0269, 'grad_norm': 0.06694517863533239, 'learning_rate': 5e-05, 'epoch': 15.29}
{'loss': 0.0275, 'grad_norm': 0.09304804565788667, 'learning_rate': 5e-05, 'epoch': 15.3}
{'loss': 0.0262, 'grad_norm': 0.10867627939147302, 'learning_rate': 5e-05, 'epoch': 15.31}
{'loss': 0.0273, 'grad_norm': 0.11280743807507776, 'learning_rate': 5e-05, 'epoch': 15.33}
{'loss': 0.0278, 'grad_norm': 0.0718642279856035, 'learning_rate': 5e-05, 'epoch': 15.34}
{'loss': 0.0271, 'grad_norm': 0.11225598979476116, 'learning_rate': 5e-05, 'epoch': 15.35}
{'loss': 0.0274, 'grad_norm': 0.1635140607297011, 'learning_rate': 5e-05, 'epoch': 15.37}
{'loss': 0.0269, 'grad_norm': 0.13839750952305901, 'learning_rate': 5e-05, 'epoch': 15.38}
{'loss': 0.0276, 'grad_norm': 0.07526722788375978, 'learning_rate': 5e-05, 'epoch': 15.39}
{'loss': 0.0268, 'grad_norm': 0.0959664391149667, 'learning_rate': 5e-05, 'epoch': 15.41}
{'loss': 0.0269, 'grad_norm': 0.15102113112798607, 'learning_rate': 5e-05, 'epoch': 15.42}
{'loss': 0.0276, 'grad_norm': 0.11648270541196426, 'learning_rate': 5e-05, 'epoch': 15.44}
{'loss': 0.0265, 'grad_norm': 0.1313005526008439, 'learning_rate': 5e-05, 'epoch': 15.45}
{'loss': 0.0268, 'grad_norm': 0.18078327885035778, 'learning_rate': 5e-05, 'epoch': 15.46}
{'loss': 0.0273, 'grad_norm': 0.0649101138909376, 'learning_rate': 5e-05, 'epoch': 15.48}
{'loss': 0.0278, 'grad_norm': 0.08834837022428699, 'learning_rate': 5e-05, 'epoch': 15.49}
{'loss': 0.0271, 'grad_norm': 0.06780380233897162, 'learning_rate': 5e-05, 'epoch': 15.5}
{'loss': 0.0265, 'grad_norm': 0.12399187963088283, 'learning_rate': 5e-05, 'epoch': 15.52}
{'loss': 0.0267, 'grad_norm': 0.10144193994749745, 'learning_rate': 5e-05, 'epoch': 15.53}
{'loss': 0.0268, 'grad_norm': 0.075654827311547, 'learning_rate': 5e-05, 'epoch': 15.54}
{'loss': 0.0271, 'grad_norm': 0.14072836944397563, 'learning_rate': 5e-05, 'epoch': 15.56}
{'loss': 0.027, 'grad_norm': 0.09803093556483498, 'learning_rate': 5e-05, 'epoch': 15.57}
{'loss': 0.0273, 'grad_norm': 0.10675031379524047, 'learning_rate': 5e-05, 'epoch': 15.58}
{'loss': 0.0275, 'grad_norm': 0.10418126828453649, 'learning_rate': 5e-05, 'epoch': 15.6}
{'loss': 0.027, 'grad_norm': 0.09990425033465336, 'learning_rate': 5e-05, 'epoch': 15.61}
{'loss': 0.0269, 'grad_norm': 0.07882626038870585, 'learning_rate': 5e-05, 'epoch': 15.62}
{'loss': 0.0275, 'grad_norm': 0.06742714031983098, 'learning_rate': 5e-05, 'epoch': 15.64}
{'loss': 0.0269, 'grad_norm': 0.15607302298987027, 'learning_rate': 5e-05, 'epoch': 15.65}
{'loss': 0.0265, 'grad_norm': 0.0827130328749198, 'learning_rate': 5e-05, 'epoch': 15.66}
{'loss': 0.0268, 'grad_norm': 0.1023400009356748, 'learning_rate': 5e-05, 'epoch': 15.68}
{'loss': 0.0271, 'grad_norm': 0.0860068247517748, 'learning_rate': 5e-05, 'epoch': 15.69}
{'loss': 0.0271, 'grad_norm': 0.07029236399227991, 'learning_rate': 5e-05, 'epoch': 15.7}
{'loss': 0.027, 'grad_norm': 0.07259162302530361, 'learning_rate': 5e-05, 'epoch': 15.72}
{'loss': 0.0269, 'grad_norm': 0.08757920990628383, 'learning_rate': 5e-05, 'epoch': 15.73}
{'loss': 0.0267, 'grad_norm': 0.08414192447969414, 'learning_rate': 5e-05, 'epoch': 15.74}
{'loss': 0.0272, 'grad_norm': 0.06767693886035187, 'learning_rate': 5e-05, 'epoch': 15.76}
{'loss': 0.0265, 'grad_norm': 0.07105929763438612, 'learning_rate': 5e-05, 'epoch': 15.77}
{'loss': 0.0269, 'grad_norm': 0.09537713329559158, 'learning_rate': 5e-05, 'epoch': 15.78}
{'loss': 0.0266, 'grad_norm': 0.059907982162547155, 'learning_rate': 5e-05, 'epoch': 15.8}
{'loss': 0.0265, 'grad_norm': 0.10595213092072656, 'learning_rate': 5e-05, 'epoch': 15.81}
{'loss': 0.0274, 'grad_norm': 0.09177902230698229, 'learning_rate': 5e-05, 'epoch': 15.82}
{'loss': 0.0257, 'grad_norm': 0.1493142236982948, 'learning_rate': 5e-05, 'epoch': 15.84}
{'loss': 0.0266, 'grad_norm': 0.10476582785294455, 'learning_rate': 5e-05, 'epoch': 15.85}
{'loss': 0.0268, 'grad_norm': 0.09882260936679765, 'learning_rate': 5e-05, 'epoch': 15.86}
{'loss': 0.0268, 'grad_norm': 0.06054005661380924, 'learning_rate': 5e-05, 'epoch': 15.88}
{'loss': 0.0268, 'grad_norm': 0.11477500875866008, 'learning_rate': 5e-05, 'epoch': 15.89}
{'loss': 0.0271, 'grad_norm': 0.07685979736430766, 'learning_rate': 5e-05, 'epoch': 15.9}
{'loss': 0.0262, 'grad_norm': 0.054970223334423286, 'learning_rate': 5e-05, 'epoch': 15.92}
{'loss': 0.0264, 'grad_norm': 0.08494245942095083, 'learning_rate': 5e-05, 'epoch': 15.93}
{'loss': 0.0266, 'grad_norm': 0.07816074566855047, 'learning_rate': 5e-05, 'epoch': 15.94}
{'loss': 0.0266, 'grad_norm': 0.07393976215403068, 'learning_rate': 5e-05, 'epoch': 15.96}
{'loss': 0.026, 'grad_norm': 0.10630278275527763, 'learning_rate': 5e-05, 'epoch': 15.97}
{'loss': 0.0277, 'grad_norm': 0.07137218293432111, 'learning_rate': 5e-05, 'epoch': 15.98}
{'loss': 0.027, 'grad_norm': 0.06935176198663584, 'learning_rate': 5e-05, 'epoch': 16.0}
 67%|████████████████████████████████████████████████████████████████████████████▋                                      | 11952/17928 [5:42:58<1:48:21,  1.09s/it][INFO|gner_trainer.py:60] 2024-11-20 01:04:46,456 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 01:04:46,456 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 01:04:46,456 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3662.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3682.66it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3684.57it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3654.44it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3631.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.38it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3634.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3621.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4085.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4100.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4107.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4091.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4051.48it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4083.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4044.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4061.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1401.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1364.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1401.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1398.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1369.24it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1383.24it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1104.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 965.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 985.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 984.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 966.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 963.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 964.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 936.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1104.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1100.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1076.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 546.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 534.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.94it/s]
{'eval_mit-movie_precision': 0.5628339140534132, 'eval_mit-movie_recall': 0.4538303053006096, 'eval_mit-movie_f1': 0.5024885938949858, 'eval_mit-restaurant_precision': 0.5341365461847083, 'eval_mit-restaurant_recall': 0.2955555555555462, 'eval_mit-restaurant_f1': 0.38054363371663663, 'eval_crossner_ai_precision': 0.45877475817593466, 'eval_crossner_ai_recall': 0.6197884256377959, 'eval_crossner_ai_f1': 0.5272631021215469, 'eval_crossner_literature_precision': 0.508944543828242, 'eval_crossner_literature_recall': 0.574167507568084, 'eval_crossner_literature_f1': 0.5395922237529058, 'eval_crossner_music_precision': 0.6503413475808653, 'eval_crossner_music_recall': 0.7013444302176471, 'eval_crossner_music_f1': 0.6748806406400242, 'eval_crossner_politics_precision': 0.5377738042020443, 'eval_crossner_politics_recall': 0.6169230769230611, 'eval_crossner_politics_f1': 0.5746357773564787, 'eval_crossner_science_precision': 0.5386259541984568, 'eval_crossner_science_recall': 0.6972332015810001, 'eval_crossner_science_f1': 0.6077519379352987, 'eval_wiki_passage_from_zero_precision': 0.8589071223143274, 'eval_wiki_passage_from_zero_recall': 0.8139478957915816, 'eval_wiki_passage_from_zero_f1': 0.8358233526273198, 'eval_average_f1': 0.5803724077556496, 'eval_runtime': 509.1102, 'eval_samples_per_second': 26.872, 'eval_steps_per_second': 0.106, 'epoch': 16.0}
 67%|████████████████████████████████████████████████████████████████████████████▋                                      | 11952/17928 [5:51:27<1:48:21,  1.09s/it]
[INFO|trainer.py:3812] 2024-11-20 01:13:16,656 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-11952
[INFO|configuration_utils.py:414] 2024-11-20 01:13:16,658 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-11952/config.json
[INFO|configuration_utils.py:865] 2024-11-20 01:13:16,658 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-11952/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 01:13:17,443 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-11952/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 01:13:17,445 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-11952/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 01:13:17,445 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-11952/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 01:13:17,445 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-11952/spiece.model
[2024-11-20 01:13:17,470] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step11952 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 01:13:17,483] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/mp_rank_00_model_states.pt
[2024-11-20 01:13:17,483] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/mp_rank_00_model_states.pt...
[2024-11-20 01:13:18,246] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/mp_rank_00_model_states.pt.
[2024-11-20 01:13:18,248] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 01:13:18,964] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 01:13:18,965] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-11952/global_step11952/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 01:13:18,965] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step11952 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0274, 'grad_norm': 0.07584757114902085, 'learning_rate': 5e-05, 'epoch': 16.01}
{'loss': 0.0265, 'grad_norm': 0.07770277607906757, 'learning_rate': 5e-05, 'epoch': 16.02}
{'loss': 0.0267, 'grad_norm': 0.06780531666654198, 'learning_rate': 5e-05, 'epoch': 16.04}
{'loss': 0.0264, 'grad_norm': 0.13001213948946472, 'learning_rate': 5e-05, 'epoch': 16.05}
{'loss': 0.0264, 'grad_norm': 0.07507532008327054, 'learning_rate': 5e-05, 'epoch': 16.06}
{'loss': 0.0278, 'grad_norm': 0.12640414751376733, 'learning_rate': 5e-05, 'epoch': 16.08}
{'loss': 0.0265, 'grad_norm': 0.09487765836478129, 'learning_rate': 5e-05, 'epoch': 16.09}
{'loss': 0.0269, 'grad_norm': 0.05240764996624064, 'learning_rate': 5e-05, 'epoch': 16.1}
{'loss': 0.0263, 'grad_norm': 0.07513071666867306, 'learning_rate': 5e-05, 'epoch': 16.12}
{'loss': 0.027, 'grad_norm': 0.06571967711930683, 'learning_rate': 5e-05, 'epoch': 16.13}
{'loss': 0.0274, 'grad_norm': 0.11790849697455116, 'learning_rate': 5e-05, 'epoch': 16.14}
{'loss': 0.0259, 'grad_norm': 0.06507114486881023, 'learning_rate': 5e-05, 'epoch': 16.16}
{'loss': 0.0261, 'grad_norm': 0.13422373308339478, 'learning_rate': 5e-05, 'epoch': 16.17}
{'loss': 0.0265, 'grad_norm': 0.1088668095130778, 'learning_rate': 5e-05, 'epoch': 16.18}
{'loss': 0.0255, 'grad_norm': 0.10697733189267072, 'learning_rate': 5e-05, 'epoch': 16.2}
{'loss': 0.0265, 'grad_norm': 0.17044373102272284, 'learning_rate': 5e-05, 'epoch': 16.21}
{'loss': 0.0261, 'grad_norm': 0.1096468510256465, 'learning_rate': 5e-05, 'epoch': 16.22}
{'loss': 0.0264, 'grad_norm': 0.08123034665941702, 'learning_rate': 5e-05, 'epoch': 16.24}
{'loss': 0.0273, 'grad_norm': 0.08400895346792021, 'learning_rate': 5e-05, 'epoch': 16.25}
{'loss': 0.0262, 'grad_norm': 0.06814949650604712, 'learning_rate': 5e-05, 'epoch': 16.27}
{'loss': 0.0269, 'grad_norm': 0.06600024422235531, 'learning_rate': 5e-05, 'epoch': 16.28}
{'loss': 0.0254, 'grad_norm': 0.10895514369660719, 'learning_rate': 5e-05, 'epoch': 16.29}
{'loss': 0.0264, 'grad_norm': 0.05986139246277403, 'learning_rate': 5e-05, 'epoch': 16.31}
{'loss': 0.0268, 'grad_norm': 0.07457079339209553, 'learning_rate': 5e-05, 'epoch': 16.32}
{'loss': 0.0273, 'grad_norm': 0.07446021716211997, 'learning_rate': 5e-05, 'epoch': 16.33}
{'loss': 0.0273, 'grad_norm': 0.08752389798617409, 'learning_rate': 5e-05, 'epoch': 16.35}
{'loss': 0.0268, 'grad_norm': 0.18206643881827475, 'learning_rate': 5e-05, 'epoch': 16.36}
{'loss': 0.026, 'grad_norm': 0.0689251342023149, 'learning_rate': 5e-05, 'epoch': 16.37}
{'loss': 0.0273, 'grad_norm': 0.11726402327366818, 'learning_rate': 5e-05, 'epoch': 16.39}
{'loss': 0.0261, 'grad_norm': 0.054498563243089077, 'learning_rate': 5e-05, 'epoch': 16.4}
{'loss': 0.0263, 'grad_norm': 0.12579346443483497, 'learning_rate': 5e-05, 'epoch': 16.41}
{'loss': 0.0266, 'grad_norm': 0.08616391883168499, 'learning_rate': 5e-05, 'epoch': 16.43}
{'loss': 0.0277, 'grad_norm': 0.12636080995530072, 'learning_rate': 5e-05, 'epoch': 16.44}
{'loss': 0.0268, 'grad_norm': 0.11942017698996134, 'learning_rate': 5e-05, 'epoch': 16.45}
{'loss': 0.0272, 'grad_norm': 0.08232619983466008, 'learning_rate': 5e-05, 'epoch': 16.47}
{'loss': 0.0266, 'grad_norm': 0.09138940611130986, 'learning_rate': 5e-05, 'epoch': 16.48}
{'loss': 0.0266, 'grad_norm': 0.07686528624245821, 'learning_rate': 5e-05, 'epoch': 16.49}
{'loss': 0.0256, 'grad_norm': 0.08515072594670305, 'learning_rate': 5e-05, 'epoch': 16.51}
{'loss': 0.0265, 'grad_norm': 0.12423329358163372, 'learning_rate': 5e-05, 'epoch': 16.52}
{'loss': 0.0259, 'grad_norm': 0.17259463919825466, 'learning_rate': 5e-05, 'epoch': 16.53}
{'loss': 0.0265, 'grad_norm': 0.06858742005852973, 'learning_rate': 5e-05, 'epoch': 16.55}
{'loss': 0.0269, 'grad_norm': 0.08558200872432199, 'learning_rate': 5e-05, 'epoch': 16.56}
{'loss': 0.0259, 'grad_norm': 0.09700045211277385, 'learning_rate': 5e-05, 'epoch': 16.57}
{'loss': 0.0265, 'grad_norm': 0.08550331310826496, 'learning_rate': 5e-05, 'epoch': 16.59}
{'loss': 0.0265, 'grad_norm': 0.07462007473322377, 'learning_rate': 5e-05, 'epoch': 16.6}
{'loss': 0.0266, 'grad_norm': 0.08292056715878958, 'learning_rate': 5e-05, 'epoch': 16.61}
{'loss': 0.0263, 'grad_norm': 0.07699527203512964, 'learning_rate': 5e-05, 'epoch': 16.63}
{'loss': 0.027, 'grad_norm': 0.11389176919644725, 'learning_rate': 5e-05, 'epoch': 16.64}
{'loss': 0.0257, 'grad_norm': 0.09680168565552609, 'learning_rate': 5e-05, 'epoch': 16.65}
{'loss': 0.0261, 'grad_norm': 0.0999059469518519, 'learning_rate': 5e-05, 'epoch': 16.67}
{'loss': 0.0263, 'grad_norm': 0.09053699334986526, 'learning_rate': 5e-05, 'epoch': 16.68}
{'loss': 0.0256, 'grad_norm': 0.08029833034095443, 'learning_rate': 5e-05, 'epoch': 16.69}
{'loss': 0.0265, 'grad_norm': 0.15431156571384677, 'learning_rate': 5e-05, 'epoch': 16.71}
{'loss': 0.0265, 'grad_norm': 0.09276081802471248, 'learning_rate': 5e-05, 'epoch': 16.72}
{'loss': 0.0266, 'grad_norm': 0.07430651143955568, 'learning_rate': 5e-05, 'epoch': 16.73}
{'loss': 0.0271, 'grad_norm': 0.07985224208816918, 'learning_rate': 5e-05, 'epoch': 16.75}
{'loss': 0.0268, 'grad_norm': 0.10340424609613084, 'learning_rate': 5e-05, 'epoch': 16.76}
{'loss': 0.0269, 'grad_norm': 0.0898214343593932, 'learning_rate': 5e-05, 'epoch': 16.77}
{'loss': 0.0263, 'grad_norm': 0.05318122528579726, 'learning_rate': 5e-05, 'epoch': 16.79}
{'loss': 0.0265, 'grad_norm': 0.08592002593463384, 'learning_rate': 5e-05, 'epoch': 16.8}
{'loss': 0.0266, 'grad_norm': 0.10492793698384753, 'learning_rate': 5e-05, 'epoch': 16.81}
{'loss': 0.0268, 'grad_norm': 0.11508748018420593, 'learning_rate': 5e-05, 'epoch': 16.83}
{'loss': 0.0269, 'grad_norm': 0.09830139681424219, 'learning_rate': 5e-05, 'epoch': 16.84}
{'loss': 0.0265, 'grad_norm': 0.05405391297265851, 'learning_rate': 5e-05, 'epoch': 16.85}
{'loss': 0.0268, 'grad_norm': 0.07419175359732713, 'learning_rate': 5e-05, 'epoch': 16.87}
{'loss': 0.0261, 'grad_norm': 0.09803154833179446, 'learning_rate': 5e-05, 'epoch': 16.88}
{'loss': 0.0265, 'grad_norm': 0.1226125689496809, 'learning_rate': 5e-05, 'epoch': 16.89}
{'loss': 0.0267, 'grad_norm': 0.08158279919508328, 'learning_rate': 5e-05, 'epoch': 16.91}
{'loss': 0.0268, 'grad_norm': 0.08196326401724428, 'learning_rate': 5e-05, 'epoch': 16.92}
{'loss': 0.0263, 'grad_norm': 0.06147086455533915, 'learning_rate': 5e-05, 'epoch': 16.93}
{'loss': 0.0269, 'grad_norm': 0.14815134775853522, 'learning_rate': 5e-05, 'epoch': 16.95}
{'loss': 0.0264, 'grad_norm': 0.06915608774653972, 'learning_rate': 5e-05, 'epoch': 16.96}
{'loss': 0.0257, 'grad_norm': 0.06410574500126852, 'learning_rate': 5e-05, 'epoch': 16.97}
{'loss': 0.0265, 'grad_norm': 0.05769267229200353, 'learning_rate': 5e-05, 'epoch': 16.99}
 71%|█████████████████████████████████████████████████████████████████████████████████▍                                 | 12699/17928 [6:04:52<1:37:10,  1.12s/it][INFO|gner_trainer.py:60] 2024-11-20 01:26:40,623 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 01:26:40,623 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 01:26:40,623 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3672.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.55it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3684.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3617.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3652.60it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3647.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3615.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4110.70it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3604.40it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4066.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4110.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1412.45it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4023.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4041.25it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4093.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4029.26it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4041.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1380.42it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1374.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1102.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.77it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1080.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1084.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 966.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 967.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 942.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 949.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.46it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.53it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1078.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.77it/s]
{'eval_mit-movie_precision': 0.5414414414414292, 'eval_mit-movie_recall': 0.4502715864393997, 'eval_mit-movie_f1': 0.49166581445087265, 'eval_mit-restaurant_precision': 0.4945624029000262, 'eval_mit-restaurant_recall': 0.30317460317459355, 'eval_mit-restaurant_f1': 0.37591025383989324, 'eval_crossner_ai_precision': 0.44710669077755666, 'eval_crossner_ai_recall': 0.6154324828873294, 'eval_crossner_ai_f1': 0.5179366325775697, 'eval_crossner_literature_precision': 0.4911523521795213, 'eval_crossner_literature_recall': 0.574167507568084, 'eval_crossner_literature_f1': 0.529425447728832, 'eval_crossner_music_precision': 0.6409210142815319, 'eval_crossner_music_recall': 0.703905249679875, 'eval_crossner_music_f1': 0.6709382150530641, 'eval_crossner_politics_precision': 0.5386813186813069, 'eval_crossner_politics_recall': 0.6284615384615223, 'eval_crossner_politics_f1': 0.5801183431455483, 'eval_crossner_science_precision': 0.5308056872037757, 'eval_crossner_science_recall': 0.708300395256889, 'eval_crossner_science_f1': 0.6068405011362408, 'eval_wiki_passage_from_zero_precision': 0.8477496556119809, 'eval_wiki_passage_from_zero_recall': 0.826292585170339, 'eval_wiki_passage_from_zero_f1': 0.8368836071229465, 'eval_average_f1': 0.5762148518818709, 'eval_runtime': 506.4181, 'eval_samples_per_second': 27.015, 'eval_steps_per_second': 0.107, 'epoch': 17.0}
 71%|█████████████████████████████████████████████████████████████████████████████████▍                                 | 12699/17928 [6:13:19<1:37:10,  1.12s/it]
[INFO|trainer.py:3812] 2024-11-20 01:35:08,022 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-12699
[INFO|configuration_utils.py:414] 2024-11-20 01:35:08,024 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-12699/config.json
[INFO|configuration_utils.py:865] 2024-11-20 01:35:08,025 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-12699/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 01:35:08,937 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-12699/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 01:35:08,939 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-12699/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 01:35:08,939 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-12699/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 01:35:08,940 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-12699/spiece.model
[2024-11-20 01:35:08,964] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step12699 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 01:35:08,970] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/mp_rank_00_model_states.pt
[2024-11-20 01:35:08,970] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/mp_rank_00_model_states.pt...
[2024-11-20 01:35:09,847] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/mp_rank_00_model_states.pt.
[2024-11-20 01:35:09,849] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 01:35:10,658] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 01:35:10,658] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-12699/global_step12699/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 01:35:10,659] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step12699 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0268, 'grad_norm': 0.05363183482210443, 'learning_rate': 5e-05, 'epoch': 17.0}
{'loss': 0.0265, 'grad_norm': 0.08594574401066801, 'learning_rate': 5e-05, 'epoch': 17.01}
{'loss': 0.0262, 'grad_norm': 0.11920957055630943, 'learning_rate': 5e-05, 'epoch': 17.03}
{'loss': 0.0259, 'grad_norm': 0.10890688944564555, 'learning_rate': 5e-05, 'epoch': 17.04}
{'loss': 0.0269, 'grad_norm': 0.11928970749438517, 'learning_rate': 5e-05, 'epoch': 17.05}
{'loss': 0.026, 'grad_norm': 0.0928406572256925, 'learning_rate': 5e-05, 'epoch': 17.07}
{'loss': 0.0267, 'grad_norm': 0.07045774227430099, 'learning_rate': 5e-05, 'epoch': 17.08}
{'loss': 0.0265, 'grad_norm': 0.10229602804018338, 'learning_rate': 5e-05, 'epoch': 17.1}
{'loss': 0.0259, 'grad_norm': 0.14116564772297083, 'learning_rate': 5e-05, 'epoch': 17.11}
{'loss': 0.0258, 'grad_norm': 0.1713205954431809, 'learning_rate': 5e-05, 'epoch': 17.12}
{'loss': 0.0264, 'grad_norm': 0.07953457288133277, 'learning_rate': 5e-05, 'epoch': 17.14}
{'loss': 0.0262, 'grad_norm': 0.08825842933746512, 'learning_rate': 5e-05, 'epoch': 17.15}
{'loss': 0.0262, 'grad_norm': 0.08728888675897685, 'learning_rate': 5e-05, 'epoch': 17.16}
{'loss': 0.0263, 'grad_norm': 0.06090641176281542, 'learning_rate': 5e-05, 'epoch': 17.18}
{'loss': 0.0257, 'grad_norm': 0.20760804925080278, 'learning_rate': 5e-05, 'epoch': 17.19}
{'loss': 0.0255, 'grad_norm': 0.19445845800851744, 'learning_rate': 5e-05, 'epoch': 17.2}
{'loss': 0.0266, 'grad_norm': 0.0868043689514226, 'learning_rate': 5e-05, 'epoch': 17.22}
{'loss': 0.0266, 'grad_norm': 0.07207902129467966, 'learning_rate': 5e-05, 'epoch': 17.23}
{'loss': 0.0265, 'grad_norm': 0.08307012294936728, 'learning_rate': 5e-05, 'epoch': 17.24}
{'loss': 0.0259, 'grad_norm': 0.07471072430925788, 'learning_rate': 5e-05, 'epoch': 17.26}
{'loss': 0.0259, 'grad_norm': 0.12360655187816938, 'learning_rate': 5e-05, 'epoch': 17.27}
{'loss': 0.0265, 'grad_norm': 0.09294569687364242, 'learning_rate': 5e-05, 'epoch': 17.28}
{'loss': 0.0263, 'grad_norm': 0.061676619959574394, 'learning_rate': 5e-05, 'epoch': 17.3}
{'loss': 0.0261, 'grad_norm': 0.1075396109323481, 'learning_rate': 5e-05, 'epoch': 17.31}
{'loss': 0.0256, 'grad_norm': 0.09195747429212846, 'learning_rate': 5e-05, 'epoch': 17.32}
{'loss': 0.0268, 'grad_norm': 0.06932687364355515, 'learning_rate': 5e-05, 'epoch': 17.34}
{'loss': 0.0259, 'grad_norm': 0.18286228561659992, 'learning_rate': 5e-05, 'epoch': 17.35}
{'loss': 0.0277, 'grad_norm': 0.060184718492592264, 'learning_rate': 5e-05, 'epoch': 17.36}
{'loss': 0.0262, 'grad_norm': 0.13021303088933284, 'learning_rate': 5e-05, 'epoch': 17.38}
{'loss': 0.0263, 'grad_norm': 0.10390513838983659, 'learning_rate': 5e-05, 'epoch': 17.39}
{'loss': 0.0259, 'grad_norm': 0.052087813671446714, 'learning_rate': 5e-05, 'epoch': 17.4}
{'loss': 0.0261, 'grad_norm': 0.09244637308936444, 'learning_rate': 5e-05, 'epoch': 17.42}
{'loss': 0.0264, 'grad_norm': 0.052364531526646795, 'learning_rate': 5e-05, 'epoch': 17.43}
{'loss': 0.0259, 'grad_norm': 0.09732000159999199, 'learning_rate': 5e-05, 'epoch': 17.44}
{'loss': 0.0259, 'grad_norm': 0.09229273991986889, 'learning_rate': 5e-05, 'epoch': 17.46}
{'loss': 0.0259, 'grad_norm': 0.23217811945453082, 'learning_rate': 5e-05, 'epoch': 17.47}
{'loss': 0.0262, 'grad_norm': 0.07296816427926966, 'learning_rate': 5e-05, 'epoch': 17.48}
{'loss': 0.0268, 'grad_norm': 0.12483029841523163, 'learning_rate': 5e-05, 'epoch': 17.5}
{'loss': 0.0256, 'grad_norm': 0.06800519949720704, 'learning_rate': 5e-05, 'epoch': 17.51}
{'loss': 0.0253, 'grad_norm': 0.10524044227526466, 'learning_rate': 5e-05, 'epoch': 17.52}
{'loss': 0.0263, 'grad_norm': 0.08807911264915752, 'learning_rate': 5e-05, 'epoch': 17.54}
{'loss': 0.027, 'grad_norm': 0.0997391724598774, 'learning_rate': 5e-05, 'epoch': 17.55}
{'loss': 0.0255, 'grad_norm': 0.10853292095991536, 'learning_rate': 5e-05, 'epoch': 17.56}
{'loss': 0.0269, 'grad_norm': 0.08511811001624797, 'learning_rate': 5e-05, 'epoch': 17.58}
{'loss': 0.0261, 'grad_norm': 0.09916983660305007, 'learning_rate': 5e-05, 'epoch': 17.59}
{'loss': 0.026, 'grad_norm': 0.06736383309031829, 'learning_rate': 5e-05, 'epoch': 17.6}
{'loss': 0.0263, 'grad_norm': 0.07498018032693203, 'learning_rate': 5e-05, 'epoch': 17.62}
{'loss': 0.0263, 'grad_norm': 0.06943850922387612, 'learning_rate': 5e-05, 'epoch': 17.63}
{'loss': 0.0274, 'grad_norm': 0.14756355756972825, 'learning_rate': 5e-05, 'epoch': 17.64}
{'loss': 0.0262, 'grad_norm': 0.0669814158140367, 'learning_rate': 5e-05, 'epoch': 17.66}
{'loss': 0.0266, 'grad_norm': 0.06989040105930085, 'learning_rate': 5e-05, 'epoch': 17.67}
{'loss': 0.0261, 'grad_norm': 0.07400594494554372, 'learning_rate': 5e-05, 'epoch': 17.68}
{'loss': 0.0262, 'grad_norm': 0.0683046973766314, 'learning_rate': 5e-05, 'epoch': 17.7}
{'loss': 0.0252, 'grad_norm': 0.09020014749506196, 'learning_rate': 5e-05, 'epoch': 17.71}
{'loss': 0.0267, 'grad_norm': 0.07825344672682488, 'learning_rate': 5e-05, 'epoch': 17.72}
{'loss': 0.0264, 'grad_norm': 0.09408598536948126, 'learning_rate': 5e-05, 'epoch': 17.74}
{'loss': 0.0274, 'grad_norm': 0.18308617045113224, 'learning_rate': 5e-05, 'epoch': 17.75}
{'loss': 0.026, 'grad_norm': 0.09273728117852079, 'learning_rate': 5e-05, 'epoch': 17.76}
{'loss': 0.0263, 'grad_norm': 0.1067393729528386, 'learning_rate': 5e-05, 'epoch': 17.78}
{'loss': 0.0259, 'grad_norm': 0.07421763946304674, 'learning_rate': 5e-05, 'epoch': 17.79}
{'loss': 0.0258, 'grad_norm': 0.10949698100516973, 'learning_rate': 5e-05, 'epoch': 17.8}
{'loss': 0.0264, 'grad_norm': 0.11548564074352584, 'learning_rate': 5e-05, 'epoch': 17.82}
{'loss': 0.0254, 'grad_norm': 0.09514749541514352, 'learning_rate': 5e-05, 'epoch': 17.83}
{'loss': 0.0264, 'grad_norm': 0.0931926891243241, 'learning_rate': 5e-05, 'epoch': 17.84}
{'loss': 0.0262, 'grad_norm': 0.09985692920772568, 'learning_rate': 5e-05, 'epoch': 17.86}
{'loss': 0.0264, 'grad_norm': 0.04581464819844861, 'learning_rate': 5e-05, 'epoch': 17.87}
{'loss': 0.0258, 'grad_norm': 0.10603957323173234, 'learning_rate': 5e-05, 'epoch': 17.88}
{'loss': 0.0265, 'grad_norm': 0.0994371346191848, 'learning_rate': 5e-05, 'epoch': 17.9}
{'loss': 0.026, 'grad_norm': 0.07891072104789014, 'learning_rate': 5e-05, 'epoch': 17.91}
{'loss': 0.0261, 'grad_norm': 0.1352963776817746, 'learning_rate': 5e-05, 'epoch': 17.93}
{'loss': 0.0259, 'grad_norm': 0.07719318987168519, 'learning_rate': 5e-05, 'epoch': 17.94}
{'loss': 0.0262, 'grad_norm': 0.14027688861660595, 'learning_rate': 5e-05, 'epoch': 17.95}
{'loss': 0.0256, 'grad_norm': 0.08388836773549486, 'learning_rate': 5e-05, 'epoch': 17.97}
{'loss': 0.0262, 'grad_norm': 0.09485179449087142, 'learning_rate': 5e-05, 'epoch': 17.98}
{'loss': 0.0262, 'grad_norm': 0.08952701756657487, 'learning_rate': 5e-05, 'epoch': 17.99}
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 13446/17928 [6:26:48<1:17:59,  1.04s/it][INFO|gner_trainer.py:60] 2024-11-20 01:48:36,536 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 01:48:36,536 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 01:48:36,537 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3650.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3682.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3660.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3625.11it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3635.42it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3590.36it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4090.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3655.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4117.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3633.24it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4088.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4052.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4058.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1410.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 3994.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4092.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1366.22it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1353.22it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4052.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1356.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1365.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1112.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1385.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.98it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1101.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1094.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 528.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 538.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 523.94it/s]
{'eval_mit-movie_precision': 0.5444646098003506, 'eval_mit-movie_recall': 0.44952238246861864, 'eval_mit-movie_f1': 0.4924592181714371, 'eval_mit-restaurant_precision': 0.5307322287546483, 'eval_mit-restaurant_recall': 0.3152380952380852, 'eval_mit-restaurant_f1': 0.39553873725655464, 'eval_crossner_ai_precision': 0.4589861751151862, 'eval_crossner_ai_recall': 0.6197884256377959, 'eval_crossner_ai_f1': 0.5274027005070797, 'eval_crossner_literature_precision': 0.5101500441306042, 'eval_crossner_literature_recall': 0.5832492431886689, 'eval_crossner_literature_f1': 0.5442561204775049, 'eval_crossner_music_precision': 0.6499703615885996, 'eval_crossner_music_recall': 0.7019846350832042, 'eval_crossner_music_f1': 0.6749769159241991, 'eval_crossner_politics_precision': 0.538478500551256, 'eval_crossner_politics_recall': 0.6261538461538301, 'eval_crossner_politics_f1': 0.5790160046924154, 'eval_crossner_science_precision': 0.560337044838984, 'eval_crossner_science_recall': 0.7359683794466112, 'eval_crossner_science_f1': 0.6362549119618306, 'eval_wiki_passage_from_zero_precision': 0.8514152404153832, 'eval_wiki_passage_from_zero_recall': 0.8264529058116216, 'eval_wiki_passage_from_zero_f1': 0.8387483856034256, 'eval_average_f1': 0.5860816243243059, 'eval_runtime': 514.1711, 'eval_samples_per_second': 26.608, 'eval_steps_per_second': 0.105, 'epoch': 18.0}
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 13446/17928 [6:35:23<1:17:59,  1.04s/it]
[INFO|trainer.py:3812] 2024-11-20 01:57:11,616 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-13446
[INFO|configuration_utils.py:414] 2024-11-20 01:57:11,618 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-13446/config.json
[INFO|configuration_utils.py:865] 2024-11-20 01:57:11,618 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-13446/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 01:57:12,537 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-13446/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 01:57:12,539 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-13446/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 01:57:12,539 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-13446/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 01:57:12,540 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-13446/spiece.model
[2024-11-20 01:57:12,562] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step13446 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 01:57:12,568] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/mp_rank_00_model_states.pt
[2024-11-20 01:57:12,568] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/mp_rank_00_model_states.pt...
[2024-11-20 01:57:13,451] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/mp_rank_00_model_states.pt.
[2024-11-20 01:57:13,453] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 01:57:14,370] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 01:57:14,370] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-13446/global_step13446/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 01:57:14,370] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step13446 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0259, 'grad_norm': 0.07098833104633911, 'learning_rate': 5e-05, 'epoch': 18.01}
{'loss': 0.0263, 'grad_norm': 0.0703750702822048, 'learning_rate': 5e-05, 'epoch': 18.02}
{'loss': 0.0265, 'grad_norm': 0.07725952094433475, 'learning_rate': 5e-05, 'epoch': 18.03}
{'loss': 0.0255, 'grad_norm': 0.14402082887319637, 'learning_rate': 5e-05, 'epoch': 18.05}
{'loss': 0.0257, 'grad_norm': 0.0744813927348905, 'learning_rate': 5e-05, 'epoch': 18.06}
{'loss': 0.0259, 'grad_norm': 0.1746240193671242, 'learning_rate': 5e-05, 'epoch': 18.07}
{'loss': 0.0254, 'grad_norm': 0.12119762902648501, 'learning_rate': 5e-05, 'epoch': 18.09}
{'loss': 0.0255, 'grad_norm': 0.08578969697150536, 'learning_rate': 5e-05, 'epoch': 18.1}
{'loss': 0.026, 'grad_norm': 0.06786681923338755, 'learning_rate': 5e-05, 'epoch': 18.11}
{'loss': 0.0255, 'grad_norm': 0.13728582081652205, 'learning_rate': 5e-05, 'epoch': 18.13}
{'loss': 0.026, 'grad_norm': 0.12328831886892497, 'learning_rate': 5e-05, 'epoch': 18.14}
{'loss': 0.026, 'grad_norm': 0.06573389277543136, 'learning_rate': 5e-05, 'epoch': 18.15}
{'loss': 0.0268, 'grad_norm': 0.14392210205196054, 'learning_rate': 5e-05, 'epoch': 18.17}
{'loss': 0.0255, 'grad_norm': 0.10068634262550452, 'learning_rate': 5e-05, 'epoch': 18.18}
{'loss': 0.0254, 'grad_norm': 0.07213124139467741, 'learning_rate': 5e-05, 'epoch': 18.19}
{'loss': 0.0254, 'grad_norm': 0.1327855068713096, 'learning_rate': 5e-05, 'epoch': 18.21}
{'loss': 0.0262, 'grad_norm': 0.08594701183304593, 'learning_rate': 5e-05, 'epoch': 18.22}
{'loss': 0.0259, 'grad_norm': 0.15793924340967913, 'learning_rate': 5e-05, 'epoch': 18.23}
{'loss': 0.026, 'grad_norm': 0.10511546216106597, 'learning_rate': 5e-05, 'epoch': 18.25}
{'loss': 0.0256, 'grad_norm': 0.05931993145558432, 'learning_rate': 5e-05, 'epoch': 18.26}
{'loss': 0.0254, 'grad_norm': 0.08300338340611482, 'learning_rate': 5e-05, 'epoch': 18.27}
{'loss': 0.0261, 'grad_norm': 0.0512162431169759, 'learning_rate': 5e-05, 'epoch': 18.29}
{'loss': 0.0265, 'grad_norm': 0.09720219914937125, 'learning_rate': 5e-05, 'epoch': 18.3}
{'loss': 0.0256, 'grad_norm': 0.06621384445493177, 'learning_rate': 5e-05, 'epoch': 18.31}
{'loss': 0.0262, 'grad_norm': 0.07023563090571033, 'learning_rate': 5e-05, 'epoch': 18.33}
{'loss': 0.026, 'grad_norm': 0.07911057774068161, 'learning_rate': 5e-05, 'epoch': 18.34}
{'loss': 0.0253, 'grad_norm': 0.06673792795138556, 'learning_rate': 5e-05, 'epoch': 18.35}
{'loss': 0.0256, 'grad_norm': 0.15774087130133624, 'learning_rate': 5e-05, 'epoch': 18.37}
{'loss': 0.0256, 'grad_norm': 0.08124500646743553, 'learning_rate': 5e-05, 'epoch': 18.38}
{'loss': 0.0264, 'grad_norm': 0.07860713839964997, 'learning_rate': 5e-05, 'epoch': 18.39}
{'loss': 0.0255, 'grad_norm': 0.11576883384601877, 'learning_rate': 5e-05, 'epoch': 18.41}
{'loss': 0.0259, 'grad_norm': 0.06559899118442074, 'learning_rate': 5e-05, 'epoch': 18.42}
{'loss': 0.0262, 'grad_norm': 0.09705795597050029, 'learning_rate': 5e-05, 'epoch': 18.43}
{'loss': 0.0265, 'grad_norm': 0.061325741451255425, 'learning_rate': 5e-05, 'epoch': 18.45}
{'loss': 0.0252, 'grad_norm': 0.11098449359792403, 'learning_rate': 5e-05, 'epoch': 18.46}
{'loss': 0.0267, 'grad_norm': 0.09294704957351883, 'learning_rate': 5e-05, 'epoch': 18.47}
{'loss': 0.0262, 'grad_norm': 0.09590597453284455, 'learning_rate': 5e-05, 'epoch': 18.49}
{'loss': 0.0253, 'grad_norm': 0.13447481373903275, 'learning_rate': 5e-05, 'epoch': 18.5}
{'loss': 0.0265, 'grad_norm': 0.08534419553899525, 'learning_rate': 5e-05, 'epoch': 18.51}
{'loss': 0.0259, 'grad_norm': 0.07977827268903054, 'learning_rate': 5e-05, 'epoch': 18.53}
{'loss': 0.0259, 'grad_norm': 0.17074581960996582, 'learning_rate': 5e-05, 'epoch': 18.54}
{'loss': 0.0259, 'grad_norm': 0.08027805688658313, 'learning_rate': 5e-05, 'epoch': 18.55}
{'loss': 0.0253, 'grad_norm': 0.11347199281430734, 'learning_rate': 5e-05, 'epoch': 18.57}
{'loss': 0.0252, 'grad_norm': 0.06858335993071195, 'learning_rate': 5e-05, 'epoch': 18.58}
{'loss': 0.0261, 'grad_norm': 0.0807518818133343, 'learning_rate': 5e-05, 'epoch': 18.59}
{'loss': 0.0256, 'grad_norm': 0.08038319940350627, 'learning_rate': 5e-05, 'epoch': 18.61}
{'loss': 0.0259, 'grad_norm': 0.04663610428877333, 'learning_rate': 5e-05, 'epoch': 18.62}
{'loss': 0.0254, 'grad_norm': 0.15254338340158816, 'learning_rate': 5e-05, 'epoch': 18.63}
{'loss': 0.0256, 'grad_norm': 0.10907351290672494, 'learning_rate': 5e-05, 'epoch': 18.65}
{'loss': 0.0259, 'grad_norm': 0.09780339599324644, 'learning_rate': 5e-05, 'epoch': 18.66}
{'loss': 0.0259, 'grad_norm': 0.1047162701444889, 'learning_rate': 5e-05, 'epoch': 18.67}
{'loss': 0.026, 'grad_norm': 0.08130148290475166, 'learning_rate': 5e-05, 'epoch': 18.69}
{'loss': 0.0262, 'grad_norm': 0.07541582360913876, 'learning_rate': 5e-05, 'epoch': 18.7}
{'loss': 0.0262, 'grad_norm': 0.08428469733007957, 'learning_rate': 5e-05, 'epoch': 18.71}
{'loss': 0.0252, 'grad_norm': 0.09052018854367393, 'learning_rate': 5e-05, 'epoch': 18.73}
{'loss': 0.0258, 'grad_norm': 0.08174559265397288, 'learning_rate': 5e-05, 'epoch': 18.74}
{'loss': 0.0262, 'grad_norm': 0.06972480579375162, 'learning_rate': 5e-05, 'epoch': 18.76}
{'loss': 0.0261, 'grad_norm': 0.12925387961294468, 'learning_rate': 5e-05, 'epoch': 18.77}
{'loss': 0.0251, 'grad_norm': 0.05577841106371147, 'learning_rate': 5e-05, 'epoch': 18.78}
{'loss': 0.0258, 'grad_norm': 0.08447912775729437, 'learning_rate': 5e-05, 'epoch': 18.8}
{'loss': 0.0262, 'grad_norm': 0.1173996713309078, 'learning_rate': 5e-05, 'epoch': 18.81}
{'loss': 0.0262, 'grad_norm': 0.10612270043097952, 'learning_rate': 5e-05, 'epoch': 18.82}
{'loss': 0.0256, 'grad_norm': 0.0916557800220441, 'learning_rate': 5e-05, 'epoch': 18.84}
{'loss': 0.0261, 'grad_norm': 0.15990814320545196, 'learning_rate': 5e-05, 'epoch': 18.85}
{'loss': 0.0257, 'grad_norm': 0.07235944946275347, 'learning_rate': 5e-05, 'epoch': 18.86}
{'loss': 0.0259, 'grad_norm': 0.10994304304722395, 'learning_rate': 5e-05, 'epoch': 18.88}
{'loss': 0.0264, 'grad_norm': 0.10339954453449635, 'learning_rate': 5e-05, 'epoch': 18.89}
{'loss': 0.0261, 'grad_norm': 0.05782257262968085, 'learning_rate': 5e-05, 'epoch': 18.9}
{'loss': 0.0257, 'grad_norm': 0.11564941744475211, 'learning_rate': 5e-05, 'epoch': 18.92}
{'loss': 0.0268, 'grad_norm': 0.0589368273288592, 'learning_rate': 5e-05, 'epoch': 18.93}
{'loss': 0.0258, 'grad_norm': 0.14272299683084383, 'learning_rate': 5e-05, 'epoch': 18.94}
{'loss': 0.0263, 'grad_norm': 0.08544276894341787, 'learning_rate': 5e-05, 'epoch': 18.96}
{'loss': 0.0259, 'grad_norm': 0.07999700705975848, 'learning_rate': 5e-05, 'epoch': 18.97}
{'loss': 0.0261, 'grad_norm': 0.17830186938604514, 'learning_rate': 5e-05, 'epoch': 18.98}
{'loss': 0.0258, 'grad_norm': 0.08276067295098799, 'learning_rate': 5e-05, 'epoch': 19.0}
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 14193/17928 [6:48:48<1:06:27,  1.07s/it][INFO|gner_trainer.py:60] 2024-11-20 02:10:36,003 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 02:10:36,003 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 02:10:36,003 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3635.25it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3669.16it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3656.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3664.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3645.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3643.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3651.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3607.32it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4052.55it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4104.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4073.27it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4096.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4076.67it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4075.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4083.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4039.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1376.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1407.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1413.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1344.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1324.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1094.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1084.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 984.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 985.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 959.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 966.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 944.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1080.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 545.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.83it/s]
{'eval_mit-movie_precision': 0.5737627279185278, 'eval_mit-movie_recall': 0.4538303053006096, 'eval_mit-movie_f1': 0.5067977410090264, 'eval_mit-restaurant_precision': 0.5355742296918468, 'eval_mit-restaurant_recall': 0.3034920634920539, 'eval_mit-restaurant_f1': 0.3874366767521885, 'eval_crossner_ai_precision': 0.4643028270244147, 'eval_crossner_ai_recall': 0.6029869321717111, 'eval_crossner_ai_f1': 0.5246345424521693, 'eval_crossner_literature_precision': 0.5241099594411661, 'eval_crossner_literature_recall': 0.5867810292633407, 'eval_crossner_literature_f1': 0.5536776957368502, 'eval_crossner_music_precision': 0.649925261584435, 'eval_crossner_music_recall': 0.6959026888604131, 'eval_crossner_music_f1': 0.6721286133369598, 'eval_crossner_politics_precision': 0.544091316025055, 'eval_crossner_politics_recall': 0.6233333333333173, 'eval_crossner_politics_f1': 0.5810229445008857, 'eval_crossner_science_precision': 0.5552486187845134, 'eval_crossner_science_recall': 0.7150197628458216, 'eval_crossner_science_f1': 0.6250863855762013, 'eval_wiki_passage_from_zero_precision': 0.8566268581927491, 'eval_wiki_passage_from_zero_recall': 0.8222244488977939, 'eval_wiki_passage_from_zero_f1': 0.83907317267692, 'eval_average_f1': 0.5862322215051502, 'eval_runtime': 493.9824, 'eval_samples_per_second': 27.695, 'eval_steps_per_second': 0.109, 'epoch': 19.0}
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 14193/17928 [6:57:02<1:06:27,  1.07s/it]
[INFO|trainer.py:3812] 2024-11-20 02:18:50,960 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-14193
[INFO|configuration_utils.py:414] 2024-11-20 02:18:50,962 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-14193/config.json
[INFO|configuration_utils.py:865] 2024-11-20 02:18:50,962 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-14193/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 02:18:51,671 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-14193/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 02:18:51,673 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-14193/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 02:18:51,673 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-14193/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 02:18:51,674 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-14193/spiece.model
[2024-11-20 02:18:51,699] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step14193 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 02:18:51,821] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/mp_rank_00_model_states.pt
[2024-11-20 02:18:51,821] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/mp_rank_00_model_states.pt...
[2024-11-20 02:18:52,586] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/mp_rank_00_model_states.pt.
[2024-11-20 02:18:52,587] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 02:18:53,276] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 02:18:53,276] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-14193/global_step14193/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 02:18:53,276] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step14193 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0257, 'grad_norm': 0.06180544209082924, 'learning_rate': 5e-05, 'epoch': 19.01}
{'loss': 0.0261, 'grad_norm': 0.06392769426349987, 'learning_rate': 5e-05, 'epoch': 19.02}
{'loss': 0.0253, 'grad_norm': 0.06596573758916036, 'learning_rate': 5e-05, 'epoch': 19.04}
{'loss': 0.0255, 'grad_norm': 0.06870917671489207, 'learning_rate': 5e-05, 'epoch': 19.05}
{'loss': 0.0254, 'grad_norm': 0.08420760959519186, 'learning_rate': 5e-05, 'epoch': 19.06}
{'loss': 0.0258, 'grad_norm': 0.161081490868831, 'learning_rate': 5e-05, 'epoch': 19.08}
{'loss': 0.0255, 'grad_norm': 0.0844094034098087, 'learning_rate': 5e-05, 'epoch': 19.09}
{'loss': 0.0253, 'grad_norm': 0.07480169980031333, 'learning_rate': 5e-05, 'epoch': 19.1}
{'loss': 0.0258, 'grad_norm': 0.07470735537390115, 'learning_rate': 5e-05, 'epoch': 19.12}
{'loss': 0.0256, 'grad_norm': 0.05907042050361219, 'learning_rate': 5e-05, 'epoch': 19.13}
{'loss': 0.0257, 'grad_norm': 0.0799071358861738, 'learning_rate': 5e-05, 'epoch': 19.14}
{'loss': 0.0252, 'grad_norm': 0.10812506700524696, 'learning_rate': 5e-05, 'epoch': 19.16}
{'loss': 0.0254, 'grad_norm': 0.08966938492959706, 'learning_rate': 5e-05, 'epoch': 19.17}
{'loss': 0.0261, 'grad_norm': 0.1446781507338662, 'learning_rate': 5e-05, 'epoch': 19.18}
{'loss': 0.0259, 'grad_norm': 0.08055017481204196, 'learning_rate': 5e-05, 'epoch': 19.2}
{'loss': 0.0258, 'grad_norm': 0.07458348124483206, 'learning_rate': 5e-05, 'epoch': 19.21}
{'loss': 0.0258, 'grad_norm': 0.08749823132072758, 'learning_rate': 5e-05, 'epoch': 19.22}
{'loss': 0.0253, 'grad_norm': 0.05464709015085821, 'learning_rate': 5e-05, 'epoch': 19.24}
{'loss': 0.0257, 'grad_norm': 0.13168654277727, 'learning_rate': 5e-05, 'epoch': 19.25}
{'loss': 0.0259, 'grad_norm': 0.07586687414835053, 'learning_rate': 5e-05, 'epoch': 19.26}
{'loss': 0.0255, 'grad_norm': 0.12064834944401873, 'learning_rate': 5e-05, 'epoch': 19.28}
{'loss': 0.0252, 'grad_norm': 0.06398754954468429, 'learning_rate': 5e-05, 'epoch': 19.29}
{'loss': 0.0258, 'grad_norm': 0.0706361467871693, 'learning_rate': 5e-05, 'epoch': 19.3}
{'loss': 0.0254, 'grad_norm': 0.05597960605918869, 'learning_rate': 5e-05, 'epoch': 19.32}
{'loss': 0.0257, 'grad_norm': 0.07478029734940851, 'learning_rate': 5e-05, 'epoch': 19.33}
{'loss': 0.0261, 'grad_norm': 0.07097137550837337, 'learning_rate': 5e-05, 'epoch': 19.34}
{'loss': 0.0263, 'grad_norm': 0.06917742286068526, 'learning_rate': 5e-05, 'epoch': 19.36}
{'loss': 0.0247, 'grad_norm': 0.09873137883975248, 'learning_rate': 5e-05, 'epoch': 19.37}
{'loss': 0.0255, 'grad_norm': 0.054870382696766695, 'learning_rate': 5e-05, 'epoch': 19.38}
{'loss': 0.0255, 'grad_norm': 0.061643845941785486, 'learning_rate': 5e-05, 'epoch': 19.4}
{'loss': 0.0257, 'grad_norm': 0.07972820810622346, 'learning_rate': 5e-05, 'epoch': 19.41}
{'loss': 0.0255, 'grad_norm': 0.15501467418042608, 'learning_rate': 5e-05, 'epoch': 19.42}
{'loss': 0.0254, 'grad_norm': 0.09138146211067151, 'learning_rate': 5e-05, 'epoch': 19.44}
{'loss': 0.0255, 'grad_norm': 0.05986634553095458, 'learning_rate': 5e-05, 'epoch': 19.45}
{'loss': 0.0251, 'grad_norm': 0.16069347134693177, 'learning_rate': 5e-05, 'epoch': 19.46}
{'loss': 0.0255, 'grad_norm': 0.11946879201205286, 'learning_rate': 5e-05, 'epoch': 19.48}
{'loss': 0.0256, 'grad_norm': 0.1342125892557503, 'learning_rate': 5e-05, 'epoch': 19.49}
{'loss': 0.0254, 'grad_norm': 0.07832231935227335, 'learning_rate': 5e-05, 'epoch': 19.5}
{'loss': 0.0256, 'grad_norm': 0.07496208707873195, 'learning_rate': 5e-05, 'epoch': 19.52}
{'loss': 0.0253, 'grad_norm': 0.05057587265718687, 'learning_rate': 5e-05, 'epoch': 19.53}
{'loss': 0.0259, 'grad_norm': 0.1089463391465937, 'learning_rate': 5e-05, 'epoch': 19.54}
{'loss': 0.0252, 'grad_norm': 0.10193062968932239, 'learning_rate': 5e-05, 'epoch': 19.56}
{'loss': 0.0257, 'grad_norm': 0.09812158819359765, 'learning_rate': 5e-05, 'epoch': 19.57}
{'loss': 0.0251, 'grad_norm': 0.1011600820745345, 'learning_rate': 5e-05, 'epoch': 19.59}
{'loss': 0.0258, 'grad_norm': 0.08015853345511095, 'learning_rate': 5e-05, 'epoch': 19.6}
{'loss': 0.0251, 'grad_norm': 0.05704946170013507, 'learning_rate': 5e-05, 'epoch': 19.61}
{'loss': 0.0259, 'grad_norm': 0.07792217330749304, 'learning_rate': 5e-05, 'epoch': 19.63}
{'loss': 0.0263, 'grad_norm': 0.17240745799602714, 'learning_rate': 5e-05, 'epoch': 19.64}
{'loss': 0.0248, 'grad_norm': 0.12048948556660202, 'learning_rate': 5e-05, 'epoch': 19.65}
{'loss': 0.0254, 'grad_norm': 0.10082096585162179, 'learning_rate': 5e-05, 'epoch': 19.67}
{'loss': 0.0253, 'grad_norm': 0.0824259419138428, 'learning_rate': 5e-05, 'epoch': 19.68}
{'loss': 0.0253, 'grad_norm': 0.10688211778451638, 'learning_rate': 5e-05, 'epoch': 19.69}
{'loss': 0.0254, 'grad_norm': 0.08212363059464044, 'learning_rate': 5e-05, 'epoch': 19.71}
{'loss': 0.0252, 'grad_norm': 0.07815531798027794, 'learning_rate': 5e-05, 'epoch': 19.72}
{'loss': 0.0263, 'grad_norm': 0.07656044762643713, 'learning_rate': 5e-05, 'epoch': 19.73}
{'loss': 0.0256, 'grad_norm': 0.11863170255858364, 'learning_rate': 5e-05, 'epoch': 19.75}
{'loss': 0.0255, 'grad_norm': 0.07848705796902371, 'learning_rate': 5e-05, 'epoch': 19.76}
{'loss': 0.0249, 'grad_norm': 0.05969183478854691, 'learning_rate': 5e-05, 'epoch': 19.77}
{'loss': 0.0255, 'grad_norm': 0.14642352429752412, 'learning_rate': 5e-05, 'epoch': 19.79}
{'loss': 0.0253, 'grad_norm': 0.15657951061746103, 'learning_rate': 5e-05, 'epoch': 19.8}
{'loss': 0.026, 'grad_norm': 0.08758161848775818, 'learning_rate': 5e-05, 'epoch': 19.81}
{'loss': 0.0256, 'grad_norm': 0.08148313657179773, 'learning_rate': 5e-05, 'epoch': 19.83}
{'loss': 0.0256, 'grad_norm': 0.10180561147485247, 'learning_rate': 5e-05, 'epoch': 19.84}
{'loss': 0.0256, 'grad_norm': 0.10717755189502101, 'learning_rate': 5e-05, 'epoch': 19.85}
{'loss': 0.0256, 'grad_norm': 0.0992996271038665, 'learning_rate': 5e-05, 'epoch': 19.87}
{'loss': 0.0254, 'grad_norm': 0.07490061940741123, 'learning_rate': 5e-05, 'epoch': 19.88}
{'loss': 0.026, 'grad_norm': 0.1222885279486889, 'learning_rate': 5e-05, 'epoch': 19.89}
{'loss': 0.0257, 'grad_norm': 0.08317657033518845, 'learning_rate': 5e-05, 'epoch': 19.91}
{'loss': 0.0253, 'grad_norm': 0.051805366406963316, 'learning_rate': 5e-05, 'epoch': 19.92}
{'loss': 0.0261, 'grad_norm': 0.09432488745977906, 'learning_rate': 5e-05, 'epoch': 19.93}
{'loss': 0.025, 'grad_norm': 0.08063232441741411, 'learning_rate': 5e-05, 'epoch': 19.95}
{'loss': 0.0258, 'grad_norm': 0.08914577915559677, 'learning_rate': 5e-05, 'epoch': 19.96}
{'loss': 0.0249, 'grad_norm': 0.058073956896498906, 'learning_rate': 5e-05, 'epoch': 19.97}
{'loss': 0.027, 'grad_norm': 0.08912718644844217, 'learning_rate': 5e-05, 'epoch': 19.99}
{'loss': 0.0258, 'grad_norm': 0.11941617618795258, 'learning_rate': 5e-05, 'epoch': 20.0}
 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 14940/17928 [7:10:28<52:53,  1.06s/it][INFO|gner_trainer.py:60] 2024-11-20 02:32:15,834 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 02:32:15,834 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 02:32:15,834 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3646.65it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3636.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3621.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3658.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3636.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.74it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3614.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3576.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4070.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4021.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4049.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4069.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4086.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4069.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4039.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1413.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 3988.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1359.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1410.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1382.24it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1112.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1063.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.09it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1101.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1079.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 988.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 957.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 966.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 952.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 946.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1100.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1084.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 546.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 545.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 534.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.80it/s]
{'eval_mit-movie_precision': 0.5402833111996339, 'eval_mit-movie_recall': 0.4572017231691242, 'eval_mit-movie_f1': 0.49528254027700824, 'eval_mit-restaurant_precision': 0.5139175257731694, 'eval_mit-restaurant_recall': 0.31650793650792647, 'eval_mit-restaurant_f1': 0.39174852647540354, 'eval_crossner_ai_precision': 0.46108058608056496, 'eval_crossner_ai_recall': 0.626633478531386, 'eval_crossner_ai_f1': 0.531258243158727, 'eval_crossner_literature_precision': 0.487836663770613, 'eval_crossner_literature_recall': 0.56659939455093, 'eval_crossner_literature_f1': 0.5242763771678082, 'eval_crossner_music_precision': 0.6469201296787312, 'eval_crossner_music_recall': 0.7026248399487611, 'eval_crossner_music_f1': 0.6736228325417478, 'eval_crossner_politics_precision': 0.5332316408803545, 'eval_crossner_politics_recall': 0.6274358974358814, 'eval_crossner_politics_f1': 0.5765107786050455, 'eval_crossner_science_precision': 0.5557882141788646, 'eval_crossner_science_recall': 0.7343873517786271, 'eval_crossner_science_f1': 0.6327260343456242, 'eval_wiki_passage_from_zero_precision': 0.843294003359574, 'eval_wiki_passage_from_zero_recall': 0.8350300601202387, 'eval_wiki_passage_from_zero_f1': 0.8391416861680417, 'eval_average_f1': 0.5830708773424258, 'eval_runtime': 485.5302, 'eval_samples_per_second': 28.177, 'eval_steps_per_second': 0.111, 'epoch': 20.0}
 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 14940/17928 [7:18:33<52:53,  1.06s/it]
[INFO|trainer.py:3812] 2024-11-20 02:40:22,281 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-14940
[INFO|configuration_utils.py:414] 2024-11-20 02:40:22,283 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-14940/config.json
[INFO|configuration_utils.py:865] 2024-11-20 02:40:22,283 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-14940/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 02:40:23,103 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-14940/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 02:40:23,104 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-14940/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 02:40:23,105 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-14940/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 02:40:23,105 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-14940/spiece.model
[2024-11-20 02:40:23,128] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step14940 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 02:40:23,134] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/mp_rank_00_model_states.pt
[2024-11-20 02:40:23,134] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/mp_rank_00_model_states.pt...
[2024-11-20 02:40:23,893] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/mp_rank_00_model_states.pt.
[2024-11-20 02:40:23,895] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 02:40:24,526] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 02:40:24,527] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-14940/global_step14940/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 02:40:24,527] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step14940 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0248, 'grad_norm': 0.0894805366461567, 'learning_rate': 5e-05, 'epoch': 20.01}
{'loss': 0.0248, 'grad_norm': 0.08082309060832499, 'learning_rate': 5e-05, 'epoch': 20.03}
{'loss': 0.0255, 'grad_norm': 0.16571570962386034, 'learning_rate': 5e-05, 'epoch': 20.04}
{'loss': 0.0251, 'grad_norm': 0.05638644100116839, 'learning_rate': 5e-05, 'epoch': 20.05}
{'loss': 0.0247, 'grad_norm': 0.0760889549575551, 'learning_rate': 5e-05, 'epoch': 20.07}
{'loss': 0.0255, 'grad_norm': 0.08870252613048911, 'learning_rate': 5e-05, 'epoch': 20.08}
{'loss': 0.0252, 'grad_norm': 0.09411365787590818, 'learning_rate': 5e-05, 'epoch': 20.09}
{'loss': 0.0249, 'grad_norm': 0.0863542125734952, 'learning_rate': 5e-05, 'epoch': 20.11}
{'loss': 0.0254, 'grad_norm': 0.07900572492960502, 'learning_rate': 5e-05, 'epoch': 20.12}
{'loss': 0.0261, 'grad_norm': 0.1663054292907529, 'learning_rate': 5e-05, 'epoch': 20.13}
{'loss': 0.025, 'grad_norm': 0.10184955378590567, 'learning_rate': 5e-05, 'epoch': 20.15}
{'loss': 0.0256, 'grad_norm': 0.05341571170215916, 'learning_rate': 5e-05, 'epoch': 20.16}
{'loss': 0.0259, 'grad_norm': 0.14175230092791588, 'learning_rate': 5e-05, 'epoch': 20.17}
{'loss': 0.0254, 'grad_norm': 0.15712189003765592, 'learning_rate': 5e-05, 'epoch': 20.19}
{'loss': 0.0262, 'grad_norm': 0.12246479000985795, 'learning_rate': 5e-05, 'epoch': 20.2}
{'loss': 0.0255, 'grad_norm': 0.05776980158769484, 'learning_rate': 5e-05, 'epoch': 20.21}
{'loss': 0.0254, 'grad_norm': 0.07060743767089026, 'learning_rate': 5e-05, 'epoch': 20.23}
{'loss': 0.0252, 'grad_norm': 0.17470773746865892, 'learning_rate': 5e-05, 'epoch': 20.24}
{'loss': 0.0254, 'grad_norm': 0.14168584222837596, 'learning_rate': 5e-05, 'epoch': 20.25}
{'loss': 0.026, 'grad_norm': 0.18484665100130002, 'learning_rate': 5e-05, 'epoch': 20.27}
{'loss': 0.0262, 'grad_norm': 0.1889804863184704, 'learning_rate': 5e-05, 'epoch': 20.28}
{'loss': 0.0249, 'grad_norm': 0.11803569993899006, 'learning_rate': 5e-05, 'epoch': 20.29}
{'loss': 0.0252, 'grad_norm': 0.15019758021871268, 'learning_rate': 5e-05, 'epoch': 20.31}
{'loss': 0.0254, 'grad_norm': 0.08671676820346289, 'learning_rate': 5e-05, 'epoch': 20.32}
{'loss': 0.0251, 'grad_norm': 0.08443312188395423, 'learning_rate': 5e-05, 'epoch': 20.33}
{'loss': 0.0255, 'grad_norm': 0.1673398386696734, 'learning_rate': 5e-05, 'epoch': 20.35}
{'loss': 0.0253, 'grad_norm': 0.07566278233033523, 'learning_rate': 5e-05, 'epoch': 20.36}
{'loss': 0.0257, 'grad_norm': 0.0871529617656971, 'learning_rate': 5e-05, 'epoch': 20.37}
{'loss': 0.0257, 'grad_norm': 0.10907298778862168, 'learning_rate': 5e-05, 'epoch': 20.39}
{'loss': 0.0247, 'grad_norm': 0.11222637182472461, 'learning_rate': 5e-05, 'epoch': 20.4}
{'loss': 0.0249, 'grad_norm': 0.07131212331812785, 'learning_rate': 5e-05, 'epoch': 20.41}
{'loss': 0.0247, 'grad_norm': 0.05358493938258947, 'learning_rate': 5e-05, 'epoch': 20.43}
{'loss': 0.025, 'grad_norm': 0.10944640434401819, 'learning_rate': 5e-05, 'epoch': 20.44}
{'loss': 0.0248, 'grad_norm': 0.13060921628403652, 'learning_rate': 5e-05, 'epoch': 20.46}
{'loss': 0.0252, 'grad_norm': 0.09609435845004101, 'learning_rate': 5e-05, 'epoch': 20.47}
{'loss': 0.0257, 'grad_norm': 0.09815981731654576, 'learning_rate': 5e-05, 'epoch': 20.48}
{'loss': 0.0243, 'grad_norm': 0.057924469566838915, 'learning_rate': 5e-05, 'epoch': 20.5}
{'loss': 0.0249, 'grad_norm': 0.12749152093396687, 'learning_rate': 5e-05, 'epoch': 20.51}
{'loss': 0.0259, 'grad_norm': 0.06675568322769775, 'learning_rate': 5e-05, 'epoch': 20.52}
{'loss': 0.0254, 'grad_norm': 0.07857636064534858, 'learning_rate': 5e-05, 'epoch': 20.54}
{'loss': 0.0254, 'grad_norm': 0.06321240627504589, 'learning_rate': 5e-05, 'epoch': 20.55}
{'loss': 0.0246, 'grad_norm': 0.06568442759011524, 'learning_rate': 5e-05, 'epoch': 20.56}
{'loss': 0.0252, 'grad_norm': 0.07395041104597258, 'learning_rate': 5e-05, 'epoch': 20.58}
{'loss': 0.0254, 'grad_norm': 0.10909947535030727, 'learning_rate': 5e-05, 'epoch': 20.59}
{'loss': 0.0255, 'grad_norm': 0.0713699711255189, 'learning_rate': 5e-05, 'epoch': 20.6}
{'loss': 0.0259, 'grad_norm': 0.08678479976334444, 'learning_rate': 5e-05, 'epoch': 20.62}
{'loss': 0.0253, 'grad_norm': 0.0690621861875749, 'learning_rate': 5e-05, 'epoch': 20.63}
{'loss': 0.0253, 'grad_norm': 0.06320695106327276, 'learning_rate': 5e-05, 'epoch': 20.64}
{'loss': 0.025, 'grad_norm': 0.0869640838609724, 'learning_rate': 5e-05, 'epoch': 20.66}
{'loss': 0.0249, 'grad_norm': 0.09192550048149815, 'learning_rate': 5e-05, 'epoch': 20.67}
{'loss': 0.0258, 'grad_norm': 0.08070963352783198, 'learning_rate': 5e-05, 'epoch': 20.68}
{'loss': 0.0256, 'grad_norm': 0.07901058734610489, 'learning_rate': 5e-05, 'epoch': 20.7}
{'loss': 0.0263, 'grad_norm': 0.06386290136298142, 'learning_rate': 5e-05, 'epoch': 20.71}
{'loss': 0.0247, 'grad_norm': 0.12369674548213716, 'learning_rate': 5e-05, 'epoch': 20.72}
{'loss': 0.0249, 'grad_norm': 0.07537771680250971, 'learning_rate': 5e-05, 'epoch': 20.74}
{'loss': 0.0251, 'grad_norm': 0.07256092488791431, 'learning_rate': 5e-05, 'epoch': 20.75}
{'loss': 0.0249, 'grad_norm': 0.11821539213235303, 'learning_rate': 5e-05, 'epoch': 20.76}
{'loss': 0.0256, 'grad_norm': 0.07764245258006688, 'learning_rate': 5e-05, 'epoch': 20.78}
{'loss': 0.0249, 'grad_norm': 0.08427251965539342, 'learning_rate': 5e-05, 'epoch': 20.79}
{'loss': 0.0253, 'grad_norm': 0.10082664206794795, 'learning_rate': 5e-05, 'epoch': 20.8}
{'loss': 0.0245, 'grad_norm': 0.08376548486490452, 'learning_rate': 5e-05, 'epoch': 20.82}
{'loss': 0.0249, 'grad_norm': 0.15876761147287172, 'learning_rate': 5e-05, 'epoch': 20.83}
{'loss': 0.0253, 'grad_norm': 0.06857199301023473, 'learning_rate': 5e-05, 'epoch': 20.84}
{'loss': 0.025, 'grad_norm': 0.06629374384155813, 'learning_rate': 5e-05, 'epoch': 20.86}
{'loss': 0.0245, 'grad_norm': 0.14364823388004172, 'learning_rate': 5e-05, 'epoch': 20.87}
{'loss': 0.0253, 'grad_norm': 0.04838407544690251, 'learning_rate': 5e-05, 'epoch': 20.88}
{'loss': 0.0249, 'grad_norm': 0.053588865015121105, 'learning_rate': 5e-05, 'epoch': 20.9}
{'loss': 0.0252, 'grad_norm': 0.0444304260759658, 'learning_rate': 5e-05, 'epoch': 20.91}
{'loss': 0.0255, 'grad_norm': 0.11176680418374016, 'learning_rate': 5e-05, 'epoch': 20.92}
{'loss': 0.0257, 'grad_norm': 0.10520352464331159, 'learning_rate': 5e-05, 'epoch': 20.94}
{'loss': 0.0251, 'grad_norm': 0.07308976207229302, 'learning_rate': 5e-05, 'epoch': 20.95}
{'loss': 0.0255, 'grad_norm': 0.11156633473999684, 'learning_rate': 5e-05, 'epoch': 20.96}
{'loss': 0.0248, 'grad_norm': 0.13493058571365502, 'learning_rate': 5e-05, 'epoch': 20.98}
{'loss': 0.025, 'grad_norm': 0.10830577979836854, 'learning_rate': 5e-05, 'epoch': 20.99}
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 15687/17928 [7:31:59<41:49,  1.12s/it][INFO|gner_trainer.py:60] 2024-11-20 02:53:47,238 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 02:53:47,238 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 02:53:47,238 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3669.51it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3663.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3646.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3632.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3596.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3667.49it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3628.48it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4113.67it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3654.14it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4100.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4067.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4049.40it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4002.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.29it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4075.98it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4020.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.99it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4056.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.46it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1376.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1384.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1106.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1388.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1062.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1098.24it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1068.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 983.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 981.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 981.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 958.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1097.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1083.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1097.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 544.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 528.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 524.29it/s]
{'eval_mit-movie_precision': 0.5633867276887743, 'eval_mit-movie_recall': 0.46113504401572464, 'eval_mit-movie_f1': 0.5071583066762059, 'eval_mit-restaurant_precision': 0.5347965738757744, 'eval_mit-restaurant_recall': 0.31714285714284707, 'eval_mit-restaurant_f1': 0.39816660019238675, 'eval_crossner_ai_precision': 0.4734917733089363, 'eval_crossner_ai_recall': 0.6446795270690326, 'eval_crossner_ai_f1': 0.54598155462835, 'eval_crossner_literature_precision': 0.5050772626931345, 'eval_crossner_literature_recall': 0.5771947527749456, 'eval_crossner_literature_f1': 0.538733223402045, 'eval_crossner_music_precision': 0.6628148148147952, 'eval_crossner_music_recall': 0.7160691421254572, 'eval_crossner_music_f1': 0.6884136020426831, 'eval_crossner_politics_precision': 0.5446742957746359, 'eval_crossner_politics_recall': 0.6346153846153684, 'eval_crossner_politics_f1': 0.5862150639010113, 'eval_crossner_science_precision': 0.5546193198916475, 'eval_crossner_science_recall': 0.7284584980236866, 'eval_crossner_science_f1': 0.6297625149004947, 'eval_wiki_passage_from_zero_precision': 0.8503017285465871, 'eval_wiki_passage_from_zero_recall': 0.8330060120240464, 'eval_wiki_passage_from_zero_f1': 0.8415650148814203, 'eval_average_f1': 0.5919994850780746, 'eval_runtime': 491.0177, 'eval_samples_per_second': 27.863, 'eval_steps_per_second': 0.11, 'epoch': 21.0}
 88%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 15687/17928 [7:40:10<41:49,  1.12s/it]
[INFO|trainer.py:3812] 2024-11-20 03:01:59,298 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-15687
[INFO|configuration_utils.py:414] 2024-11-20 03:01:59,300 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-15687/config.json
[INFO|configuration_utils.py:865] 2024-11-20 03:01:59,300 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-15687/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 03:02:00,202 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-15687/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 03:02:00,204 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-15687/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 03:02:00,204 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-15687/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 03:02:00,205 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-15687/spiece.model
[2024-11-20 03:02:00,227] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step15687 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 03:02:00,233] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/mp_rank_00_model_states.pt
[2024-11-20 03:02:00,233] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/mp_rank_00_model_states.pt...
[2024-11-20 03:02:01,117] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/mp_rank_00_model_states.pt.
[2024-11-20 03:02:01,118] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 03:02:01,920] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 03:02:01,921] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-15687/global_step15687/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 03:02:01,921] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step15687 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0247, 'grad_norm': 0.09371840421403603, 'learning_rate': 5e-05, 'epoch': 21.0}
{'loss': 0.0247, 'grad_norm': 0.053156025763980035, 'learning_rate': 5e-05, 'epoch': 21.02}
{'loss': 0.0257, 'grad_norm': 0.05801706641651685, 'learning_rate': 5e-05, 'epoch': 21.03}
{'loss': 0.0253, 'grad_norm': 0.08188942729348489, 'learning_rate': 5e-05, 'epoch': 21.04}
{'loss': 0.0244, 'grad_norm': 0.06988444431952089, 'learning_rate': 5e-05, 'epoch': 21.06}
{'loss': 0.024, 'grad_norm': 0.133918170865712, 'learning_rate': 5e-05, 'epoch': 21.07}
{'loss': 0.0243, 'grad_norm': 0.05476238454055762, 'learning_rate': 5e-05, 'epoch': 21.08}
{'loss': 0.0254, 'grad_norm': 0.08311459180825333, 'learning_rate': 5e-05, 'epoch': 21.1}
{'loss': 0.025, 'grad_norm': 0.15617060432279722, 'learning_rate': 5e-05, 'epoch': 21.11}
{'loss': 0.0245, 'grad_norm': 0.07345643496911616, 'learning_rate': 5e-05, 'epoch': 21.12}
{'loss': 0.0257, 'grad_norm': 0.10404723343971474, 'learning_rate': 5e-05, 'epoch': 21.14}
{'loss': 0.0243, 'grad_norm': 0.06635779127364816, 'learning_rate': 5e-05, 'epoch': 21.15}
{'loss': 0.0255, 'grad_norm': 0.08405443252526931, 'learning_rate': 5e-05, 'epoch': 21.16}
{'loss': 0.0248, 'grad_norm': 0.0507131404051496, 'learning_rate': 5e-05, 'epoch': 21.18}
{'loss': 0.0249, 'grad_norm': 0.06504955106939687, 'learning_rate': 5e-05, 'epoch': 21.19}
{'loss': 0.025, 'grad_norm': 0.08543824806632361, 'learning_rate': 5e-05, 'epoch': 21.2}
{'loss': 0.025, 'grad_norm': 0.08037364614983142, 'learning_rate': 5e-05, 'epoch': 21.22}
{'loss': 0.0253, 'grad_norm': 0.08265441107822613, 'learning_rate': 5e-05, 'epoch': 21.23}
{'loss': 0.0247, 'grad_norm': 0.08455209084243634, 'learning_rate': 5e-05, 'epoch': 21.24}
{'loss': 0.0247, 'grad_norm': 0.06450859486115976, 'learning_rate': 5e-05, 'epoch': 21.26}
{'loss': 0.0252, 'grad_norm': 0.10172968180902485, 'learning_rate': 5e-05, 'epoch': 21.27}
{'loss': 0.0254, 'grad_norm': 0.05438037188072761, 'learning_rate': 5e-05, 'epoch': 21.29}
{'loss': 0.0254, 'grad_norm': 0.13203956278753642, 'learning_rate': 5e-05, 'epoch': 21.3}
{'loss': 0.0249, 'grad_norm': 0.0632890720007192, 'learning_rate': 5e-05, 'epoch': 21.31}
{'loss': 0.0242, 'grad_norm': 0.06597030469376157, 'learning_rate': 5e-05, 'epoch': 21.33}
{'loss': 0.0249, 'grad_norm': 0.06691428053086051, 'learning_rate': 5e-05, 'epoch': 21.34}
{'loss': 0.0257, 'grad_norm': 0.06736478011404019, 'learning_rate': 5e-05, 'epoch': 21.35}
{'loss': 0.0248, 'grad_norm': 0.0787930890493206, 'learning_rate': 5e-05, 'epoch': 21.37}
{'loss': 0.025, 'grad_norm': 0.09241432152625623, 'learning_rate': 5e-05, 'epoch': 21.38}
{'loss': 0.0249, 'grad_norm': 0.06905730771702968, 'learning_rate': 5e-05, 'epoch': 21.39}
{'loss': 0.0246, 'grad_norm': 0.07115789325841289, 'learning_rate': 5e-05, 'epoch': 21.41}
{'loss': 0.0251, 'grad_norm': 0.05880267921802727, 'learning_rate': 5e-05, 'epoch': 21.42}
{'loss': 0.0249, 'grad_norm': 0.06814589886920705, 'learning_rate': 5e-05, 'epoch': 21.43}
{'loss': 0.0256, 'grad_norm': 0.11918496651274768, 'learning_rate': 5e-05, 'epoch': 21.45}
{'loss': 0.0254, 'grad_norm': 0.06945244979744743, 'learning_rate': 5e-05, 'epoch': 21.46}
{'loss': 0.0252, 'grad_norm': 0.11310222060490406, 'learning_rate': 5e-05, 'epoch': 21.47}
{'loss': 0.0244, 'grad_norm': 0.10943648194085152, 'learning_rate': 5e-05, 'epoch': 21.49}
{'loss': 0.025, 'grad_norm': 0.1414078604358838, 'learning_rate': 5e-05, 'epoch': 21.5}
{'loss': 0.0251, 'grad_norm': 0.05504357272092838, 'learning_rate': 5e-05, 'epoch': 21.51}
{'loss': 0.025, 'grad_norm': 0.12695970518225255, 'learning_rate': 5e-05, 'epoch': 21.53}
{'loss': 0.0263, 'grad_norm': 0.09062681812896116, 'learning_rate': 5e-05, 'epoch': 21.54}
{'loss': 0.0248, 'grad_norm': 0.061245460591406155, 'learning_rate': 5e-05, 'epoch': 21.55}
{'loss': 0.0246, 'grad_norm': 0.1057490579876528, 'learning_rate': 5e-05, 'epoch': 21.57}
{'loss': 0.0248, 'grad_norm': 0.10359334726960162, 'learning_rate': 5e-05, 'epoch': 21.58}
{'loss': 0.0253, 'grad_norm': 0.1357473605700224, 'learning_rate': 5e-05, 'epoch': 21.59}
{'loss': 0.0242, 'grad_norm': 0.0684552133947345, 'learning_rate': 5e-05, 'epoch': 21.61}
{'loss': 0.0247, 'grad_norm': 0.05253310116553298, 'learning_rate': 5e-05, 'epoch': 21.62}
{'loss': 0.0245, 'grad_norm': 0.08602685509425868, 'learning_rate': 5e-05, 'epoch': 21.63}
{'loss': 0.0245, 'grad_norm': 0.09584482077064803, 'learning_rate': 5e-05, 'epoch': 21.65}
{'loss': 0.0255, 'grad_norm': 0.09432617101403716, 'learning_rate': 5e-05, 'epoch': 21.66}
{'loss': 0.0247, 'grad_norm': 0.0991238184963108, 'learning_rate': 5e-05, 'epoch': 21.67}
{'loss': 0.0248, 'grad_norm': 0.08233404757018001, 'learning_rate': 5e-05, 'epoch': 21.69}
{'loss': 0.0245, 'grad_norm': 0.09226885656694195, 'learning_rate': 5e-05, 'epoch': 21.7}
{'loss': 0.0245, 'grad_norm': 0.10865277017512791, 'learning_rate': 5e-05, 'epoch': 21.71}
{'loss': 0.0253, 'grad_norm': 0.10260757700421058, 'learning_rate': 5e-05, 'epoch': 21.73}
{'loss': 0.0236, 'grad_norm': 0.08566277928311004, 'learning_rate': 5e-05, 'epoch': 21.74}
{'loss': 0.0257, 'grad_norm': 0.11844655625084276, 'learning_rate': 5e-05, 'epoch': 21.75}
{'loss': 0.0254, 'grad_norm': 0.05987950504995758, 'learning_rate': 5e-05, 'epoch': 21.77}
{'loss': 0.0253, 'grad_norm': 0.07914383076824305, 'learning_rate': 5e-05, 'epoch': 21.78}
{'loss': 0.0249, 'grad_norm': 0.06711888455192641, 'learning_rate': 5e-05, 'epoch': 21.79}
{'loss': 0.0245, 'grad_norm': 0.09146996889615294, 'learning_rate': 5e-05, 'epoch': 21.81}
{'loss': 0.0255, 'grad_norm': 0.11124285561145089, 'learning_rate': 5e-05, 'epoch': 21.82}
{'loss': 0.0248, 'grad_norm': 0.08220310035020711, 'learning_rate': 5e-05, 'epoch': 21.83}
{'loss': 0.0243, 'grad_norm': 0.06307290181685592, 'learning_rate': 5e-05, 'epoch': 21.85}
{'loss': 0.0246, 'grad_norm': 0.0658355904571487, 'learning_rate': 5e-05, 'epoch': 21.86}
{'loss': 0.025, 'grad_norm': 0.13770467983334606, 'learning_rate': 5e-05, 'epoch': 21.87}
{'loss': 0.0257, 'grad_norm': 0.08174545024210766, 'learning_rate': 5e-05, 'epoch': 21.89}
{'loss': 0.0249, 'grad_norm': 0.07551836004263072, 'learning_rate': 5e-05, 'epoch': 21.9}
{'loss': 0.0248, 'grad_norm': 0.09355322233418575, 'learning_rate': 5e-05, 'epoch': 21.91}
{'loss': 0.0255, 'grad_norm': 0.2193270718013258, 'learning_rate': 5e-05, 'epoch': 21.93}
{'loss': 0.0259, 'grad_norm': 0.092606816493478, 'learning_rate': 5e-05, 'epoch': 21.94}
{'loss': 0.025, 'grad_norm': 0.11496659054015139, 'learning_rate': 5e-05, 'epoch': 21.95}
{'loss': 0.0241, 'grad_norm': 0.07339310039425093, 'learning_rate': 5e-05, 'epoch': 21.97}
{'loss': 0.0251, 'grad_norm': 0.07697035056926921, 'learning_rate': 5e-05, 'epoch': 21.98}
{'loss': 0.0249, 'grad_norm': 0.05012330120152807, 'learning_rate': 5e-05, 'epoch': 21.99}
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 16434/17928 [7:53:37<26:09,  1.05s/it][INFO|gner_trainer.py:60] 2024-11-20 03:15:24,918 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 03:15:24,918 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 03:15:24,918 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3660.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3618.57it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3639.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3680.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3636.21it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3631.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3588.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4117.39it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3653.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4049.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4058.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4099.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1412.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4058.68it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1353.65it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4062.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4030.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4090.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1401.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1348.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1117.98it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1384.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1379.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1099.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1104.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1086.76it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 986.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 979.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 961.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 948.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 940.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 957.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1085.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1091.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1074.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 524.31it/s]
{'eval_mit-movie_precision': 0.547463359639221, 'eval_mit-movie_recall': 0.4547668102640859, 'eval_mit-movie_f1': 0.49682831998315746, 'eval_mit-restaurant_precision': 0.5318352059924809, 'eval_mit-restaurant_recall': 0.31555555555554554, 'eval_mit-restaurant_f1': 0.3960948395627253, 'eval_crossner_ai_precision': 0.4611872146118511, 'eval_crossner_ai_recall': 0.6285003111387287, 'eval_crossner_ai_f1': 0.5319989464878901, 'eval_crossner_literature_precision': 0.5277255639097497, 'eval_crossner_literature_recall': 0.56659939455093, 'eval_crossner_literature_f1': 0.5464720194147566, 'eval_crossner_music_precision': 0.6620260663506913, 'eval_crossner_music_recall': 0.7154289372599003, 'eval_crossner_music_f1': 0.6876923076423617, 'eval_crossner_politics_precision': 0.5625279142474193, 'eval_crossner_politics_recall': 0.6458974358974193, 'eval_crossner_politics_f1': 0.601336834516946, 'eval_crossner_science_precision': 0.5575030750307332, 'eval_crossner_science_recall': 0.7166007905138057, 'eval_crossner_science_f1': 0.6271186440185544, 'eval_wiki_passage_from_zero_precision': 0.8511864614629941, 'eval_wiki_passage_from_zero_recall': 0.8345891783567118, 'eval_wiki_passage_from_zero_f1': 0.8428061156876052, 'eval_average_f1': 0.5912935034142496, 'eval_runtime': 499.5211, 'eval_samples_per_second': 27.388, 'eval_steps_per_second': 0.108, 'epoch': 22.0}
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 16434/17928 [8:01:56<26:09,  1.05s/it]
[INFO|trainer.py:3812] 2024-11-20 03:23:45,348 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-16434
[INFO|configuration_utils.py:414] 2024-11-20 03:23:45,350 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-16434/config.json
[INFO|configuration_utils.py:865] 2024-11-20 03:23:45,350 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-16434/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 03:23:46,263 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-16434/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 03:23:46,265 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-16434/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 03:23:46,266 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-16434/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 03:23:46,268 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-16434/spiece.model
[2024-11-20 03:23:46,291] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step16434 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 03:23:46,304] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/mp_rank_00_model_states.pt
[2024-11-20 03:23:46,304] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/mp_rank_00_model_states.pt...
[2024-11-20 03:23:47,173] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/mp_rank_00_model_states.pt.
[2024-11-20 03:23:47,175] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 03:23:47,986] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 03:23:47,987] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-16434/global_step16434/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 03:23:47,987] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step16434 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0242, 'grad_norm': 0.15351209369509675, 'learning_rate': 5e-05, 'epoch': 22.01}
{'loss': 0.0253, 'grad_norm': 0.0985138950528775, 'learning_rate': 5e-05, 'epoch': 22.02}
{'loss': 0.0249, 'grad_norm': 0.059367477495725386, 'learning_rate': 5e-05, 'epoch': 22.03}
{'loss': 0.0245, 'grad_norm': 0.07640590539905248, 'learning_rate': 5e-05, 'epoch': 22.05}
{'loss': 0.0251, 'grad_norm': 0.08178864377987981, 'learning_rate': 5e-05, 'epoch': 22.06}
{'loss': 0.0244, 'grad_norm': 0.07457964764288849, 'learning_rate': 5e-05, 'epoch': 22.07}
{'loss': 0.0251, 'grad_norm': 0.05188799850713871, 'learning_rate': 5e-05, 'epoch': 22.09}
{'loss': 0.0251, 'grad_norm': 0.10180988809725644, 'learning_rate': 5e-05, 'epoch': 22.1}
{'loss': 0.0242, 'grad_norm': 0.07127444234932265, 'learning_rate': 5e-05, 'epoch': 22.12}
{'loss': 0.0258, 'grad_norm': 0.08199863125913343, 'learning_rate': 5e-05, 'epoch': 22.13}
{'loss': 0.0242, 'grad_norm': 0.14933251667619854, 'learning_rate': 5e-05, 'epoch': 22.14}
{'loss': 0.0251, 'grad_norm': 0.05549911688626114, 'learning_rate': 5e-05, 'epoch': 22.16}
{'loss': 0.0242, 'grad_norm': 0.08586748207683151, 'learning_rate': 5e-05, 'epoch': 22.17}
{'loss': 0.0244, 'grad_norm': 0.07206620589757819, 'learning_rate': 5e-05, 'epoch': 22.18}
{'loss': 0.025, 'grad_norm': 0.08715949070938427, 'learning_rate': 5e-05, 'epoch': 22.2}
{'loss': 0.0251, 'grad_norm': 0.05362025755778209, 'learning_rate': 5e-05, 'epoch': 22.21}
{'loss': 0.0245, 'grad_norm': 0.0975265404451227, 'learning_rate': 5e-05, 'epoch': 22.22}
{'loss': 0.0242, 'grad_norm': 0.08327975885512749, 'learning_rate': 5e-05, 'epoch': 22.24}
{'loss': 0.0252, 'grad_norm': 0.09673627969545404, 'learning_rate': 5e-05, 'epoch': 22.25}
{'loss': 0.0247, 'grad_norm': 0.06749280990612097, 'learning_rate': 5e-05, 'epoch': 22.26}
{'loss': 0.0238, 'grad_norm': 0.07580607255957676, 'learning_rate': 5e-05, 'epoch': 22.28}
{'loss': 0.0249, 'grad_norm': 0.06390494898495393, 'learning_rate': 5e-05, 'epoch': 22.29}
{'loss': 0.0247, 'grad_norm': 0.07525894952562778, 'learning_rate': 5e-05, 'epoch': 22.3}
{'loss': 0.0254, 'grad_norm': 0.0842341766666433, 'learning_rate': 5e-05, 'epoch': 22.32}
{'loss': 0.0252, 'grad_norm': 0.0812232952522999, 'learning_rate': 5e-05, 'epoch': 22.33}
{'loss': 0.0254, 'grad_norm': 0.08304221057622005, 'learning_rate': 5e-05, 'epoch': 22.34}
{'loss': 0.0254, 'grad_norm': 0.07829200359062286, 'learning_rate': 5e-05, 'epoch': 22.36}
{'loss': 0.0249, 'grad_norm': 0.07735812987926434, 'learning_rate': 5e-05, 'epoch': 22.37}
{'loss': 0.0246, 'grad_norm': 0.14441366825560706, 'learning_rate': 5e-05, 'epoch': 22.38}
{'loss': 0.0249, 'grad_norm': 0.08128521779549468, 'learning_rate': 5e-05, 'epoch': 22.4}
{'loss': 0.0245, 'grad_norm': 0.09416902794275694, 'learning_rate': 5e-05, 'epoch': 22.41}
{'loss': 0.0243, 'grad_norm': 0.11212506234338446, 'learning_rate': 5e-05, 'epoch': 22.42}
{'loss': 0.0254, 'grad_norm': 0.08037747859507301, 'learning_rate': 5e-05, 'epoch': 22.44}
{'loss': 0.0245, 'grad_norm': 0.0834494817583464, 'learning_rate': 5e-05, 'epoch': 22.45}
{'loss': 0.0255, 'grad_norm': 0.12627558004077635, 'learning_rate': 5e-05, 'epoch': 22.46}
{'loss': 0.025, 'grad_norm': 0.06883294036184338, 'learning_rate': 5e-05, 'epoch': 22.48}
{'loss': 0.0248, 'grad_norm': 0.11117439782529843, 'learning_rate': 5e-05, 'epoch': 22.49}
{'loss': 0.025, 'grad_norm': 0.072968575898071, 'learning_rate': 5e-05, 'epoch': 22.5}
{'loss': 0.0243, 'grad_norm': 0.07981385551797403, 'learning_rate': 5e-05, 'epoch': 22.52}
{'loss': 0.0247, 'grad_norm': 0.10472152623150968, 'learning_rate': 5e-05, 'epoch': 22.53}
{'loss': 0.0248, 'grad_norm': 0.07910279873482401, 'learning_rate': 5e-05, 'epoch': 22.54}
{'loss': 0.0248, 'grad_norm': 0.05870331414920509, 'learning_rate': 5e-05, 'epoch': 22.56}
{'loss': 0.0248, 'grad_norm': 0.05006348232565783, 'learning_rate': 5e-05, 'epoch': 22.57}
{'loss': 0.0254, 'grad_norm': 0.09453976293332268, 'learning_rate': 5e-05, 'epoch': 22.58}
{'loss': 0.0249, 'grad_norm': 0.062259285028491526, 'learning_rate': 5e-05, 'epoch': 22.6}
{'loss': 0.0248, 'grad_norm': 0.06594338103820158, 'learning_rate': 5e-05, 'epoch': 22.61}
{'loss': 0.0247, 'grad_norm': 0.05879621295913576, 'learning_rate': 5e-05, 'epoch': 22.62}
{'loss': 0.024, 'grad_norm': 0.10482657041660673, 'learning_rate': 5e-05, 'epoch': 22.64}
{'loss': 0.0244, 'grad_norm': 0.09573177473236112, 'learning_rate': 5e-05, 'epoch': 22.65}
{'loss': 0.025, 'grad_norm': 0.11023832097821097, 'learning_rate': 5e-05, 'epoch': 22.66}
{'loss': 0.0248, 'grad_norm': 0.06205280699888813, 'learning_rate': 5e-05, 'epoch': 22.68}
{'loss': 0.0245, 'grad_norm': 0.1488059202535596, 'learning_rate': 5e-05, 'epoch': 22.69}
{'loss': 0.0238, 'grad_norm': 0.052360431838348015, 'learning_rate': 5e-05, 'epoch': 22.7}
{'loss': 0.025, 'grad_norm': 0.08741134458686113, 'learning_rate': 5e-05, 'epoch': 22.72}
{'loss': 0.0249, 'grad_norm': 0.11734673489915295, 'learning_rate': 5e-05, 'epoch': 22.73}
{'loss': 0.0243, 'grad_norm': 0.07932451698918538, 'learning_rate': 5e-05, 'epoch': 22.74}
{'loss': 0.0245, 'grad_norm': 0.09178643471617724, 'learning_rate': 5e-05, 'epoch': 22.76}
{'loss': 0.0241, 'grad_norm': 0.17480805995820708, 'learning_rate': 5e-05, 'epoch': 22.77}
{'loss': 0.0242, 'grad_norm': 0.06669885668788958, 'learning_rate': 5e-05, 'epoch': 22.78}
{'loss': 0.0246, 'grad_norm': 0.1048727813910582, 'learning_rate': 5e-05, 'epoch': 22.8}
{'loss': 0.0244, 'grad_norm': 0.08304921688337738, 'learning_rate': 5e-05, 'epoch': 22.81}
{'loss': 0.0233, 'grad_norm': 0.07852627696189503, 'learning_rate': 5e-05, 'epoch': 22.82}
{'loss': 0.0247, 'grad_norm': 0.09574632253631578, 'learning_rate': 5e-05, 'epoch': 22.84}
{'loss': 0.0255, 'grad_norm': 0.057034018364434474, 'learning_rate': 5e-05, 'epoch': 22.85}
{'loss': 0.024, 'grad_norm': 0.08474863042417541, 'learning_rate': 5e-05, 'epoch': 22.86}
{'loss': 0.0245, 'grad_norm': 0.19993321078422754, 'learning_rate': 5e-05, 'epoch': 22.88}
{'loss': 0.0242, 'grad_norm': 0.06266758474959813, 'learning_rate': 5e-05, 'epoch': 22.89}
{'loss': 0.0252, 'grad_norm': 0.0987431928319524, 'learning_rate': 5e-05, 'epoch': 22.9}
{'loss': 0.0245, 'grad_norm': 0.09421158447030827, 'learning_rate': 5e-05, 'epoch': 22.92}
{'loss': 0.0245, 'grad_norm': 0.17931966865280038, 'learning_rate': 5e-05, 'epoch': 22.93}
{'loss': 0.0243, 'grad_norm': 0.08673243618696433, 'learning_rate': 5e-05, 'epoch': 22.95}
{'loss': 0.0235, 'grad_norm': 0.09822725254545538, 'learning_rate': 5e-05, 'epoch': 22.96}
{'loss': 0.0251, 'grad_norm': 0.11301020967490526, 'learning_rate': 5e-05, 'epoch': 22.97}
{'loss': 0.0247, 'grad_norm': 0.058427903785440834, 'learning_rate': 5e-05, 'epoch': 22.99}
{'loss': 0.025, 'grad_norm': 0.12493309823459656, 'learning_rate': 5e-05, 'epoch': 23.0}
 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 17181/17928 [8:15:22<13:08,  1.06s/it][INFO|gner_trainer.py:60] 2024-11-20 03:37:10,366 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 03:37:10,366 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 03:37:10,366 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3662.38it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3664.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3691.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3669.68it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3532.29it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3587.33it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3621.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4095.20it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4096.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3607.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4113.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4098.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4070.19it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4068.65it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4059.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1405.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1411.01it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4035.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1405.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1421.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1405.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1401.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.86it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1110.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1101.52it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1376.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1102.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1106.44it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1096.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1086.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 977.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 968.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 964.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 963.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 954.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 950.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 947.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1096.53it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1074.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.13it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.17it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1082.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1084.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 533.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 540.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 529.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 536.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.70it/s]
{'eval_mit-movie_precision': 0.5892391561981373, 'eval_mit-movie_recall': 0.46563026784041084, 'eval_mit-movie_f1': 0.5201925088437495, 'eval_mit-restaurant_precision': 0.5317725752508065, 'eval_mit-restaurant_recall': 0.3028571428571332, 'eval_mit-restaurant_f1': 0.38592233005083304, 'eval_crossner_ai_precision': 0.4660056657223576, 'eval_crossner_ai_recall': 0.6141879278157676, 'eval_crossner_ai_f1': 0.5299328858569526, 'eval_crossner_literature_precision': 0.5189289012003454, 'eval_crossner_literature_recall': 0.5671039354187403, 'eval_crossner_literature_f1': 0.5419479266617405, 'eval_crossner_music_precision': 0.6555882352940984, 'eval_crossner_music_recall': 0.7135083226632294, 'eval_crossner_music_f1': 0.6833231146036552, 'eval_crossner_politics_precision': 0.5686096620548748, 'eval_crossner_politics_recall': 0.6428205128204963, 'eval_crossner_politics_f1': 0.603442050738475, 'eval_crossner_science_precision': 0.5775889203651061, 'eval_crossner_science_recall': 0.7252964426877183, 'eval_crossner_science_f1': 0.6430699140911492, 'eval_wiki_passage_from_zero_precision': 0.8644896239334228, 'eval_wiki_passage_from_zero_recall': 0.8223046092184352, 'eval_wiki_passage_from_zero_f1': 0.8428696142878306, 'eval_average_f1': 0.5938375431417982, 'eval_runtime': 477.7264, 'eval_samples_per_second': 28.638, 'eval_steps_per_second': 0.113, 'epoch': 23.0}
 96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 17181/17928 [8:23:20<13:08,  1.06s/it]
[INFO|trainer.py:3812] 2024-11-20 03:45:08,857 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-17181
[INFO|configuration_utils.py:414] 2024-11-20 03:45:08,859 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17181/config.json
[INFO|configuration_utils.py:865] 2024-11-20 03:45:08,859 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17181/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 03:45:09,743 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-17181/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 03:45:09,745 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-17181/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 03:45:09,745 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-17181/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 03:45:09,746 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-17181/spiece.model
[2024-11-20 03:45:09,768] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step17181 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 03:45:09,780] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/mp_rank_00_model_states.pt
[2024-11-20 03:45:09,780] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/mp_rank_00_model_states.pt...
[2024-11-20 03:45:10,633] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/mp_rank_00_model_states.pt.
[2024-11-20 03:45:10,635] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 03:45:11,402] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 03:45:11,402] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-17181/global_step17181/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 03:45:11,402] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step17181 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0246, 'grad_norm': 0.07889906253278159, 'learning_rate': 5e-05, 'epoch': 23.01}
{'loss': 0.0239, 'grad_norm': 0.1640363797330287, 'learning_rate': 5e-05, 'epoch': 23.03}
{'loss': 0.0253, 'grad_norm': 0.09454719038623714, 'learning_rate': 5e-05, 'epoch': 23.04}
{'loss': 0.0247, 'grad_norm': 0.07642333998023727, 'learning_rate': 5e-05, 'epoch': 23.05}
{'loss': 0.0252, 'grad_norm': 0.04715774861770615, 'learning_rate': 5e-05, 'epoch': 23.07}
{'loss': 0.0254, 'grad_norm': 0.08403366882266108, 'learning_rate': 5e-05, 'epoch': 23.08}
{'loss': 0.0252, 'grad_norm': 0.07435804083052698, 'learning_rate': 5e-05, 'epoch': 23.09}
{'loss': 0.0243, 'grad_norm': 0.09956807327446407, 'learning_rate': 5e-05, 'epoch': 23.11}
{'loss': 0.0244, 'grad_norm': 0.07420724227432694, 'learning_rate': 5e-05, 'epoch': 23.12}
{'loss': 0.0243, 'grad_norm': 0.07525125503325147, 'learning_rate': 5e-05, 'epoch': 23.13}
{'loss': 0.0243, 'grad_norm': 0.06342259460368971, 'learning_rate': 5e-05, 'epoch': 23.15}
{'loss': 0.0246, 'grad_norm': 0.06672897875767608, 'learning_rate': 5e-05, 'epoch': 23.16}
{'loss': 0.025, 'grad_norm': 0.11817037549770433, 'learning_rate': 5e-05, 'epoch': 23.17}
{'loss': 0.0247, 'grad_norm': 0.12258747793927544, 'learning_rate': 5e-05, 'epoch': 23.19}
{'loss': 0.0242, 'grad_norm': 0.07725453626020218, 'learning_rate': 5e-05, 'epoch': 23.2}
{'loss': 0.0239, 'grad_norm': 0.05880357208400273, 'learning_rate': 5e-05, 'epoch': 23.21}
{'loss': 0.0245, 'grad_norm': 0.10162652271908268, 'learning_rate': 5e-05, 'epoch': 23.23}
{'loss': 0.0243, 'grad_norm': 0.11152865102042601, 'learning_rate': 5e-05, 'epoch': 23.24}
{'loss': 0.0242, 'grad_norm': 0.1266062398962776, 'learning_rate': 5e-05, 'epoch': 23.25}
{'loss': 0.025, 'grad_norm': 0.05020272853260227, 'learning_rate': 5e-05, 'epoch': 23.27}
{'loss': 0.024, 'grad_norm': 0.0827735990574022, 'learning_rate': 5e-05, 'epoch': 23.28}
{'loss': 0.0252, 'grad_norm': 0.08229157602731726, 'learning_rate': 5e-05, 'epoch': 23.29}
{'loss': 0.0239, 'grad_norm': 0.1948998383352305, 'learning_rate': 5e-05, 'epoch': 23.31}
{'loss': 0.0243, 'grad_norm': 0.0917495138671272, 'learning_rate': 5e-05, 'epoch': 23.32}
{'loss': 0.025, 'grad_norm': 0.2495815455604064, 'learning_rate': 5e-05, 'epoch': 23.33}
{'loss': 0.0237, 'grad_norm': 0.0836666050399136, 'learning_rate': 5e-05, 'epoch': 23.35}
{'loss': 0.0246, 'grad_norm': 0.09657684790546522, 'learning_rate': 5e-05, 'epoch': 23.36}
{'loss': 0.0242, 'grad_norm': 0.071543936851756, 'learning_rate': 5e-05, 'epoch': 23.37}
{'loss': 0.0238, 'grad_norm': 0.08294236744771201, 'learning_rate': 5e-05, 'epoch': 23.39}
{'loss': 0.0249, 'grad_norm': 0.07290282785131971, 'learning_rate': 5e-05, 'epoch': 23.4}
{'loss': 0.0239, 'grad_norm': 0.0922723085048377, 'learning_rate': 5e-05, 'epoch': 23.41}
{'loss': 0.0247, 'grad_norm': 0.06481567200041534, 'learning_rate': 5e-05, 'epoch': 23.43}
{'loss': 0.0243, 'grad_norm': 0.07160445560743496, 'learning_rate': 5e-05, 'epoch': 23.44}
{'loss': 0.0245, 'grad_norm': 0.07739215393431506, 'learning_rate': 5e-05, 'epoch': 23.45}
{'loss': 0.0245, 'grad_norm': 0.09240904570669822, 'learning_rate': 5e-05, 'epoch': 23.47}
{'loss': 0.0248, 'grad_norm': 0.07439071096144102, 'learning_rate': 5e-05, 'epoch': 23.48}
{'loss': 0.0247, 'grad_norm': 0.0802433559689941, 'learning_rate': 5e-05, 'epoch': 23.49}
{'loss': 0.0242, 'grad_norm': 0.08511992355595474, 'learning_rate': 5e-05, 'epoch': 23.51}
{'loss': 0.024, 'grad_norm': 0.08704937624123793, 'learning_rate': 5e-05, 'epoch': 23.52}
{'loss': 0.0248, 'grad_norm': 0.08362797310648125, 'learning_rate': 5e-05, 'epoch': 23.53}
{'loss': 0.0247, 'grad_norm': 0.08759260779710212, 'learning_rate': 5e-05, 'epoch': 23.55}
{'loss': 0.0241, 'grad_norm': 0.06537411593018129, 'learning_rate': 5e-05, 'epoch': 23.56}
{'loss': 0.024, 'grad_norm': 0.0892092858754676, 'learning_rate': 5e-05, 'epoch': 23.57}
{'loss': 0.0247, 'grad_norm': 0.06584338808096012, 'learning_rate': 5e-05, 'epoch': 23.59}
{'loss': 0.0242, 'grad_norm': 0.09837075157819483, 'learning_rate': 5e-05, 'epoch': 23.6}
{'loss': 0.0246, 'grad_norm': 0.06951202276752355, 'learning_rate': 5e-05, 'epoch': 23.61}
{'loss': 0.0242, 'grad_norm': 0.07051664096371725, 'learning_rate': 5e-05, 'epoch': 23.63}
{'loss': 0.0244, 'grad_norm': 0.0967117747609479, 'learning_rate': 5e-05, 'epoch': 23.64}
{'loss': 0.024, 'grad_norm': 0.09251459050127639, 'learning_rate': 5e-05, 'epoch': 23.65}
{'loss': 0.0232, 'grad_norm': 0.16103904770312674, 'learning_rate': 5e-05, 'epoch': 23.67}
{'loss': 0.0249, 'grad_norm': 0.10887955526557372, 'learning_rate': 5e-05, 'epoch': 23.68}
{'loss': 0.0249, 'grad_norm': 0.06939445631955646, 'learning_rate': 5e-05, 'epoch': 23.69}
{'loss': 0.0243, 'grad_norm': 0.05513305191078871, 'learning_rate': 5e-05, 'epoch': 23.71}
{'loss': 0.0241, 'grad_norm': 0.05777631824357802, 'learning_rate': 5e-05, 'epoch': 23.72}
{'loss': 0.0242, 'grad_norm': 0.0893331249629993, 'learning_rate': 5e-05, 'epoch': 23.73}
{'loss': 0.025, 'grad_norm': 0.06638150946370942, 'learning_rate': 5e-05, 'epoch': 23.75}
{'loss': 0.0245, 'grad_norm': 0.07167918766377564, 'learning_rate': 5e-05, 'epoch': 23.76}
{'loss': 0.0245, 'grad_norm': 0.08340755307857962, 'learning_rate': 5e-05, 'epoch': 23.78}
{'loss': 0.0241, 'grad_norm': 0.1253384092234991, 'learning_rate': 5e-05, 'epoch': 23.79}
{'loss': 0.025, 'grad_norm': 0.0753268694969824, 'learning_rate': 5e-05, 'epoch': 23.8}
{'loss': 0.0243, 'grad_norm': 0.06051053410154124, 'learning_rate': 5e-05, 'epoch': 23.82}
{'loss': 0.0249, 'grad_norm': 0.07789923412281796, 'learning_rate': 5e-05, 'epoch': 23.83}
{'loss': 0.0246, 'grad_norm': 0.15592773702213755, 'learning_rate': 5e-05, 'epoch': 23.84}
{'loss': 0.0247, 'grad_norm': 0.10604756965426554, 'learning_rate': 5e-05, 'epoch': 23.86}
{'loss': 0.0241, 'grad_norm': 0.11305920444681163, 'learning_rate': 5e-05, 'epoch': 23.87}
{'loss': 0.0244, 'grad_norm': 0.08717963812616684, 'learning_rate': 5e-05, 'epoch': 23.88}
{'loss': 0.0244, 'grad_norm': 0.09531469733410036, 'learning_rate': 5e-05, 'epoch': 23.9}
{'loss': 0.0236, 'grad_norm': 0.08340524449140758, 'learning_rate': 5e-05, 'epoch': 23.91}
{'loss': 0.025, 'grad_norm': 0.061210447366038735, 'learning_rate': 5e-05, 'epoch': 23.92}
{'loss': 0.0245, 'grad_norm': 0.0927667515001847, 'learning_rate': 5e-05, 'epoch': 23.94}
{'loss': 0.0248, 'grad_norm': 0.04514313453311938, 'learning_rate': 5e-05, 'epoch': 23.95}
{'loss': 0.0243, 'grad_norm': 0.12252398302360212, 'learning_rate': 5e-05, 'epoch': 23.96}
{'loss': 0.0249, 'grad_norm': 0.12874681554485673, 'learning_rate': 5e-05, 'epoch': 23.98}
{'loss': 0.0236, 'grad_norm': 0.0760760468690572, 'learning_rate': 5e-05, 'epoch': 23.99}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17928/17928 [8:36:47<00:00,  1.13s/it][INFO|trainer.py:3812] 2024-11-20 03:58:35,867 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-17928
[INFO|configuration_utils.py:414] 2024-11-20 03:58:35,869 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17928/config.json
[INFO|configuration_utils.py:865] 2024-11-20 03:58:35,869 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17928/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 03:58:36,782 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-17928/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 03:58:36,784 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-17928/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 03:58:36,784 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-17928/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 03:58:36,785 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-17928/spiece.model
[2024-11-20 03:58:36,808] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step17928 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 03:58:36,814] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt
[2024-11-20 03:58:36,814] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt...
[2024-11-20 03:58:37,699] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt.
[2024-11-20 03:58:37,701] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 03:58:38,555] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 03:58:38,556] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 03:58:38,556] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step17928 is ready now!
[INFO|gner_trainer.py:60] 2024-11-20 03:58:38,606 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 03:58:38,606 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 03:58:38,606 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3661.69it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3652.13it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3659.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.15it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3618.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3580.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3654.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3608.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4105.37it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4074.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4099.43it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4085.22it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4034.09it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4057.63it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4105.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4032.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1397.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1409.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1407.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1369.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1402.72it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1408.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1389.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1097.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1103.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1101.42it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1091.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1104.46it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 975.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 974.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 980.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 964.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 962.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 950.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 955.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1098.09it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 545.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 544.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 542.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 544.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 541.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 538.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 539.59it/s]
{'eval_mit-movie_precision': 0.5790804597701016, 'eval_mit-movie_recall': 0.47181120059935433, 'eval_mit-movie_f1': 0.519971101199349, 'eval_mit-restaurant_precision': 0.5334057577403295, 'eval_mit-restaurant_recall': 0.31174603174602183, 'eval_mit-restaurant_f1': 0.39350831492036403, 'eval_crossner_ai_precision': 0.4694923148579194, 'eval_crossner_ai_recall': 0.6272557560671669, 'eval_crossner_ai_f1': 0.5370271709685871, 'eval_crossner_literature_precision': 0.5260969976905069, 'eval_crossner_literature_recall': 0.5746720484358943, 'eval_crossner_literature_f1': 0.5493127561593789, 'eval_crossner_music_precision': 0.6638855780691101, 'eval_crossner_music_recall': 0.7131882202304509, 'eval_crossner_music_f1': 0.6876543209376972, 'eval_crossner_politics_precision': 0.5719139297848115, 'eval_crossner_politics_recall': 0.6474358974358808, 'eval_crossner_politics_f1': 0.6073361394570924, 'eval_crossner_science_precision': 0.5790951638065341, 'eval_crossner_science_recall': 0.733596837944635, 'eval_crossner_science_f1': 0.6472537052688915, 'eval_wiki_passage_from_zero_precision': 0.8517125807242687, 'eval_wiki_passage_from_zero_recall': 0.8351903807615213, 'eval_wiki_passage_from_zero_f1': 0.8433705681870113, 'eval_average_f1': 0.5981792596372965, 'eval_runtime': 486.5052, 'eval_samples_per_second': 28.121, 'eval_steps_per_second': 0.111, 'epoch': 24.0}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17928/17928 [8:44:57<00:00,  1.13s/it]
[INFO|trainer.py:3812] 2024-11-20 04:06:45,705 >> Saving model checkpoint to output/flan-t5-base-concept-learning/checkpoint-17928
[INFO|configuration_utils.py:414] 2024-11-20 04:06:45,707 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17928/config.json
[INFO|configuration_utils.py:865] 2024-11-20 04:06:45,707 >> Configuration saved in output/flan-t5-base-concept-learning/checkpoint-17928/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 04:06:46,573 >> Model weights saved in output/flan-t5-base-concept-learning/checkpoint-17928/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 04:06:46,575 >> tokenizer config file saved in output/flan-t5-base-concept-learning/checkpoint-17928/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 04:06:46,575 >> Special tokens file saved in output/flan-t5-base-concept-learning/checkpoint-17928/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 04:06:46,577 >> Copy vocab file to output/flan-t5-base-concept-learning/checkpoint-17928/spiece.model
[2024-11-20 04:06:46,596] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step17928 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-20 04:06:46,602] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt
[2024-11-20 04:06:46,602] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt...
[2024-11-20 04:06:47,432] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt.
[2024-11-20 04:06:47,434] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 04:06:48,245] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 04:06:48,245] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-20 04:06:48,245] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step17928 is ready now!
[INFO|trainer.py:2591] 2024-11-20 04:06:48,311 >>

Training completed. Do not forget to share your model on huggingface.co/models =)


[INFO|trainer.py:2829] 2024-11-20 04:06:48,311 >> Loading best model from output/flan-t5-base-concept-learning/checkpoint-17928 (score: 0.5981792596372965).
[INFO|deepspeed.py:436] 2024-11-20 04:06:48,311 >> Attempting to resume from output/flan-t5-base-concept-learning/checkpoint-17928
[2024-11-20 04:06:48,312] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt...
[2024-11-20 04:06:48,616] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt.
[2024-11-20 04:06:48,657] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt...
[2024-11-20 04:06:48,877] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/mp_rank_00_model_states.pt.
[2024-11-20 04:06:48,981] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-20 04:06:49,127] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-concept-learning/checkpoint-17928/global_step17928/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-20 04:06:49,127] [INFO] [engine.py:3019:_get_all_zero_checkpoint_state_dicts] successfully read 8 ZeRO state_dicts for rank 0
[2024-11-20 04:06:49,159] [INFO] [engine.py:2951:_load_zero_checkpoint] loading 8 zero partition checkpoints for rank 0
{'train_runtime': 31501.4814, 'train_samples_per_second': 145.66, 'train_steps_per_second': 0.569, 'train_loss': 0.03293765032732928, 'epoch': 24.0}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17928/17928 [8:45:01<00:00,  1.76s/it]
[INFO|trainer.py:3812] 2024-11-20 04:06:49,536 >> Saving model checkpoint to output/flan-t5-base-concept-learning
[INFO|configuration_utils.py:414] 2024-11-20 04:06:49,538 >> Configuration saved in output/flan-t5-base-concept-learning/config.json
[INFO|configuration_utils.py:865] 2024-11-20 04:06:49,538 >> Configuration saved in output/flan-t5-base-concept-learning/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-20 04:06:50,200 >> Model weights saved in output/flan-t5-base-concept-learning/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-20 04:06:50,202 >> tokenizer config file saved in output/flan-t5-base-concept-learning/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-20 04:06:50,202 >> Special tokens file saved in output/flan-t5-base-concept-learning/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-20 04:06:50,203 >> Copy vocab file to output/flan-t5-base-concept-learning/spiece.model
***** train metrics *****
  epoch                    =         24.0
  total_flos               = 2345959442GF
  train_loss               =       0.0329
  train_runtime            =   8:45:01.48
  train_samples            =       191188
  train_samples_per_second =       145.66
  train_steps_per_second   =        0.569
11/20/2024 04:06:50 - INFO - __main__ - Metrics {'train_runtime': 31501.4814, 'train_samples_per_second': 145.66, 'train_steps_per_second': 0.569, 'total_flos': 2.518954770484429e+18, 'train_loss': 0.03293765032732928, 'epoch': 24.0, 'train_samples': 191188}
11/20/2024 04:06:50 - INFO - __main__ - *** Evaluate ***
[INFO|gner_trainer.py:60] 2024-11-20 04:06:50,257 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-20 04:06:50,257 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 04:06:50,257 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3706.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3648.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3653.23it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3608.31it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3635.74it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3641.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3630.63it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3610.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4144.46it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4084.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4071.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4017.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4043.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4050.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4045.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1413.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1415.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 3971.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1400.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1395.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1356.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1399.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1390.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1407.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1109.75it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1105.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1093.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1087.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1095.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.09it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1076.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 988.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 984.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 971.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 976.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 970.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 978.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 964.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 964.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 959.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 950.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 956.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1102.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1103.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1099.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1087.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1093.13it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1092.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 535.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 537.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 530.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 531.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.90it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [08:06<00:00,  9.01s/it]
***** eval metrics *****
  epoch                                 =       24.0
  eval_average_f1                       =     0.5982
  eval_crossner_ai_f1                   =      0.537
  eval_crossner_ai_precision            =     0.4695
  eval_crossner_ai_recall               =     0.6273
  eval_crossner_literature_f1           =     0.5493
  eval_crossner_literature_precision    =     0.5261
  eval_crossner_literature_recall       =     0.5747
  eval_crossner_music_f1                =     0.6877
  eval_crossner_music_precision         =     0.6639
  eval_crossner_music_recall            =     0.7132
  eval_crossner_politics_f1             =     0.6073
  eval_crossner_politics_precision      =     0.5719
  eval_crossner_politics_recall         =     0.6474
  eval_crossner_science_f1              =     0.6473
  eval_crossner_science_precision       =     0.5791
  eval_crossner_science_recall          =     0.7336
  eval_mit-movie_f1                     =       0.52
  eval_mit-movie_precision              =     0.5791
  eval_mit-movie_recall                 =     0.4718
  eval_mit-restaurant_f1                =     0.3935
  eval_mit-restaurant_precision         =     0.5334
  eval_mit-restaurant_recall            =     0.3117
  eval_runtime                          = 0:08:07.70
  eval_samples                          =      13681
  eval_samples_per_second               =     28.052
  eval_steps_per_second                 =      0.111
  eval_wiki_passage_from_zero_f1        =     0.8434
  eval_wiki_passage_from_zero_precision =     0.8517
  eval_wiki_passage_from_zero_recall    =     0.8352
11/20/2024 04:14:57 - INFO - __main__ - *** Predict ***
[INFO|gner_trainer.py:60] 2024-11-20 04:14:57,960 >> ***** Running Prediction *****
[INFO|gner_trainer.py:62] 2024-11-20 04:14:57,960 >>   Num examples = 13681
[INFO|gner_trainer.py:65] 2024-11-20 04:14:57,960 >>   Batch size = 32
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3677.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3611.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3599.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3631.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3454.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3655.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.01it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4113.54it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4025.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3442.41it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1428.27it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4015.70it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4061.99it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4053.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4070.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4047.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4078.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1396.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1386.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1384.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1404.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1403.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1107.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.47it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1384.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1090.93it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1102.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1100.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 986.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 969.20it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1071.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 973.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 984.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 972.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 959.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 967.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 953.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 943.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 965.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 960.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1103.13it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 951.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1089.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1101.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1088.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1086.64it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1095.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1090.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 532.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 543.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 527.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 538.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 526.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7211/7211 [00:13<00:00, 525.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [08:05<00:00,  8.99s/it]
***** predict metrics *****
  predict_average_f1                       =     0.5982
  predict_crossner_ai_f1                   =      0.537
  predict_crossner_ai_precision            =     0.4695
  predict_crossner_ai_recall               =     0.6273
  predict_crossner_literature_f1           =     0.5493
  predict_crossner_literature_precision    =     0.5261
  predict_crossner_literature_recall       =     0.5747
  predict_crossner_music_f1                =     0.6877
  predict_crossner_music_precision         =     0.6639
  predict_crossner_music_recall            =     0.7132
  predict_crossner_politics_f1             =     0.6073
  predict_crossner_politics_precision      =     0.5719
  predict_crossner_politics_recall         =     0.6474
  predict_crossner_science_f1              =     0.6473
  predict_crossner_science_precision       =     0.5791
  predict_crossner_science_recall          =     0.7336
  predict_mit-movie_f1                     =       0.52
  predict_mit-movie_precision              =     0.5791
  predict_mit-movie_recall                 =     0.4718
  predict_mit-restaurant_f1                =     0.3935
  predict_mit-restaurant_precision         =     0.5334
  predict_mit-restaurant_recall            =     0.3117
  predict_runtime                          = 0:08:06.97
  predict_samples                          =      13681
  predict_samples_per_second               =     28.094
  predict_steps_per_second                 =      0.111
  predict_wiki_passage_from_zero_f1        =     0.8434
  predict_wiki_passage_from_zero_precision =     0.8517
  predict_wiki_passage_from_zero_recall    =     0.8352
[2024-11-20 04:23:07,562] [INFO] [launch.py:347:main] Process 2961290 exits successfully.
[2024-11-20 04:23:07,562] [INFO] [launch.py:347:main] Process 2961295 exits successfully.
[2024-11-20 04:23:07,562] [INFO] [launch.py:347:main] Process 2961291 exits successfully.
[2024-11-20 04:23:08,562] [INFO] [launch.py:347:main] Process 2961288 exits successfully.
[2024-11-20 04:23:08,562] [INFO] [launch.py:347:main] Process 2961292 exits successfully.
[2024-11-20 04:23:08,563] [INFO] [launch.py:347:main] Process 2961289 exits successfully.
[2024-11-20 04:23:08,563] [INFO] [launch.py:347:main] Process 2961293 exits successfully.
[2024-11-20 04:23:08,563] [INFO] [launch.py:347:main] Process 2961294 exits successfully.
(GNER) chrisjihee@dgx-a100:~/proj/GNER$

