(GNER) chrisjihee@dgx-a100:~/proj/GNER$ bash scripts/train_t5_base_task_adaptation.sh
++ shuf -i25000-30000 -n1
+ port=26701
+ TRAIN_JSON_DIR=data/pile-ner.jsonl
+ DATA_DIR=data
+ DATA_CONFIG_DIR=configs/dataset_configs/task_adaptation_configs
+ INSTRUCTION_FILE=configs/instruction_configs/instruction.json
+ DEEPSPEED_CONFIG=configs/deepspeed_configs/deepspeed_zero0_t5.json
+ MODEL_NAME_OR_PATH=google/flan-t5-base
+ OUTPUT_DIR=output/flan-t5-base-task-adaptation
+ RUN_NAME=flan-t5-base-experiment
+ deepspeed --include=localhost:0,1,2,3,4,5,6,7 --master_port 26701 src/run.py --do_train --do_predict --predict_with_generate --model_name_or_path google/flan-t5-base --train_json_dir data/pile-ner.jsonl --data_dir data --data_config_dir configs/dataset_configs/task_adaptation_configs --instruction_file configs/instruction_configs/instruction.json --output_dir output/flan-t5-base-task-adaptation --run_name flan-t5-base-experiment --preprocessing_num_workers 4 --per_device_eval_batch_size 32 --per_device_train_batch_size 32 --gradient_accumulation_steps 1 --gradient_checkpointing True --bf16 True --tf32 True --lr_scheduler_type constant --learning_rate 5e-05 --warmup_steps 0 --num_train_epochs 12 --max_source_length 640 --max_target_length 640 --generation_max_length 640 --logging_strategy steps --logging_steps 10 --save_strategy epoch --eval_strategy epoch --overwrite_output_dir --overwrite_cache --load_best_model_at_end True --metric_for_best_model eval_average_f1 --greater_is_better True --seed 1234 --deepspeed configs/deepspeed_configs/deepspeed_zero0_t5.json
[2024-11-19 17:03:23,939] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:28,233] [WARNING] [runner.py:202:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2024-11-19 17:03:30,430] [INFO] [runner.py:568:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python3.11 -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgMywgNCwgNSwgNiwgN119 --master_addr=127.0.0.1 --master_port=26701 --enable_each_rank_log=None src/run.py --do_train --do_predict --predict_with_generate --model_name_or_path google/flan-t5-base --train_json_dir data/pile-ner.jsonl --data_dir data --data_config_dir configs/dataset_configs/task_adaptation_configs --instruction_file configs/instruction_configs/instruction.json --output_dir output/flan-t5-base-task-adaptation --run_name flan-t5-base-experiment --preprocessing_num_workers 4 --per_device_eval_batch_size 32 --per_device_train_batch_size 32 --gradient_accumulation_steps 1 --gradient_checkpointing True --bf16 True --tf32 True --lr_scheduler_type constant --learning_rate 5e-05 --warmup_steps 0 --num_train_epochs 12 --max_source_length 640 --max_target_length 640 --generation_max_length 640 --logging_strategy steps --logging_steps 10 --save_strategy epoch --eval_strategy epoch --overwrite_output_dir --overwrite_cache --load_best_model_at_end True --metric_for_best_model eval_average_f1 --greater_is_better True --seed 1234 --deepspeed configs/deepspeed_configs/deepspeed_zero0_t5.json
[2024-11-19 17:03:33,572] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:37,655] [INFO] [launch.py:145:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]}
[2024-11-19 17:03:37,655] [INFO] [launch.py:151:main] nnodes=1, num_local_procs=8, node_rank=0
[2024-11-19 17:03:37,655] [INFO] [launch.py:162:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3, 4, 5, 6, 7]})
[2024-11-19 17:03:37,655] [INFO] [launch.py:163:main] dist_world_size=8
[2024-11-19 17:03:37,655] [INFO] [launch.py:165:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3,4,5,6,7
[2024-11-19 17:03:48,025] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:48,204] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,015] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,147] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,173] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,175] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,180] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,182] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,196] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,196] [INFO] [comm.py:668:init_distributed] Initializing TorchBackend in DeepSpeed with backend nccl
[2024-11-19 17:03:51,228] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2024-11-19 17:03:51,321] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,347] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,352] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,354] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,358] [INFO] [comm.py:637:init_distributed] cdb=None
[2024-11-19 17:03:51,398] [INFO] [comm.py:637:init_distributed] cdb=None
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 2, device: cuda:2, n_gpu: 1, distributed training: True, 16-bits training: True
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 1, device: cuda:1, n_gpu: 1, distributed training: True, 16-bits training: True
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 5, device: cuda:5, n_gpu: 1, distributed training: True, 16-bits training: True
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 6, device: cuda:6, n_gpu: 1, distributed training: True, 16-bits training: True
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 3, device: cuda:3, n_gpu: 1, distributed training: True, 16-bits training: True
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 4, device: cuda:4, n_gpu: 1, distributed training: True, 16-bits training: True
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 7, device: cuda:7, n_gpu: 1, distributed training: True, 16-bits training: True
Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
11/19/2024 17:03:54 - WARNING - __main__ - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: True, 16-bits training: True
11/19/2024 17:03:54 - INFO - __main__ - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
accelerator_config={'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False},
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
average_tokens_across_devices=False,
batch_eval_metrics=False,
bf16=True,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=None,
ddp_timeout=1800,
debug=[],
deepspeed=configs/deepspeed_configs/deepspeed_zero0_t5.json,
disable_tqdm=False,
dispatch_batches=None,
do_eval=True,
do_predict=True,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_do_concat_batches=True,
eval_on_start=False,
eval_steps=None,
eval_strategy=IntervalStrategy.EPOCH,
eval_use_gather_object=False,
evaluation_strategy=None,
fp16=False,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=640,
generation_num_beams=None,
gradient_accumulation_steps=1,
gradient_checkpointing=True,
gradient_checkpointing_kwargs=None,
greater_is_better=True,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_for_metrics=[],
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=True,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=output/flan-t5-base-task-adaptation/runs/Nov19_17-03-40_dgx-a100,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.CONSTANT,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=eval_average_f1,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=12.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
optim_target_modules=None,
output_dir=output/flan-t5-base-task-adaptation,
overwrite_output_dir=True,
past_index=-1,
per_device_eval_batch_size=32,
per_device_train_batch_size=32,
predict_with_generate=True,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
restore_callback_states_from_checkpoint=False,
resume_from_checkpoint=None,
run_name=flan-t5-base-experiment,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=500,
save_strategy=IntervalStrategy.EPOCH,
save_total_limit=None,
seed=1234,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=None,
tf32=True,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torch_empty_cache_steps=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_liger_kernel=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
Using custom data configuration default-e60fd0a2766fdda3
11/19/2024 17:03:54 - INFO - datasets.builder - Using custom data configuration default-e60fd0a2766fdda3
Loading Dataset Infos from /raid/chrisjihee/.cache/huggingface/modules/datasets_modules/datasets/gner_dataset/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
11/19/2024 17:03:54 - INFO - datasets.info - Loading Dataset Infos from /raid/chrisjihee/.cache/huggingface/modules/datasets_modules/datasets/gner_dataset/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
Overwrite dataset info from restored data version if exists.
11/19/2024 17:03:54 - INFO - datasets.builder - Overwrite dataset info from restored data version if exists.
Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
11/19/2024 17:03:54 - INFO - datasets.info - Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
Found cached dataset gner_dataset (/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410)
11/19/2024 17:03:54 - INFO - datasets.builder - Found cached dataset gner_dataset (/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410)
Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
11/19/2024 17:03:54 - INFO - datasets.info - Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
Listing files in /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
11/19/2024 17:03:54 - INFO - datasets.arrow_dataset - Listing files in /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
Listing files in /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
11/19/2024 17:03:54 - INFO - datasets.arrow_dataset - Listing files in /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410
[INFO|configuration_utils.py:679] 2024-11-19 17:03:55,104 >> loading configuration file config.json from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/config.json
[INFO|configuration_utils.py:746] 2024-11-19 17:03:55,108 >> Model config T5Config {
  "_name_or_path": "google/flan-t5-base",
  "architectures": [
    "T5ForConditionalGeneration"
  ],
  "classifier_dropout": 0.0,
  "d_ff": 2048,
  "d_kv": 64,
  "d_model": 768,
  "decoder_start_token_id": 0,
  "dense_act_fn": "gelu_new",
  "dropout_rate": 0.1,
  "eos_token_id": 1,
  "feed_forward_proj": "gated-gelu",
  "initializer_factor": 1.0,
  "is_encoder_decoder": true,
  "is_gated_act": true,
  "layer_norm_epsilon": 1e-06,
  "model_type": "t5",
  "n_positions": 512,
  "num_decoder_layers": 12,
  "num_heads": 12,
  "num_layers": 12,
  "output_past": true,
  "pad_token_id": 0,
  "relative_attention_max_distance": 128,
  "relative_attention_num_buckets": 32,
  "task_specific_params": {
    "summarization": {
      "early_stopping": true,
      "length_penalty": 2.0,
      "max_length": 200,
      "min_length": 30,
      "no_repeat_ngram_size": 3,
      "num_beams": 4,
      "prefix": "summarize: "
    },
    "translation_en_to_de": {
      "early_stopping": true,
      "max_length": 300,
      "num_beams": 4,
      "prefix": "translate English to German: "
    },
    "translation_en_to_fr": {
      "early_stopping": true,
      "max_length": 300,
      "num_beams": 4,
      "prefix": "translate English to French: "
    },
    "translation_en_to_ro": {
      "early_stopping": true,
      "max_length": 300,
      "num_beams": 4,
      "prefix": "translate English to Romanian: "
    }
  },
  "tie_word_embeddings": false,
  "transformers_version": "4.46.2",
  "use_cache": true,
  "vocab_size": 32128
}

[INFO|tokenization_utils_base.py:2211] 2024-11-19 17:03:55,317 >> loading file spiece.model from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/spiece.model
[INFO|tokenization_utils_base.py:2211] 2024-11-19 17:03:55,317 >> loading file tokenizer.json from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/tokenizer.json
[INFO|tokenization_utils_base.py:2211] 2024-11-19 17:03:55,317 >> loading file added_tokens.json from cache at None
[INFO|tokenization_utils_base.py:2211] 2024-11-19 17:03:55,317 >> loading file special_tokens_map.json from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/special_tokens_map.json
[INFO|tokenization_utils_base.py:2211] 2024-11-19 17:03:55,317 >> loading file tokenizer_config.json from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/tokenizer_config.json
[INFO|modeling_utils.py:3937] 2024-11-19 17:03:55,535 >> loading weights file model.safetensors from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/model.safetensors
[INFO|configuration_utils.py:1096] 2024-11-19 17:03:55,544 >> Generate config GenerationConfig {
  "decoder_start_token_id": 0,
  "eos_token_id": 1,
  "pad_token_id": 0
}

[INFO|modeling_utils.py:4800] 2024-11-19 17:03:55,950 >> All model checkpoint weights were used when initializing T5ForConditionalGeneration.

[INFO|modeling_utils.py:4808] 2024-11-19 17:03:55,951 >> All the weights of T5ForConditionalGeneration were initialized from the model checkpoint at google/flan-t5-base.
If your task is similar to the task the model of the checkpoint was trained on, you can already use T5ForConditionalGeneration for predictions without further training.
[INFO|configuration_utils.py:1051] 2024-11-19 17:03:56,159 >> loading configuration file generation_config.json from cache at /raid/chrisjihee/.cache/huggingface/hub/models--google--flan-t5-base/snapshots/7bcac572ce56db69c1ea7c8af255c5d7c9672fc2/generation_config.json
[INFO|configuration_utils.py:1096] 2024-11-19 17:03:56,159 >> Generate config GenerationConfig {
  "decoder_start_token_id": 0,
  "eos_token_id": 1,
  "pad_token_id": 0
}

Using custom data configuration default-a51e1f2848656e8c
11/19/2024 17:03:57 - INFO - datasets.builder - Using custom data configuration default-a51e1f2848656e8c
Loading Dataset Infos from /raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/datasets/packaged_modules/json
11/19/2024 17:03:57 - INFO - datasets.info - Loading Dataset Infos from /raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/datasets/packaged_modules/json
Overwrite dataset info from restored data version if exists.
11/19/2024 17:03:57 - INFO - datasets.builder - Overwrite dataset info from restored data version if exists.
Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092
11/19/2024 17:03:57 - INFO - datasets.info - Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092
Found cached dataset json (/raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092)
11/19/2024 17:03:57 - INFO - datasets.builder - Found cached dataset json (/raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092)
Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092
11/19/2024 17:03:57 - INFO - datasets.info - Loading Dataset info from /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092
11/19/2024 17:03:57 - INFO - __main__ - Use data/pile-ner.jsonl as train dataset, len(dataset) = 105659
11/19/2024 17:03:57 - INFO - __main__ - len(dataset) = 105659
Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00000_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00000_of_00004.arrow
Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00001_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00001_of_00004.arrow
Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00002_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00002_of_00004.arrow
Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00003_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00003_of_00004.arrow
Spawning 4 processes
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Spawning 4 processes
Running tokenizer on train dataset (num_proc=4):   0%|                                                                                                                                                                                     | 0/105659 [00:00<?, ? examples/s]Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00000_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00000_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00001_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00001_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00002_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00002_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00003_of_00004.arrow
11/19/2024 17:03:57 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/json/default-a51e1f2848656e8c/0.0.0/f4e89e8750d5d5ffbef2c078bf0ddfedef29dc2faff52a6255cf513c05eb1092/cache-973cf917dbac5db0_00003_of_00004.arrow
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:36<00:00, 2927.58 examples/s]
Concatenating 4 shards
11/19/2024 17:04:33 - INFO - datasets.arrow_dataset - Concatenating 4 shards
Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00000_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00000_of_00004.arrow
Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00001_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00001_of_00004.arrow
Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00002_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00002_of_00004.arrow
Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00003_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00003_of_00004.arrow
Running tokenizer on train dataset (num_proc=4):   0%|                                                                                                                                                                                     | 0/105659 [00:00<?, ? examples/s]Spawning 4 processes
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Spawning 4 processes
Running tokenizer on train dataset (num_proc=4):   0%|                                                                                                                                                                                     | 0/105659 [00:00<?, ? examples/s]Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00000_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00000_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00001_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00001_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00002_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00002_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00003_of_00004.arrow
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-ede5ff10c000c6bb_00003_of_00004.arrow
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 2325.25 examples/s]
Running tokenizer on train dataset (num_proc=4):   2%|██▋                                                                                                                                                                     | 1723/105659 [00:00<00:33, 3102.79 examples/s]Concatenating 4 shards
11/19/2024 17:04:46 - INFO - datasets.arrow_dataset - Concatenating 4 shards
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:35<00:00, 2951.99 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:36<00:00, 2924.97 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:36<00:00, 2859.23 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:36<00:00, 2858.49 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:37<00:00, 2847.23 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:37<00:00, 2812.12 examples/s]
Running tokenizer on train dataset (num_proc=4): 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 105659/105659 [00:37<00:00, 2790.28 examples/s]
Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00000_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Process #0 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00000_of_00004.arrow
Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00001_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Process #1 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00001_of_00004.arrow
Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00002_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Process #2 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00002_of_00004.arrow
Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00003_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Process #3 will write at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00003_of_00004.arrow
Running tokenizer on validation dataset (num_proc=4):   0%|                                                                                                                                                                                  | 0/1400 [00:00<?, ? examples/s]Spawning 4 processes
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Spawning 4 processes
Running tokenizer on validation dataset (num_proc=4):   0%|                                                                                                                                                                                  | 0/1400 [00:00<?, ? examples/s]Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00001_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00001_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00000_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00000_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00002_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00002_of_00004.arrow
Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00003_of_00004.arrow
11/19/2024 17:05:24 - INFO - datasets.arrow_dataset - Caching processed dataset at /raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-e60fd0a2766fdda3/0.0.0/1a385064d91da523d6ebc056370f48dda9560f716c15b7c15d602e18e9b48410/cache-0a84db555e18bd5b_00003_of_00004.arrow
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3404.98 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3347.56 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3365.08 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3240.96 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3251.57 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3239.64 examples/s]
Running tokenizer on validation dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1400/1400 [00:00<00:00, 3390.29 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 4423.95 examples/s]
Concatenating 4 shards
11/19/2024 17:05:25 - INFO - datasets.arrow_dataset - Concatenating 4 shards
[INFO|trainer.py:699] 2024-11-19 17:05:25,781 >> Using auto half precision backend
Running tokenizer on prediction dataset (num_proc=4):   2%|███▍                                                                                                                                                                  | 135/6470 [00:00<00:06, 1008.36 examples/s][2024-11-19 17:05:25,991] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed info: version=0.13.1, git-hash=unknown, git-branch=unknown
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 5560.33 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 5300.89 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 5295.38 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 5209.78 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 5132.01 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 4992.96 examples/s]
Running tokenizer on prediction dataset (num_proc=4): 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6470/6470 [00:01<00:00, 4946.84 examples/s]
[2024-11-19 17:05:45,608] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Flops Profiler Enabled: False
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /raid/chrisjihee/.cache/torch_extensions/py311_cu118/fused_adam/build.ninja...
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation.
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
ninja: no work to do.
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Loading extension module fused_adam...
Time to load fused_adam op: 0.06938457489013672 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Using /raid/chrisjihee/.cache/torch_extensions/py311_cu118 as PyTorch extensions root...
Detected CUDA files, patching ldflags
Emitting ninja build file /raid/chrisjihee/.cache/torch_extensions/py311_cu118/fused_adam/build.ninja...
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/utils/cpp_extension.py:1967: UserWarning: TORCH_CUDA_ARCH_LIST is not set, all archs for visible cards are included for compilation.
If this is not desired, please set os.environ['TORCH_CUDA_ARCH_LIST'].
  warnings.warn(
Building extension module fused_adam...
Allowing ninja to set a default number of workers... (overridable by setting the environment variable MAX_JOBS=N)
ninja: no work to do.
Loading extension module fused_adam...
Time to load fused_adam op: 0.07092595100402832 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.20157408714294434 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.2014005184173584 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Loading extension module fused_adam...
Time to load fused_adam op: 0.20165538787841797 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
[2024-11-19 17:05:46,146] [INFO] [logging.py:96:log_dist] [Rank 0] Using DeepSpeed Optimizer param name adamw as basic optimizer
[2024-11-19 17:05:46,146] [INFO] [logging.py:96:log_dist] [Rank 0] Removing param_group that has no 'params' in the basic Optimizer
Time to load fused_adam op: 0.2015390396118164 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
[2024-11-19 17:05:46,154] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Basic Optimizer = FusedAdam
[2024-11-19 17:05:46,154] [INFO] [logging.py:96:log_dist] [Rank 0] Creating BF16 optimizer
Loading extension module fused_adam...
Time to load fused_adam op: 0.20164012908935547 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
Loading extension module fused_adam...
Time to load fused_adam op: 0.20172810554504395 seconds
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/deepspeed/ops/adam/fused_adam.py:96: UserWarning: The torch.cuda.*DtypeTensor constructors are no longer recommended. It's best to use methods such as torch.tensor(data, dtype=*, device='cuda') to create tensors. (Triggered internally at ../torch/csrc/tensor/python_tensor.cpp:78.)
  self._dummy_overflow_buf = get_accelerator().IntTensor([0])
[2024-11-19 17:05:46,267] [INFO] [utils.py:791:see_memory_usage] begin bf16_optimizer
[2024-11-19 17:05:46,268] [INFO] [utils.py:792:see_memory_usage] MA 0.47 GB         Max_MA 0.47 GB         CA 0.49 GB         Max_CA 0 GB
[2024-11-19 17:05:46,268] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.02 GB, percent = 4.3%
[2024-11-19 17:05:46,382] [INFO] [utils.py:791:see_memory_usage] before initializing group 0
[2024-11-19 17:05:46,383] [INFO] [utils.py:792:see_memory_usage] MA 0.47 GB         Max_MA 0.47 GB         CA 0.49 GB         Max_CA 0 GB
[2024-11-19 17:05:46,383] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.02 GB, percent = 4.3%
[2024-11-19 17:05:47,880] [INFO] [utils.py:791:see_memory_usage] after initializing group 0
[2024-11-19 17:05:47,880] [INFO] [utils.py:792:see_memory_usage] MA 1.5 GB         Max_MA 1.5 GB         CA 2.05 GB         Max_CA 2 GB
[2024-11-19 17:05:47,880] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.15 GB, percent = 4.3%
[2024-11-19 17:05:47,996] [INFO] [utils.py:791:see_memory_usage] before initialize_optimizer
[2024-11-19 17:05:47,996] [INFO] [utils.py:792:see_memory_usage] MA 1.5 GB         Max_MA 1.5 GB         CA 2.05 GB         Max_CA 2 GB
[2024-11-19 17:05:47,996] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.4 GB, percent = 4.3%
[WARNING|logging.py:328] 2024-11-19 17:05:48,009 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[WARNING|logging.py:328] 2024-11-19 17:05:48,058 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[WARNING|logging.py:328] 2024-11-19 17:05:48,110 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[2024-11-19 17:05:48,123] [INFO] [utils.py:791:see_memory_usage] end initialize_optimizer
[2024-11-19 17:05:48,124] [INFO] [utils.py:792:see_memory_usage] MA 1.73 GB         Max_MA 1.73 GB         CA 2.28 GB         Max_CA 2 GB
[2024-11-19 17:05:48,124] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.8 GB, percent = 4.3%
[WARNING|logging.py:328] 2024-11-19 17:05:48,132 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[WARNING|logging.py:328] 2024-11-19 17:05:48,135 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[WARNING|logging.py:328] 2024-11-19 17:05:48,141 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[WARNING|logging.py:328] 2024-11-19 17:05:48,147 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
[2024-11-19 17:05:48,237] [INFO] [utils.py:791:see_memory_usage] end bf16_optimizer
[2024-11-19 17:05:48,238] [INFO] [utils.py:792:see_memory_usage] MA 1.73 GB         Max_MA 1.73 GB         CA 2.28 GB         Max_CA 2 GB
[2024-11-19 17:05:48,238] [INFO] [utils.py:799:see_memory_usage] CPU Virtual Memory:  used = 43.86 GB, percent = 4.4%
[2024-11-19 17:05:48,238] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed Final Optimizer = adamw
[2024-11-19 17:05:48,238] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed using configured LR scheduler = WarmupLR
[2024-11-19 17:05:48,238] [INFO] [logging.py:96:log_dist] [Rank 0] DeepSpeed LR Scheduler = <deepspeed.runtime.lr_schedules.WarmupLR object at 0x7fbddfc5f910>
[2024-11-19 17:05:48,238] [INFO] [logging.py:96:log_dist] [Rank 0] step=0, skipped=0, lr=[5e-05], mom=[[0.9, 0.999]]
[2024-11-19 17:05:48,239] [INFO] [config.py:984:print] DeepSpeedEngine configuration:
[2024-11-19 17:05:48,239] [INFO] [config.py:988:print]   activation_checkpointing_config  {
    "partition_activations": false,
    "contiguous_memory_optimization": false,
    "cpu_checkpointing": false,
    "number_checkpoints": null,
    "synchronize_checkpoint_boundary": false,
    "profile": false
}
[2024-11-19 17:05:48,239] [INFO] [config.py:988:print]   aio_config ................... {'block_size': 1048576, 'queue_depth': 8, 'thread_count': 1, 'single_submit': False, 'overlap_events': True}
[2024-11-19 17:05:48,239] [INFO] [config.py:988:print]   amp_enabled .................. False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   amp_params ................... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   autotuning_config ............ {
    "enabled": false,
    "start_step": null,
    "end_step": null,
    "metric_path": null,
    "arg_mappings": null,
    "metric": "throughput",
    "model_info": null,
    "results_dir": "autotuning_results",
    "exps_dir": "autotuning_exps",
    "overwrite": true,
    "fast": true,
    "start_profile_step": 3,
    "end_profile_step": 5,
    "tuner_type": "gridsearch",
    "tuner_early_stopping": 5,
    "tuner_num_trials": 50,
    "model_info_path": null,
    "mp_size": 1,
    "max_train_batch_size": null,
    "min_train_batch_size": 1,
    "max_train_micro_batch_size_per_gpu": 1.024000e+03,
    "min_train_micro_batch_size_per_gpu": 1,
    "num_tuning_micro_batch_sizes": 3
}
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   bfloat16_enabled ............. True
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   checkpoint_parallel_write_pipeline  False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   checkpoint_tag_validation_enabled  True
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   checkpoint_tag_validation_fail  False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   comms_config ................. <deepspeed.comm.config.DeepSpeedCommsConfig object at 0x7fbc78707d50>
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   communication_data_type ...... None
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   compression_config ........... {'weight_quantization': {'shared_parameters': {'enabled': False, 'quantizer_kernel': False, 'schedule_offset': 0, 'quantize_groups': 1, 'quantize_verbose': False, 'quantization_type': 'symmetric', 'quantize_weight_in_forward': False, 'rounding': 'nearest', 'fp16_mixed_quantize': False, 'quantize_change_ratio': 0.001}, 'different_groups': {}}, 'activation_quantization': {'shared_parameters': {'enabled': False, 'quantization_type': 'symmetric', 'range_calibration': 'dynamic', 'schedule_offset': 1000}, 'different_groups': {}}, 'sparse_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'row_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'head_pruning': {'shared_parameters': {'enabled': False, 'method': 'topk', 'schedule_offset': 1000}, 'different_groups': {}}, 'channel_pruning': {'shared_parameters': {'enabled': False, 'method': 'l1', 'schedule_offset': 1000}, 'different_groups': {}}, 'layer_reduction': {'enabled': False}}
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   curriculum_enabled_legacy .... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   curriculum_params_legacy ..... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   data_efficiency_config ....... {'enabled': False, 'seed': 1234, 'data_sampling': {'enabled': False, 'num_epochs': 1000, 'num_workers': 0, 'curriculum_learning': {'enabled': False}}, 'data_routing': {'enabled': False, 'random_ltd': {'enabled': False, 'layer_token_lr_schedule': {'enabled': False}}}}
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   data_efficiency_enabled ...... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   dataloader_drop_last ......... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   disable_allgather ............ False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   dump_state ................... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   dynamic_loss_scale_args ...... None
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_enabled ........... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_gas_boundary_resolution  1
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_layer_name ........ bert.encoder.layer
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_layer_num ......... 0
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_max_iter .......... 100
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_stability ......... 1e-06
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_tol ............... 0.01
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   eigenvalue_verbose ........... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   elasticity_enabled ........... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   flops_profiler_config ........ {
    "enabled": false,
    "recompute_fwd_factor": 0.0,
    "profile_step": 1,
    "module_depth": -1,
    "top_modules": 1,
    "detailed": true,
    "output_file": null
}
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   fp16_auto_cast ............... None
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   fp16_enabled ................. False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   fp16_master_weights_and_gradients  False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   global_rank .................. 0
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   grad_accum_dtype ............. None
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   gradient_accumulation_steps .. 1
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   gradient_clipping ............ 1.0
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   gradient_predivide_factor .... 1.0
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   graph_harvesting ............. False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   hybrid_engine ................ enabled=False max_out_tokens=512 inference_tp_size=1 release_inference_cache=False pin_parameters=True tp_gather_partition_size=8
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   initial_dynamic_scale ........ 1
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   load_universal_checkpoint .... False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   loss_scale ................... 1.0
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   memory_breakdown ............. False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   mics_hierarchial_params_gather  False
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   mics_shard_size .............. -1
[2024-11-19 17:05:48,240] [INFO] [config.py:988:print]   monitor_config ............... tensorboard=TensorBoardConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') wandb=WandbConfig(enabled=False, group=None, team=None, project='deepspeed') csv_monitor=CSVConfig(enabled=False, output_path='', job_name='DeepSpeedJobName') enabled=False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   nebula_config ................ {
    "enabled": false,
    "persistent_storage_path": null,
    "persistent_time_interval": 100,
    "num_of_version_in_retention": 2,
    "enable_nebula_load": true,
    "load_path": null
}
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   optimizer_legacy_fusion ...... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   optimizer_name ............... adamw
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   optimizer_params ............. {'lr': 5e-05, 'betas': [0.9, 0.999], 'eps': 1e-08, 'weight_decay': 0.0}
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   pipeline ..................... {'stages': 'auto', 'partition': 'best', 'seed_layers': False, 'activation_checkpoint_interval': 0, 'pipe_partitioned': True, 'grad_partitioned': True}
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   pld_enabled .................. False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   pld_params ................... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   prescale_gradients ........... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   scheduler_name ............... WarmupLR
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   scheduler_params ............. {'warmup_min_lr': 0, 'warmup_max_lr': 5e-05, 'warmup_num_steps': 0}
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   seq_parallel_communication_data_type  torch.float32
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   sparse_attention ............. None
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   sparse_gradients_enabled ..... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   steps_per_print .............. inf
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   train_batch_size ............. 256
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   train_micro_batch_size_per_gpu  32
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   use_data_before_expert_parallel_  False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   use_node_local_storage ....... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   wall_clock_breakdown ......... False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   weight_quantization_config ... None
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   world_size ................... 8
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   zero_allow_untested_optimizer  False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   zero_config .................. stage=0 contiguous_gradients=True reduce_scatter=True reduce_bucket_size=500,000,000 use_multi_rank_bucket_allreduce=True allgather_partitions=True allgather_bucket_size=500,000,000 overlap_comm=False load_from_fp32_weights=True elastic_checkpoint=False offload_param=None offload_optimizer=None sub_group_size=1,000,000,000 cpu_offload_param=None cpu_offload_use_pin_memory=None cpu_offload=None prefetch_bucket_size=50,000,000 param_persistence_threshold=100,000 model_persistence_threshold=sys.maxsize max_live_parameters=1,000,000,000 max_reuse_distance=1,000,000,000 gather_16bit_weights_on_model_save=False stage3_gather_fp16_weights_on_model_save=False ignore_unused_parameters=True legacy_stage1=False round_robin_gradients=False zero_hpz_partition_size=1 zero_quantized_weights=False zero_quantized_nontrainable_weights=False zero_quantized_gradients=False mics_shard_size=-1 mics_hierarchical_params_gather=False memory_efficient_linear=True pipeline_loading_checkpoint=False override_module_apply=True
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   zero_enabled ................. False
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   zero_force_ds_cpu_optimizer .. True
[2024-11-19 17:05:48,241] [INFO] [config.py:988:print]   zero_optimization_stage ...... 0
[2024-11-19 17:05:48,241] [INFO] [config.py:974:print_user_config]   json = {
    "bf16": {
        "enabled": true
    },
    "optimizer": {
        "type": "AdamW",
        "params": {
            "lr": 5e-05,
            "betas": [0.9, 0.999],
            "eps": 1e-08,
            "weight_decay": 0.0
        }
    },
    "scheduler": {
        "type": "WarmupLR",
        "params": {
            "warmup_min_lr": 0,
            "warmup_max_lr": 5e-05,
            "warmup_num_steps": 0
        }
    },
    "zero_optimization": {
        "stage": 0
    },
    "gradient_accumulation_steps": 1,
    "gradient_clipping": 1.0,
    "train_batch_size": 256,
    "train_micro_batch_size_per_gpu": 32,
    "steps_per_print": inf,
    "fp16": {
        "enabled": false
    }
}
[INFO|trainer.py:2314] 2024-11-19 17:05:48,241 >> ***** Running training *****
[INFO|trainer.py:2315] 2024-11-19 17:05:48,241 >>   Num examples = 105,659
[INFO|trainer.py:2316] 2024-11-19 17:05:48,241 >>   Num Epochs = 12
[INFO|trainer.py:2317] 2024-11-19 17:05:48,241 >>   Instantaneous batch size per device = 32
[INFO|trainer.py:2320] 2024-11-19 17:05:48,241 >>   Total train batch size (w. parallel, distributed & accumulation) = 256
[INFO|trainer.py:2321] 2024-11-19 17:05:48,241 >>   Gradient Accumulation steps = 1
[INFO|trainer.py:2322] 2024-11-19 17:05:48,241 >>   Total optimization steps = 4,956
[INFO|trainer.py:2323] 2024-11-19 17:05:48,242 >>   Number of trainable parameters = 247,577,856
  0%|                                                                                                                                                                                                                                               | 0/4956 [00:00<?, ?it/s]/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[WARNING|logging.py:328] 2024-11-19 17:05:50,643 >> `use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 1.0581, 'grad_norm': 1.5903473227599962, 'learning_rate': 5e-05, 'epoch': 0.02}
{'loss': 0.4393, 'grad_norm': 0.7061267568019758, 'learning_rate': 5e-05, 'epoch': 0.05}
{'loss': 0.284, 'grad_norm': 0.5169005655426191, 'learning_rate': 5e-05, 'epoch': 0.07}
{'loss': 0.2173, 'grad_norm': 0.48741851883747916, 'learning_rate': 5e-05, 'epoch': 0.1}
{'loss': 0.1886, 'grad_norm': 0.499365508308011, 'learning_rate': 5e-05, 'epoch': 0.12}
{'loss': 0.1692, 'grad_norm': 0.36539231419657114, 'learning_rate': 5e-05, 'epoch': 0.15}
{'loss': 0.1543, 'grad_norm': 0.3679636402139804, 'learning_rate': 5e-05, 'epoch': 0.17}
{'loss': 0.1439, 'grad_norm': 0.3435749345097219, 'learning_rate': 5e-05, 'epoch': 0.19}
{'loss': 0.1391, 'grad_norm': 0.3337128745907728, 'learning_rate': 5e-05, 'epoch': 0.22}
{'loss': 0.1306, 'grad_norm': 0.3214359237666371, 'learning_rate': 5e-05, 'epoch': 0.24}
{'loss': 0.1261, 'grad_norm': 0.29590041408571083, 'learning_rate': 5e-05, 'epoch': 0.27}
{'loss': 0.1217, 'grad_norm': 0.3336356835732499, 'learning_rate': 5e-05, 'epoch': 0.29}
{'loss': 0.1168, 'grad_norm': 0.29074295121748267, 'learning_rate': 5e-05, 'epoch': 0.31}
{'loss': 0.1133, 'grad_norm': 0.22113186201097845, 'learning_rate': 5e-05, 'epoch': 0.34}
{'loss': 0.1115, 'grad_norm': 0.3393670059548211, 'learning_rate': 5e-05, 'epoch': 0.36}
{'loss': 0.1072, 'grad_norm': 0.2567712680640161, 'learning_rate': 5e-05, 'epoch': 0.39}
{'loss': 0.1057, 'grad_norm': 0.25249698993569436, 'learning_rate': 5e-05, 'epoch': 0.41}
{'loss': 0.102, 'grad_norm': 0.2923475163929227, 'learning_rate': 5e-05, 'epoch': 0.44}
{'loss': 0.1021, 'grad_norm': 0.2367529007226428, 'learning_rate': 5e-05, 'epoch': 0.46}
{'loss': 0.0985, 'grad_norm': 0.23903869404412023, 'learning_rate': 5e-05, 'epoch': 0.48}
{'loss': 0.0988, 'grad_norm': 0.196066716219045, 'learning_rate': 5e-05, 'epoch': 0.51}
{'loss': 0.0926, 'grad_norm': 0.22116156875760556, 'learning_rate': 5e-05, 'epoch': 0.53}
{'loss': 0.0949, 'grad_norm': 0.22218607734407134, 'learning_rate': 5e-05, 'epoch': 0.56}
{'loss': 0.0927, 'grad_norm': 0.26579049508657393, 'learning_rate': 5e-05, 'epoch': 0.58}
{'loss': 0.0888, 'grad_norm': 0.3394971592900867, 'learning_rate': 5e-05, 'epoch': 0.61}
{'loss': 0.0913, 'grad_norm': 0.24997401847537928, 'learning_rate': 5e-05, 'epoch': 0.63}
{'loss': 0.0896, 'grad_norm': 0.2896811077807688, 'learning_rate': 5e-05, 'epoch': 0.65}
{'loss': 0.0848, 'grad_norm': 0.24224988072474077, 'learning_rate': 5e-05, 'epoch': 0.68}
{'loss': 0.0846, 'grad_norm': 0.1986446148302073, 'learning_rate': 5e-05, 'epoch': 0.7}
{'loss': 0.0859, 'grad_norm': 0.21696933553903197, 'learning_rate': 5e-05, 'epoch': 0.73}
{'loss': 0.0843, 'grad_norm': 0.2633732269998699, 'learning_rate': 5e-05, 'epoch': 0.75}
{'loss': 0.0824, 'grad_norm': 0.18480640025968892, 'learning_rate': 5e-05, 'epoch': 0.77}
{'loss': 0.0839, 'grad_norm': 0.2588309631975018, 'learning_rate': 5e-05, 'epoch': 0.8}
{'loss': 0.0813, 'grad_norm': 0.1848827019358066, 'learning_rate': 5e-05, 'epoch': 0.82}
{'loss': 0.0807, 'grad_norm': 0.2572836219569836, 'learning_rate': 5e-05, 'epoch': 0.85}
{'loss': 0.0819, 'grad_norm': 0.24812157324675543, 'learning_rate': 5e-05, 'epoch': 0.87}
{'loss': 0.0803, 'grad_norm': 0.2280547393091003, 'learning_rate': 5e-05, 'epoch': 0.9}
{'loss': 0.0795, 'grad_norm': 0.18524594247096424, 'learning_rate': 5e-05, 'epoch': 0.92}
{'loss': 0.0804, 'grad_norm': 0.2112715248704351, 'learning_rate': 5e-05, 'epoch': 0.94}
{'loss': 0.0778, 'grad_norm': 0.17147309281376838, 'learning_rate': 5e-05, 'epoch': 0.97}
{'loss': 0.0789, 'grad_norm': 0.2749854820927568, 'learning_rate': 5e-05, 'epoch': 0.99}
  8%|██████████████████▉                                                                                                                                                                                                                | 413/4956 [07:56<1:25:01,  1.12s/it][INFO|gner_trainer.py:60] 2024-11-19 17:13:44,531 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:13:44,532 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:13:44,532 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3901.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3851.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3549.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3841.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3500.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3798.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3478.05it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3710.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3685.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3637.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3689.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3612.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3696.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3672.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3629.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1298.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1254.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1238.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1250.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1238.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1228.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1240.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1231.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1138.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1136.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1136.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1133.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1133.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1128.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1128.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1129.91it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 994.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 990.57it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 997.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 990.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 992.47it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 990.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 990.74it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 992.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 909.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 904.80it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 911.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 903.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 906.11it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 904.45it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 904.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 904.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1131.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1130.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1135.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1127.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1128.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1125.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1123.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1128.79it/s]
{'eval_mit-movie_precision': 0.26521739130423255, 'eval_mit-movie_recall': 0.1768115942028473, 'eval_mit-movie_f1': 0.21217391299540447, 'eval_mit-restaurant_precision': 0.22435897435883057, 'eval_mit-restaurant_recall': 0.0800915331807597, 'eval_mit-restaurant_f1': 0.11804384481784848, 'eval_crossner_ai_precision': 0.3468950749464296, 'eval_crossner_ai_recall': 0.41968911917093005, 'eval_crossner_ai_f1': 0.3798358733384485, 'eval_crossner_literature_precision': 0.47715196599357307, 'eval_crossner_literature_recall': 0.47312961011586163, 'eval_crossner_literature_f1': 0.4751322750822257, 'eval_crossner_music_precision': 0.43255463451390863, 'eval_crossner_music_recall': 0.4192841490138481, 'eval_crossner_music_f1': 0.4258160236888529, 'eval_crossner_politics_precision': 0.4459064327485054, 'eval_crossner_politics_recall': 0.49193548387092806, 'eval_crossner_politics_f1': 0.46779141099302934, 'eval_crossner_science_precision': 0.4974003466204075, 'eval_crossner_science_recall': 0.6259541984732141, 'eval_crossner_science_f1': 0.5543215837265549, 'eval_average_f1': 0.3761592749489092, 'eval_runtime': 39.8791, 'eval_samples_per_second': 35.106, 'eval_steps_per_second': 0.15, 'epoch': 1.0}
  8%|██████████████████▉                                                                                                                                                                                                                | 413/4956 [08:36<1:25:01,  1.12s/it]
[INFO|trainer.py:3812] 2024-11-19 17:14:24,700 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-413
[INFO|configuration_utils.py:414] 2024-11-19 17:14:24,702 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-413/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:14:24,702 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-413/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:14:25,251 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-413/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:14:25,252 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-413/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:14:25,252 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-413/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:14:25,254 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-413/spiece.model
[2024-11-19 17:14:25,273] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step413 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:14:25,279] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/mp_rank_00_model_states.pt
[2024-11-19 17:14:25,279] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/mp_rank_00_model_states.pt...
[2024-11-19 17:14:25,913] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/mp_rank_00_model_states.pt.
[2024-11-19 17:14:25,915] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:14:26,466] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:14:26,467] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-413/global_step413/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:14:26,467] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step413 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0762, 'grad_norm': 0.1909006115762467, 'learning_rate': 5e-05, 'epoch': 1.02}
{'loss': 0.0755, 'grad_norm': 0.19247719826283438, 'learning_rate': 5e-05, 'epoch': 1.04}
{'loss': 0.076, 'grad_norm': 0.242272062305298, 'learning_rate': 5e-05, 'epoch': 1.07}
{'loss': 0.0758, 'grad_norm': 0.18753725913511035, 'learning_rate': 5e-05, 'epoch': 1.09}
{'loss': 0.073, 'grad_norm': 0.18103642623641933, 'learning_rate': 5e-05, 'epoch': 1.11}
{'loss': 0.0734, 'grad_norm': 0.17694989721457458, 'learning_rate': 5e-05, 'epoch': 1.14}
{'loss': 0.0733, 'grad_norm': 0.30815578720851833, 'learning_rate': 5e-05, 'epoch': 1.16}
{'loss': 0.0731, 'grad_norm': 0.19665696885119865, 'learning_rate': 5e-05, 'epoch': 1.19}
{'loss': 0.0724, 'grad_norm': 0.17885805546978722, 'learning_rate': 5e-05, 'epoch': 1.21}
{'loss': 0.0723, 'grad_norm': 0.20929392056090393, 'learning_rate': 5e-05, 'epoch': 1.23}
{'loss': 0.071, 'grad_norm': 0.36152744466167286, 'learning_rate': 5e-05, 'epoch': 1.26}
{'loss': 0.0718, 'grad_norm': 0.18701152950904773, 'learning_rate': 5e-05, 'epoch': 1.28}
{'loss': 0.0721, 'grad_norm': 0.16040160992999392, 'learning_rate': 5e-05, 'epoch': 1.31}
{'loss': 0.0692, 'grad_norm': 0.2048313108867636, 'learning_rate': 5e-05, 'epoch': 1.33}
{'loss': 0.0689, 'grad_norm': 0.258396988891324, 'learning_rate': 5e-05, 'epoch': 1.36}
{'loss': 0.0701, 'grad_norm': 0.19370198962435897, 'learning_rate': 5e-05, 'epoch': 1.38}
{'loss': 0.0684, 'grad_norm': 0.1609767447000577, 'learning_rate': 5e-05, 'epoch': 1.4}
{'loss': 0.0695, 'grad_norm': 0.2035555494689553, 'learning_rate': 5e-05, 'epoch': 1.43}
{'loss': 0.0673, 'grad_norm': 0.22348082262475144, 'learning_rate': 5e-05, 'epoch': 1.45}
{'loss': 0.0685, 'grad_norm': 0.21821601440351676, 'learning_rate': 5e-05, 'epoch': 1.48}
{'loss': 0.0675, 'grad_norm': 0.19020947169986557, 'learning_rate': 5e-05, 'epoch': 1.5}
{'loss': 0.0676, 'grad_norm': 0.20817785521240015, 'learning_rate': 5e-05, 'epoch': 1.53}
{'loss': 0.068, 'grad_norm': 0.3252029188944789, 'learning_rate': 5e-05, 'epoch': 1.55}
{'loss': 0.0687, 'grad_norm': 0.1378146053875671, 'learning_rate': 5e-05, 'epoch': 1.57}
{'loss': 0.0676, 'grad_norm': 0.18378981814092302, 'learning_rate': 5e-05, 'epoch': 1.6}
{'loss': 0.0664, 'grad_norm': 0.18248513491067556, 'learning_rate': 5e-05, 'epoch': 1.62}
{'loss': 0.0671, 'grad_norm': 0.22539128744732115, 'learning_rate': 5e-05, 'epoch': 1.65}
{'loss': 0.0661, 'grad_norm': 0.1944604407743182, 'learning_rate': 5e-05, 'epoch': 1.67}
{'loss': 0.0659, 'grad_norm': 0.24201620104396884, 'learning_rate': 5e-05, 'epoch': 1.69}
{'loss': 0.0659, 'grad_norm': 0.12848615830315924, 'learning_rate': 5e-05, 'epoch': 1.72}
{'loss': 0.0653, 'grad_norm': 0.17412067826200625, 'learning_rate': 5e-05, 'epoch': 1.74}
{'loss': 0.0672, 'grad_norm': 0.19880591420223806, 'learning_rate': 5e-05, 'epoch': 1.77}
{'loss': 0.0645, 'grad_norm': 0.2511189424259824, 'learning_rate': 5e-05, 'epoch': 1.79}
{'loss': 0.0664, 'grad_norm': 0.18118751575158043, 'learning_rate': 5e-05, 'epoch': 1.82}
{'loss': 0.0654, 'grad_norm': 0.16522124353269274, 'learning_rate': 5e-05, 'epoch': 1.84}
{'loss': 0.0636, 'grad_norm': 0.19564576326728547, 'learning_rate': 5e-05, 'epoch': 1.86}
{'loss': 0.0657, 'grad_norm': 0.18428762677101712, 'learning_rate': 5e-05, 'epoch': 1.89}
{'loss': 0.0641, 'grad_norm': 0.21402248857889705, 'learning_rate': 5e-05, 'epoch': 1.91}
{'loss': 0.0638, 'grad_norm': 0.16297713665033403, 'learning_rate': 5e-05, 'epoch': 1.94}
{'loss': 0.0627, 'grad_norm': 0.16379799410674145, 'learning_rate': 5e-05, 'epoch': 1.96}
{'loss': 0.0636, 'grad_norm': 0.17367007002791313, 'learning_rate': 5e-05, 'epoch': 1.99}
 17%|█████████████████████████████████████▊                                                                                                                                                                                             | 826/4956 [16:18<1:13:35,  1.07s/it][INFO|gner_trainer.py:60] 2024-11-19 17:22:07,239 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:22:07,239 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:22:07,239 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4165.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4170.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4143.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4197.73it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3977.47it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4151.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3884.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3888.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3861.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3954.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3913.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3847.51it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3873.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1372.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1356.72it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1355.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1343.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1360.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1193.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1182.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1186.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1025.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1029.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1022.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1012.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1027.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1024.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1025.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 931.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 935.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.95it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.03it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 934.49it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 936.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 929.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1163.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1181.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1173.50it/s]
{'eval_mit-movie_precision': 0.30364372469623335, 'eval_mit-movie_recall': 0.21739130434776308, 'eval_mit-movie_f1': 0.253378378329663, 'eval_mit-restaurant_precision': 0.34615384615362427, 'eval_mit-restaurant_recall': 0.12356979405031497, 'eval_mit-restaurant_f1': 0.1821247891685857, 'eval_crossner_ai_precision': 0.37893593919648433, 'eval_crossner_ai_recall': 0.45207253886004506, 'eval_crossner_ai_f1': 0.4122858829981826, 'eval_crossner_literature_precision': 0.5112059765207565, 'eval_crossner_literature_recall': 0.5047418335089036, 'eval_crossner_literature_f1': 0.5079533403529174, 'eval_crossner_music_precision': 0.5634743875277978, 'eval_crossner_music_recall': 0.5544192841489733, 'eval_crossner_music_f1': 0.5589101619529075, 'eval_crossner_politics_precision': 0.5293197810789265, 'eval_crossner_politics_recall': 0.5459677419354398, 'eval_crossner_politics_f1': 0.5375148868098343, 'eval_crossner_science_precision': 0.5547576301615301, 'eval_crossner_science_recall': 0.6739367502725546, 'eval_crossner_science_f1': 0.6085672082221978, 'eval_average_f1': 0.4372478068334698, 'eval_runtime': 38.8246, 'eval_samples_per_second': 36.06, 'eval_steps_per_second': 0.155, 'epoch': 2.0}
 17%|█████████████████████████████████████▊                                                                                                                                                                                             | 826/4956 [16:57<1:13:35,  1.07s/it]
[INFO|trainer.py:3812] 2024-11-19 17:22:46,307 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-826
[INFO|configuration_utils.py:414] 2024-11-19 17:22:46,310 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-826/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:22:46,310 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-826/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:22:46,887 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-826/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:22:46,888 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-826/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:22:46,889 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-826/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:22:46,889 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-826/spiece.model
[2024-11-19 17:22:46,901] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step826 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:22:46,907] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/mp_rank_00_model_states.pt
[2024-11-19 17:22:46,907] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/mp_rank_00_model_states.pt...
[2024-11-19 17:22:47,546] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/mp_rank_00_model_states.pt.
[2024-11-19 17:22:47,549] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:22:48,152] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:22:48,152] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-826/global_step826/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:22:48,152] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step826 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0647, 'grad_norm': 0.11684413913647725, 'learning_rate': 5e-05, 'epoch': 2.01}
{'loss': 0.0623, 'grad_norm': 0.3848502554984457, 'learning_rate': 5e-05, 'epoch': 2.03}
{'loss': 0.0623, 'grad_norm': 0.17441789894113713, 'learning_rate': 5e-05, 'epoch': 2.06}
{'loss': 0.063, 'grad_norm': 0.17240797117285803, 'learning_rate': 5e-05, 'epoch': 2.08}
{'loss': 0.0631, 'grad_norm': 0.165415447527487, 'learning_rate': 5e-05, 'epoch': 2.11}
{'loss': 0.0607, 'grad_norm': 0.17463503762077096, 'learning_rate': 5e-05, 'epoch': 2.13}
{'loss': 0.061, 'grad_norm': 0.1682194624061388, 'learning_rate': 5e-05, 'epoch': 2.15}
{'loss': 0.0605, 'grad_norm': 0.14796764901062764, 'learning_rate': 5e-05, 'epoch': 2.18}
{'loss': 0.0615, 'grad_norm': 0.1546924566187649, 'learning_rate': 5e-05, 'epoch': 2.2}
{'loss': 0.061, 'grad_norm': 0.227010350062821, 'learning_rate': 5e-05, 'epoch': 2.23}
{'loss': 0.0606, 'grad_norm': 0.17578883154731717, 'learning_rate': 5e-05, 'epoch': 2.25}
{'loss': 0.0606, 'grad_norm': 0.182960534273724, 'learning_rate': 5e-05, 'epoch': 2.28}
{'loss': 0.0577, 'grad_norm': 0.16648997251318787, 'learning_rate': 5e-05, 'epoch': 2.3}
{'loss': 0.0606, 'grad_norm': 0.23304400806409134, 'learning_rate': 5e-05, 'epoch': 2.32}
{'loss': 0.0609, 'grad_norm': 0.21197424530639983, 'learning_rate': 5e-05, 'epoch': 2.35}
{'loss': 0.0596, 'grad_norm': 0.1933560033947386, 'learning_rate': 5e-05, 'epoch': 2.37}
{'loss': 0.0594, 'grad_norm': 0.1966006524580144, 'learning_rate': 5e-05, 'epoch': 2.4}
{'loss': 0.0609, 'grad_norm': 0.24034188353840866, 'learning_rate': 5e-05, 'epoch': 2.42}
{'loss': 0.0587, 'grad_norm': 0.16394952449155212, 'learning_rate': 5e-05, 'epoch': 2.45}
{'loss': 0.0592, 'grad_norm': 0.18419947027472994, 'learning_rate': 5e-05, 'epoch': 2.47}
{'loss': 0.0602, 'grad_norm': 0.2666611796922238, 'learning_rate': 5e-05, 'epoch': 2.49}
{'loss': 0.0598, 'grad_norm': 0.1716071121912725, 'learning_rate': 5e-05, 'epoch': 2.52}
{'loss': 0.0574, 'grad_norm': 0.17627599286945525, 'learning_rate': 5e-05, 'epoch': 2.54}
{'loss': 0.0583, 'grad_norm': 0.20733381151241814, 'learning_rate': 5e-05, 'epoch': 2.57}
{'loss': 0.0579, 'grad_norm': 0.2613736339681167, 'learning_rate': 5e-05, 'epoch': 2.59}
{'loss': 0.0594, 'grad_norm': 0.19731061252480261, 'learning_rate': 5e-05, 'epoch': 2.62}
{'loss': 0.058, 'grad_norm': 0.13158014702406903, 'learning_rate': 5e-05, 'epoch': 2.64}
{'loss': 0.0584, 'grad_norm': 0.15851163805539323, 'learning_rate': 5e-05, 'epoch': 2.66}
{'loss': 0.0577, 'grad_norm': 0.19691522089022107, 'learning_rate': 5e-05, 'epoch': 2.69}
{'loss': 0.0588, 'grad_norm': 0.12067293681554672, 'learning_rate': 5e-05, 'epoch': 2.71}
{'loss': 0.0572, 'grad_norm': 0.21309083745901328, 'learning_rate': 5e-05, 'epoch': 2.74}
{'loss': 0.0573, 'grad_norm': 0.31560614170730056, 'learning_rate': 5e-05, 'epoch': 2.76}
{'loss': 0.0581, 'grad_norm': 0.1541353116228992, 'learning_rate': 5e-05, 'epoch': 2.78}
{'loss': 0.0588, 'grad_norm': 0.23554765280473372, 'learning_rate': 5e-05, 'epoch': 2.81}
{'loss': 0.0578, 'grad_norm': 0.14453464581392292, 'learning_rate': 5e-05, 'epoch': 2.83}
{'loss': 0.0566, 'grad_norm': 0.1508175685112271, 'learning_rate': 5e-05, 'epoch': 2.86}
{'loss': 0.0589, 'grad_norm': 0.162527046107806, 'learning_rate': 5e-05, 'epoch': 2.88}
{'loss': 0.0567, 'grad_norm': 0.1564409460156087, 'learning_rate': 5e-05, 'epoch': 2.91}
{'loss': 0.0558, 'grad_norm': 0.24845090386081756, 'learning_rate': 5e-05, 'epoch': 2.93}
{'loss': 0.0565, 'grad_norm': 0.22922284980077065, 'learning_rate': 5e-05, 'epoch': 2.95}
{'loss': 0.0561, 'grad_norm': 0.15250336403927575, 'learning_rate': 5e-05, 'epoch': 2.98}
 25%|████████████████████████████████████████████████████████▌                                                                                                                                                                         | 1239/4956 [24:40<1:07:33,  1.09s/it][INFO|gner_trainer.py:60] 2024-11-19 17:30:29,145 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:30:29,145 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:30:29,145 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4134.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:34<00:00,  6.53s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4140.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4180.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4191.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4143.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4152.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4178.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3855.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3815.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3797.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3899.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3884.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3836.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3871.46it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1361.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1337.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1348.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1353.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1362.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1169.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1011.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1005.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1015.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 924.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 919.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.62it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 909.81it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 904.96it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 809.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 814.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1169.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1160.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1149.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1161.89it/s]
{'eval_mit-movie_precision': 0.37109374999985506, 'eval_mit-movie_recall': 0.2753623188404999, 'eval_mit-movie_f1': 0.3161397670058998, 'eval_mit-restaurant_precision': 0.368983957219054, 'eval_mit-restaurant_recall': 0.15789473684206914, 'eval_mit-restaurant_f1': 0.22115384611180092, 'eval_crossner_ai_precision': 0.4006276150627196, 'eval_crossner_ai_recall': 0.4961139896372414, 'eval_crossner_ai_f1': 0.4432870369875526, 'eval_crossner_literature_precision': 0.5140086206895997, 'eval_crossner_literature_recall': 0.5026343519493675, 'eval_crossner_literature_f1': 0.5082578582344486, 'eval_crossner_music_precision': 0.6020710059171153, 'eval_crossner_music_recall': 0.5945945945945511, 'eval_crossner_music_f1': 0.5983094450069223, 'eval_crossner_politics_precision': 0.5342250196695095, 'eval_crossner_politics_recall': 0.5475806451612462, 'eval_crossner_politics_f1': 0.5408203902327204, 'eval_crossner_science_precision': 0.6012715712987646, 'eval_crossner_science_recall': 0.721919302071895, 'eval_crossner_science_f1': 0.6560951436569908, 'eval_average_f1': 0.4691519267480479, 'eval_runtime': 37.3312, 'eval_samples_per_second': 37.502, 'eval_steps_per_second': 0.161, 'epoch': 3.0}
 25%|████████████████████████████████████████████████████████▌                                                                                                                                                                         | 1239/4956 [25:18<1:07:33,  1.09s/it]
[INFO|trainer.py:3812] 2024-11-19 17:31:06,730 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-1239
[INFO|configuration_utils.py:414] 2024-11-19 17:31:06,732 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-1239/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:31:06,732 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-1239/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:31:07,292 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-1239/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:31:07,294 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-1239/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:31:07,294 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-1239/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:31:07,295 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-1239/spiece.model
[2024-11-19 17:31:07,306] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1239 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:31:07,312] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/mp_rank_00_model_states.pt
[2024-11-19 17:31:07,312] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/mp_rank_00_model_states.pt...
[2024-11-19 17:31:07,935] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/mp_rank_00_model_states.pt.
[2024-11-19 17:31:07,937] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:31:08,460] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:31:08,461] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-1239/global_step1239/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:31:08,461] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1239 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.057, 'grad_norm': 0.24256317166297114, 'learning_rate': 5e-05, 'epoch': 3.0}
{'loss': 0.0554, 'grad_norm': 0.1257408435556548, 'learning_rate': 5e-05, 'epoch': 3.03}
{'loss': 0.0554, 'grad_norm': 0.1787094262064417, 'learning_rate': 5e-05, 'epoch': 3.05}
{'loss': 0.0553, 'grad_norm': 0.1661279971216198, 'learning_rate': 5e-05, 'epoch': 3.08}
{'loss': 0.0554, 'grad_norm': 0.1564421247426605, 'learning_rate': 5e-05, 'epoch': 3.1}
{'loss': 0.0559, 'grad_norm': 0.14933353947004532, 'learning_rate': 5e-05, 'epoch': 3.12}
{'loss': 0.057, 'grad_norm': 0.15650875005506446, 'learning_rate': 5e-05, 'epoch': 3.15}
{'loss': 0.0547, 'grad_norm': 0.17107004541419013, 'learning_rate': 5e-05, 'epoch': 3.17}
{'loss': 0.0562, 'grad_norm': 0.19026277514197776, 'learning_rate': 5e-05, 'epoch': 3.2}
{'loss': 0.056, 'grad_norm': 0.11886217064727107, 'learning_rate': 5e-05, 'epoch': 3.22}
{'loss': 0.0553, 'grad_norm': 0.16716931524936707, 'learning_rate': 5e-05, 'epoch': 3.24}
{'loss': 0.0549, 'grad_norm': 0.15567676176491235, 'learning_rate': 5e-05, 'epoch': 3.27}
{'loss': 0.0538, 'grad_norm': 0.204209322066003, 'learning_rate': 5e-05, 'epoch': 3.29}
{'loss': 0.0547, 'grad_norm': 0.16851023511088228, 'learning_rate': 5e-05, 'epoch': 3.32}
{'loss': 0.0535, 'grad_norm': 0.17454776316963078, 'learning_rate': 5e-05, 'epoch': 3.34}
{'loss': 0.0541, 'grad_norm': 0.14465040372974464, 'learning_rate': 5e-05, 'epoch': 3.37}
{'loss': 0.0525, 'grad_norm': 0.15456643279718255, 'learning_rate': 5e-05, 'epoch': 3.39}
{'loss': 0.0544, 'grad_norm': 0.16840921912103884, 'learning_rate': 5e-05, 'epoch': 3.41}
{'loss': 0.0549, 'grad_norm': 0.14565783325976592, 'learning_rate': 5e-05, 'epoch': 3.44}
{'loss': 0.0538, 'grad_norm': 0.15776475760187544, 'learning_rate': 5e-05, 'epoch': 3.46}
{'loss': 0.0534, 'grad_norm': 0.1980395855587279, 'learning_rate': 5e-05, 'epoch': 3.49}
{'loss': 0.0538, 'grad_norm': 0.22953150797882022, 'learning_rate': 5e-05, 'epoch': 3.51}
{'loss': 0.0534, 'grad_norm': 0.1746326217708349, 'learning_rate': 5e-05, 'epoch': 3.54}
{'loss': 0.0533, 'grad_norm': 0.14009367384728755, 'learning_rate': 5e-05, 'epoch': 3.56}
{'loss': 0.0536, 'grad_norm': 0.15839977757725487, 'learning_rate': 5e-05, 'epoch': 3.58}
{'loss': 0.0536, 'grad_norm': 0.13677559760652896, 'learning_rate': 5e-05, 'epoch': 3.61}
{'loss': 0.0534, 'grad_norm': 0.22370512180618865, 'learning_rate': 5e-05, 'epoch': 3.63}
{'loss': 0.0528, 'grad_norm': 0.1266264747889608, 'learning_rate': 5e-05, 'epoch': 3.66}
{'loss': 0.0528, 'grad_norm': 0.1198836747253774, 'learning_rate': 5e-05, 'epoch': 3.68}
{'loss': 0.0539, 'grad_norm': 0.11463324090298743, 'learning_rate': 5e-05, 'epoch': 3.7}
{'loss': 0.054, 'grad_norm': 0.34100938815326803, 'learning_rate': 5e-05, 'epoch': 3.73}
{'loss': 0.0544, 'grad_norm': 0.14673082600581988, 'learning_rate': 5e-05, 'epoch': 3.75}
{'loss': 0.0516, 'grad_norm': 0.1724556683419072, 'learning_rate': 5e-05, 'epoch': 3.78}
{'loss': 0.053, 'grad_norm': 0.15114224855766983, 'learning_rate': 5e-05, 'epoch': 3.8}
{'loss': 0.0523, 'grad_norm': 0.26403096084046124, 'learning_rate': 5e-05, 'epoch': 3.83}
{'loss': 0.0532, 'grad_norm': 0.2525578715318722, 'learning_rate': 5e-05, 'epoch': 3.85}
{'loss': 0.0521, 'grad_norm': 0.1331358367691036, 'learning_rate': 5e-05, 'epoch': 3.87}
{'loss': 0.0528, 'grad_norm': 0.10697839834707476, 'learning_rate': 5e-05, 'epoch': 3.9}
{'loss': 0.055, 'grad_norm': 0.18244802830705667, 'learning_rate': 5e-05, 'epoch': 3.92}
{'loss': 0.0516, 'grad_norm': 0.1338741908761336, 'learning_rate': 5e-05, 'epoch': 3.95}
{'loss': 0.0521, 'grad_norm': 0.17488340917489326, 'learning_rate': 5e-05, 'epoch': 3.97}
{'loss': 0.0535, 'grad_norm': 0.16717299215704898, 'learning_rate': 5e-05, 'epoch': 4.0}
 33%|███████████████████████████████████████████████████████████████████████████▎                                                                                                                                                      | 1652/4956 [33:00<1:03:45,  1.16s/it][INFO|gner_trainer.py:60] 2024-11-19 17:38:48,580 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:38:48,580 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:38:48,580 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4169.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4156.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4150.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4201.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4185.31it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4156.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4154.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3836.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3830.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3895.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3801.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3853.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3823.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3815.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3831.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1375.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1346.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1353.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1371.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1192.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1182.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1190.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1192.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1029.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1022.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1025.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1009.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1025.26it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 937.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 927.67it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 930.83it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 924.51it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 929.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 917.48it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 929.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1166.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1176.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1169.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1154.16it/s]
{'eval_mit-movie_precision': 0.4226415094338028, 'eval_mit-movie_recall': 0.32463768115932623, 'eval_mit-movie_f1': 0.367213114704838, 'eval_mit-restaurant_precision': 0.33884297520647155, 'eval_mit-restaurant_recall': 0.18764302059492274, 'eval_mit-restaurant_f1': 0.24153166416612923, 'eval_crossner_ai_precision': 0.4053224155577886, 'eval_crossner_ai_recall': 0.5129533678755812, 'eval_crossner_ai_f1': 0.4528301886298804, 'eval_crossner_literature_precision': 0.5294771968853693, 'eval_crossner_literature_recall': 0.5015806111695994, 'eval_crossner_literature_f1': 0.5151515151014958, 'eval_crossner_music_precision': 0.5961251862890763, 'eval_crossner_music_recall': 0.5843681519356768, 'eval_crossner_music_f1': 0.5901881224139968, 'eval_crossner_politics_precision': 0.5333333333332905, 'eval_crossner_politics_recall': 0.5354838709676988, 'eval_crossner_politics_f1': 0.534406438581748, 'eval_crossner_science_precision': 0.5998176845942935, 'eval_crossner_science_recall': 0.7175572519083186, 'eval_crossner_science_f1': 0.6534260178252104, 'eval_average_f1': 0.47924958020332836, 'eval_runtime': 37.8553, 'eval_samples_per_second': 36.983, 'eval_steps_per_second': 0.158, 'epoch': 4.0}
 33%|███████████████████████████████████████████████████████████████████████████▎                                                                                                                                                      | 1652/4956 [33:38<1:03:45,  1.16s/it]
[INFO|trainer.py:3812] 2024-11-19 17:39:26,665 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-1652
[INFO|configuration_utils.py:414] 2024-11-19 17:39:26,667 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-1652/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:39:26,667 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-1652/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:39:27,224 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-1652/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:39:27,226 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-1652/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:39:27,226 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-1652/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:39:27,227 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-1652/spiece.model
[2024-11-19 17:39:27,239] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step1652 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:39:27,244] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/mp_rank_00_model_states.pt
[2024-11-19 17:39:27,244] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/mp_rank_00_model_states.pt...
[2024-11-19 17:39:27,872] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/mp_rank_00_model_states.pt.
[2024-11-19 17:39:27,874] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:39:28,403] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:39:28,403] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-1652/global_step1652/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:39:28,403] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step1652 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0541, 'grad_norm': 0.13196866453828784, 'learning_rate': 5e-05, 'epoch': 4.02}
{'loss': 0.0515, 'grad_norm': 0.18771027655200748, 'learning_rate': 5e-05, 'epoch': 4.04}
{'loss': 0.0512, 'grad_norm': 0.12601128920151358, 'learning_rate': 5e-05, 'epoch': 4.07}
{'loss': 0.0513, 'grad_norm': 0.13555684918690633, 'learning_rate': 5e-05, 'epoch': 4.09}
{'loss': 0.0502, 'grad_norm': 0.1888292994559352, 'learning_rate': 5e-05, 'epoch': 4.12}
{'loss': 0.0522, 'grad_norm': 0.14220779478467774, 'learning_rate': 5e-05, 'epoch': 4.14}
{'loss': 0.0516, 'grad_norm': 0.1796931390292138, 'learning_rate': 5e-05, 'epoch': 4.16}
{'loss': 0.0522, 'grad_norm': 0.15049746050307977, 'learning_rate': 5e-05, 'epoch': 4.19}
{'loss': 0.0508, 'grad_norm': 0.1353075354945034, 'learning_rate': 5e-05, 'epoch': 4.21}
{'loss': 0.0517, 'grad_norm': 0.1478813695656327, 'learning_rate': 5e-05, 'epoch': 4.24}
{'loss': 0.0505, 'grad_norm': 0.13805398153116238, 'learning_rate': 5e-05, 'epoch': 4.26}
{'loss': 0.0509, 'grad_norm': 0.14811055039495694, 'learning_rate': 5e-05, 'epoch': 4.29}
{'loss': 0.0512, 'grad_norm': 0.20586932916480147, 'learning_rate': 5e-05, 'epoch': 4.31}
{'loss': 0.0492, 'grad_norm': 0.14207071654058046, 'learning_rate': 5e-05, 'epoch': 4.33}
{'loss': 0.0514, 'grad_norm': 0.22320248708877494, 'learning_rate': 5e-05, 'epoch': 4.36}
{'loss': 0.0507, 'grad_norm': 0.14796529500003197, 'learning_rate': 5e-05, 'epoch': 4.38}
{'loss': 0.0491, 'grad_norm': 0.16159298240303735, 'learning_rate': 5e-05, 'epoch': 4.41}
{'loss': 0.0521, 'grad_norm': 0.18871399150723148, 'learning_rate': 5e-05, 'epoch': 4.43}
{'loss': 0.0507, 'grad_norm': 0.21766766943348873, 'learning_rate': 5e-05, 'epoch': 4.46}
{'loss': 0.0505, 'grad_norm': 0.23306726558945334, 'learning_rate': 5e-05, 'epoch': 4.48}
{'loss': 0.0501, 'grad_norm': 0.1288304467278299, 'learning_rate': 5e-05, 'epoch': 4.5}
{'loss': 0.0495, 'grad_norm': 0.15382472362409785, 'learning_rate': 5e-05, 'epoch': 4.53}
{'loss': 0.0495, 'grad_norm': 0.2268985360918362, 'learning_rate': 5e-05, 'epoch': 4.55}
{'loss': 0.0518, 'grad_norm': 0.1368880790074845, 'learning_rate': 5e-05, 'epoch': 4.58}
{'loss': 0.0502, 'grad_norm': 0.1524355074066835, 'learning_rate': 5e-05, 'epoch': 4.6}
{'loss': 0.0511, 'grad_norm': 0.13363661747533004, 'learning_rate': 5e-05, 'epoch': 4.62}
{'loss': 0.05, 'grad_norm': 0.14083318400186978, 'learning_rate': 5e-05, 'epoch': 4.65}
{'loss': 0.0497, 'grad_norm': 0.16860490473029469, 'learning_rate': 5e-05, 'epoch': 4.67}
{'loss': 0.0492, 'grad_norm': 0.1428558049394763, 'learning_rate': 5e-05, 'epoch': 4.7}
{'loss': 0.0501, 'grad_norm': 0.2185423154627355, 'learning_rate': 5e-05, 'epoch': 4.72}
{'loss': 0.0511, 'grad_norm': 0.13178777168053796, 'learning_rate': 5e-05, 'epoch': 4.75}
{'loss': 0.0489, 'grad_norm': 0.2119296283542546, 'learning_rate': 5e-05, 'epoch': 4.77}
{'loss': 0.0492, 'grad_norm': 0.16231247806328591, 'learning_rate': 5e-05, 'epoch': 4.79}
{'loss': 0.05, 'grad_norm': 0.10779696349137446, 'learning_rate': 5e-05, 'epoch': 4.82}
{'loss': 0.0497, 'grad_norm': 0.13578060347531545, 'learning_rate': 5e-05, 'epoch': 4.84}
{'loss': 0.0501, 'grad_norm': 0.18909633113099944, 'learning_rate': 5e-05, 'epoch': 4.87}
{'loss': 0.0494, 'grad_norm': 0.2409237685044717, 'learning_rate': 5e-05, 'epoch': 4.89}
{'loss': 0.0495, 'grad_norm': 0.26156289883381506, 'learning_rate': 5e-05, 'epoch': 4.92}
{'loss': 0.0491, 'grad_norm': 0.1463580858705888, 'learning_rate': 5e-05, 'epoch': 4.94}
{'loss': 0.0498, 'grad_norm': 0.16623443881145766, 'learning_rate': 5e-05, 'epoch': 4.96}
{'loss': 0.0492, 'grad_norm': 0.1469353409855573, 'learning_rate': 5e-05, 'epoch': 4.99}
 42%|███████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                     | 2065/4956 [41:20<53:46,  1.12s/it][INFO|gner_trainer.py:60] 2024-11-19 17:47:09,075 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:47:09,075 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:47:09,075 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4221.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4196.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4247.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4212.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4235.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4225.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4186.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3897.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3871.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3907.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3889.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3938.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3917.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3892.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4238.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1369.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1372.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1372.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3854.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1375.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1356.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1174.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1195.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1187.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1193.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1031.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1024.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1009.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1024.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1026.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1015.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 936.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 929.42it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.12it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 930.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 918.66it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 934.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 920.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1182.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1176.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1169.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1161.08it/s]
{'eval_mit-movie_precision': 0.4849624060148553, 'eval_mit-movie_recall': 0.3739130434781525, 'eval_mit-movie_f1': 0.4222585924220561, 'eval_mit-restaurant_precision': 0.36986301369846125, 'eval_mit-restaurant_recall': 0.18535469107547248, 'eval_mit-restaurant_f1': 0.2469512194676416, 'eval_crossner_ai_precision': 0.4290220820188823, 'eval_crossner_ai_recall': 0.5284974093263564, 'eval_crossner_ai_f1': 0.4735925710474086, 'eval_crossner_literature_precision': 0.554704595185935, 'eval_crossner_literature_recall': 0.5342465753424094, 'eval_crossner_literature_f1': 0.5442834137985905, 'eval_crossner_music_precision': 0.6370967741935016, 'eval_crossner_music_recall': 0.6347699050401289, 'eval_crossner_music_f1': 0.6359312110732613, 'eval_crossner_politics_precision': 0.5447219983883526, 'eval_crossner_politics_recall': 0.5451612903225367, 'eval_crossner_politics_f1': 0.5449415557742204, 'eval_crossner_science_precision': 0.5973534971644048, 'eval_crossner_science_recall': 0.6892039258450721, 'eval_crossner_science_f1': 0.63999999995019, 'eval_average_f1': 0.5011369376476241, 'eval_runtime': 37.7414, 'eval_samples_per_second': 37.095, 'eval_steps_per_second': 0.159, 'epoch': 5.0}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1160.38it/s]
[INFO|trainer.py:3812] 2024-11-19 17:47:47,180 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-2065
[INFO|configuration_utils.py:414] 2024-11-19 17:47:47,182 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2065/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:47:47,182 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2065/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:47:47,784 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-2065/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:47:47,786 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-2065/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:47:47,786 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-2065/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:47:47,787 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-2065/spiece.model
[2024-11-19 17:47:47,799] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step2065 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:47:47,805] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/mp_rank_00_model_states.pt
[2024-11-19 17:47:47,805] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/mp_rank_00_model_states.pt...
[2024-11-19 17:47:48,432] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/mp_rank_00_model_states.pt.
[2024-11-19 17:47:48,434] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:47:48,970] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:47:48,971] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-2065/global_step2065/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:47:48,971] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2065 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0486, 'grad_norm': 0.14554638959278487, 'learning_rate': 5e-05, 'epoch': 5.01}
{'loss': 0.0484, 'grad_norm': 0.14388551026208718, 'learning_rate': 5e-05, 'epoch': 5.04}
{'loss': 0.0502, 'grad_norm': 0.12713729264598075, 'learning_rate': 5e-05, 'epoch': 5.06}
{'loss': 0.048, 'grad_norm': 0.2093567783340733, 'learning_rate': 5e-05, 'epoch': 5.08}
{'loss': 0.0491, 'grad_norm': 0.12531349983196982, 'learning_rate': 5e-05, 'epoch': 5.11}
{'loss': 0.0497, 'grad_norm': 0.15156283501460224, 'learning_rate': 5e-05, 'epoch': 5.13}
{'loss': 0.0481, 'grad_norm': 0.1426846942036749, 'learning_rate': 5e-05, 'epoch': 5.16}
{'loss': 0.0477, 'grad_norm': 0.1649433400123759, 'learning_rate': 5e-05, 'epoch': 5.18}
{'loss': 0.0487, 'grad_norm': 0.15103112723860357, 'learning_rate': 5e-05, 'epoch': 5.21}
{'loss': 0.0487, 'grad_norm': 0.20004249881175876, 'learning_rate': 5e-05, 'epoch': 5.23}
{'loss': 0.0473, 'grad_norm': 0.12737570636654483, 'learning_rate': 5e-05, 'epoch': 5.25}
{'loss': 0.047, 'grad_norm': 0.09870785040003932, 'learning_rate': 5e-05, 'epoch': 5.28}
{'loss': 0.0474, 'grad_norm': 0.227510475032814, 'learning_rate': 5e-05, 'epoch': 5.3}
{'loss': 0.0497, 'grad_norm': 0.11553561309214423, 'learning_rate': 5e-05, 'epoch': 5.33}
{'loss': 0.048, 'grad_norm': 0.1681822318386426, 'learning_rate': 5e-05, 'epoch': 5.35}
{'loss': 0.0479, 'grad_norm': 0.1252647814185178, 'learning_rate': 5e-05, 'epoch': 5.38}
{'loss': 0.0485, 'grad_norm': 0.2694040634160346, 'learning_rate': 5e-05, 'epoch': 5.4}
{'loss': 0.0482, 'grad_norm': 0.10576481678124586, 'learning_rate': 5e-05, 'epoch': 5.42}
{'loss': 0.0487, 'grad_norm': 0.1906833914924009, 'learning_rate': 5e-05, 'epoch': 5.45}
{'loss': 0.0477, 'grad_norm': 0.14371350644079323, 'learning_rate': 5e-05, 'epoch': 5.47}
{'loss': 0.048, 'grad_norm': 0.13203543650744473, 'learning_rate': 5e-05, 'epoch': 5.5}
{'loss': 0.0475, 'grad_norm': 0.12894863818900215, 'learning_rate': 5e-05, 'epoch': 5.52}
{'loss': 0.0477, 'grad_norm': 0.14112470507992186, 'learning_rate': 5e-05, 'epoch': 5.54}
{'loss': 0.0481, 'grad_norm': 0.12203934085854007, 'learning_rate': 5e-05, 'epoch': 5.57}
{'loss': 0.047, 'grad_norm': 0.12877223244160893, 'learning_rate': 5e-05, 'epoch': 5.59}
{'loss': 0.047, 'grad_norm': 0.2160236384748956, 'learning_rate': 5e-05, 'epoch': 5.62}
{'loss': 0.0489, 'grad_norm': 0.10424980680244254, 'learning_rate': 5e-05, 'epoch': 5.64}
{'loss': 0.0471, 'grad_norm': 0.1599060290396399, 'learning_rate': 5e-05, 'epoch': 5.67}
{'loss': 0.0465, 'grad_norm': 0.18454542446365785, 'learning_rate': 5e-05, 'epoch': 5.69}
{'loss': 0.047, 'grad_norm': 0.12978730956990092, 'learning_rate': 5e-05, 'epoch': 5.71}
{'loss': 0.0481, 'grad_norm': 0.2598643438008578, 'learning_rate': 5e-05, 'epoch': 5.74}
{'loss': 0.0478, 'grad_norm': 0.14771370980759252, 'learning_rate': 5e-05, 'epoch': 5.76}
{'loss': 0.0467, 'grad_norm': 0.1240399041846158, 'learning_rate': 5e-05, 'epoch': 5.79}
{'loss': 0.0474, 'grad_norm': 0.11188867890256084, 'learning_rate': 5e-05, 'epoch': 5.81}
{'loss': 0.0484, 'grad_norm': 0.18910331482558998, 'learning_rate': 5e-05, 'epoch': 5.84}
{'loss': 0.047, 'grad_norm': 0.12428538376626413, 'learning_rate': 5e-05, 'epoch': 5.86}
{'loss': 0.0462, 'grad_norm': 0.16507779744662326, 'learning_rate': 5e-05, 'epoch': 5.88}
{'loss': 0.0479, 'grad_norm': 0.17698566230257942, 'learning_rate': 5e-05, 'epoch': 5.91}
{'loss': 0.0477, 'grad_norm': 0.16214146353938658, 'learning_rate': 5e-05, 'epoch': 5.93}
{'loss': 0.0467, 'grad_norm': 0.12726822409601485, 'learning_rate': 5e-05, 'epoch': 5.96}
{'loss': 0.0476, 'grad_norm': 0.16378790150146078, 'learning_rate': 5e-05, 'epoch': 5.98}
 50%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                  | 2478/4956 [49:41<46:40,  1.13s/it][INFO|gner_trainer.py:60] 2024-11-19 17:55:29,892 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 17:55:29,892 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 17:55:29,892 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4219.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4261.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4220.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4243.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4253.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4235.58it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4248.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3870.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3907.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3923.08it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3915.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3878.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3885.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3902.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1382.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1359.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1356.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1198.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1176.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1022.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1014.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1009.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1022.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 927.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.63it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 920.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.99it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 917.78it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 922.71it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 925.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 924.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1155.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1167.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.96it/s]
{'eval_mit-movie_precision': 0.49411764705862976, 'eval_mit-movie_recall': 0.36521739130424197, 'eval_mit-movie_f1': 0.419999999950985, 'eval_mit-restaurant_precision': 0.35321100917414994, 'eval_mit-restaurant_recall': 0.17620137299767136, 'eval_mit-restaurant_f1': 0.23511450377231163, 'eval_crossner_ai_precision': 0.4285714285713832, 'eval_crossner_ai_recall': 0.5246113989636626, 'eval_crossner_ai_f1': 0.47175305760915964, 'eval_crossner_literature_precision': 0.5189309576836838, 'eval_crossner_literature_recall': 0.4910432033719187, 'eval_crossner_literature_f1': 0.5046020573403461, 'eval_crossner_music_precision': 0.6391982182627588, 'eval_crossner_music_recall': 0.6289262235207722, 'eval_crossner_music_f1': 0.6340206185066577, 'eval_crossner_politics_precision': 0.5369458128078377, 'eval_crossner_politics_recall': 0.5274193548386671, 'eval_crossner_politics_f1': 0.5321399511297817, 'eval_crossner_science_precision': 0.6074144486691437, 'eval_crossner_science_recall': 0.6968375136313307, 'eval_crossner_science_f1': 0.649060436720103, 'eval_average_f1': 0.49238437500419213, 'eval_runtime': 37.2514, 'eval_samples_per_second': 37.582, 'eval_steps_per_second': 0.161, 'epoch': 6.0}
 50%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                  | 2478/4956 [50:18<46:40,  1.13s/it]
[INFO|trainer.py:3812] 2024-11-19 17:56:07,374 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-2478
[INFO|configuration_utils.py:414] 2024-11-19 17:56:07,377 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2478/config.json
[INFO|configuration_utils.py:865] 2024-11-19 17:56:07,377 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2478/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 17:56:08,004 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-2478/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 17:56:08,006 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-2478/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 17:56:08,006 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-2478/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 17:56:08,007 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-2478/spiece.model
[2024-11-19 17:56:08,018] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step2478 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 17:56:08,023] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/mp_rank_00_model_states.pt
[2024-11-19 17:56:08,023] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/mp_rank_00_model_states.pt...
[2024-11-19 17:56:08,657] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/mp_rank_00_model_states.pt.
[2024-11-19 17:56:08,659] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 17:56:09,186] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 17:56:09,186] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-2478/global_step2478/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 17:56:09,186] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2478 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0473, 'grad_norm': 0.11900606921315328, 'learning_rate': 5e-05, 'epoch': 6.0}
{'loss': 0.047, 'grad_norm': 0.1301237682074437, 'learning_rate': 5e-05, 'epoch': 6.03}
{'loss': 0.0461, 'grad_norm': 0.1257730585001685, 'learning_rate': 5e-05, 'epoch': 6.05}
{'loss': 0.0477, 'grad_norm': 0.20148147906337038, 'learning_rate': 5e-05, 'epoch': 6.08}
{'loss': 0.0477, 'grad_norm': 0.12990013523315017, 'learning_rate': 5e-05, 'epoch': 6.1}
{'loss': 0.0468, 'grad_norm': 0.11631304398485828, 'learning_rate': 5e-05, 'epoch': 6.13}
{'loss': 0.0469, 'grad_norm': 0.15779097169447384, 'learning_rate': 5e-05, 'epoch': 6.15}
{'loss': 0.0466, 'grad_norm': 0.12897385645028725, 'learning_rate': 5e-05, 'epoch': 6.17}
{'loss': 0.0464, 'grad_norm': 0.165793416028965, 'learning_rate': 5e-05, 'epoch': 6.2}
{'loss': 0.047, 'grad_norm': 0.16921536686158012, 'learning_rate': 5e-05, 'epoch': 6.22}
{'loss': 0.0467, 'grad_norm': 0.13307380215623327, 'learning_rate': 5e-05, 'epoch': 6.25}
{'loss': 0.0451, 'grad_norm': 0.17664645570481227, 'learning_rate': 5e-05, 'epoch': 6.27}
{'loss': 0.047, 'grad_norm': 0.1565080181282904, 'learning_rate': 5e-05, 'epoch': 6.3}
{'loss': 0.0466, 'grad_norm': 0.24353669045772944, 'learning_rate': 5e-05, 'epoch': 6.32}
{'loss': 0.0455, 'grad_norm': 0.11837060862445156, 'learning_rate': 5e-05, 'epoch': 6.34}
{'loss': 0.0453, 'grad_norm': 0.11078595435265043, 'learning_rate': 5e-05, 'epoch': 6.37}
{'loss': 0.0446, 'grad_norm': 0.2333434690604301, 'learning_rate': 5e-05, 'epoch': 6.39}
{'loss': 0.0455, 'grad_norm': 0.13919368808378924, 'learning_rate': 5e-05, 'epoch': 6.42}
{'loss': 0.0454, 'grad_norm': 0.10194132378485649, 'learning_rate': 5e-05, 'epoch': 6.44}
{'loss': 0.0455, 'grad_norm': 0.14894134565223752, 'learning_rate': 5e-05, 'epoch': 6.46}
{'loss': 0.0459, 'grad_norm': 0.09531412084170611, 'learning_rate': 5e-05, 'epoch': 6.49}
{'loss': 0.0457, 'grad_norm': 0.13124844374188163, 'learning_rate': 5e-05, 'epoch': 6.51}
{'loss': 0.0473, 'grad_norm': 0.23688549331784128, 'learning_rate': 5e-05, 'epoch': 6.54}
{'loss': 0.0459, 'grad_norm': 0.09670768679141524, 'learning_rate': 5e-05, 'epoch': 6.56}
{'loss': 0.0449, 'grad_norm': 0.16339191697343022, 'learning_rate': 5e-05, 'epoch': 6.59}
{'loss': 0.0455, 'grad_norm': 0.12653930416179487, 'learning_rate': 5e-05, 'epoch': 6.61}
{'loss': 0.0452, 'grad_norm': 0.10001859566523415, 'learning_rate': 5e-05, 'epoch': 6.63}
{'loss': 0.0462, 'grad_norm': 0.1347209607621854, 'learning_rate': 5e-05, 'epoch': 6.66}
{'loss': 0.0444, 'grad_norm': 0.13375434982053794, 'learning_rate': 5e-05, 'epoch': 6.68}
{'loss': 0.0449, 'grad_norm': 0.13009161406675757, 'learning_rate': 5e-05, 'epoch': 6.71}
{'loss': 0.045, 'grad_norm': 0.15370742255800446, 'learning_rate': 5e-05, 'epoch': 6.73}
{'loss': 0.0448, 'grad_norm': 0.20109378817660925, 'learning_rate': 5e-05, 'epoch': 6.76}
{'loss': 0.0446, 'grad_norm': 0.15094016970174873, 'learning_rate': 5e-05, 'epoch': 6.78}
{'loss': 0.0439, 'grad_norm': 0.13295935477696552, 'learning_rate': 5e-05, 'epoch': 6.8}
{'loss': 0.0456, 'grad_norm': 0.15772853118742605, 'learning_rate': 5e-05, 'epoch': 6.83}
{'loss': 0.0461, 'grad_norm': 0.13093935956066946, 'learning_rate': 5e-05, 'epoch': 6.85}
{'loss': 0.0443, 'grad_norm': 0.1408188067182437, 'learning_rate': 5e-05, 'epoch': 6.88}
{'loss': 0.0455, 'grad_norm': 0.14105625386241263, 'learning_rate': 5e-05, 'epoch': 6.9}
{'loss': 0.0456, 'grad_norm': 0.10536291852601588, 'learning_rate': 5e-05, 'epoch': 6.92}
{'loss': 0.0456, 'grad_norm': 0.1550144639015451, 'learning_rate': 5e-05, 'epoch': 6.95}
{'loss': 0.0446, 'grad_norm': 0.1297771482960771, 'learning_rate': 5e-05, 'epoch': 6.97}
{'loss': 0.0457, 'grad_norm': 0.11075773432760419, 'learning_rate': 5e-05, 'epoch': 7.0}
 58%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                               | 2891/4956 [58:00<40:50,  1.19s/it][INFO|gner_trainer.py:60] 2024-11-19 18:03:48,917 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:03:48,917 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:03:48,917 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4186.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4206.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4260.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4231.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4249.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4232.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4267.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4195.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3831.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3873.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3922.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3881.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3885.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3860.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3895.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3883.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1383.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1343.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1366.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1361.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1360.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1199.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1187.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1167.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1184.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1175.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1033.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1005.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1012.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1023.08it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 939.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 925.89it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 924.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 913.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 922.60it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1175.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1156.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1163.87it/s]
{'eval_mit-movie_precision': 0.503968253968054, 'eval_mit-movie_recall': 0.3681159420288788, 'eval_mit-movie_f1': 0.42546063646698373, 'eval_mit-restaurant_precision': 0.3624454148470033, 'eval_mit-restaurant_recall': 0.189931350114373, 'eval_mit-restaurant_f1': 0.2492492492040513, 'eval_crossner_ai_precision': 0.4582010582010097, 'eval_crossner_ai_recall': 0.5608808290154713, 'eval_crossner_ai_f1': 0.5043680838176591, 'eval_crossner_literature_precision': 0.5326576576575976, 'eval_crossner_literature_recall': 0.4984193888302952, 'eval_crossner_literature_f1': 0.5149700598302386, 'eval_crossner_music_precision': 0.6795539033456743, 'eval_crossner_music_recall': 0.6676406135865107, 'eval_crossner_music_f1': 0.6735445835903374, 'eval_crossner_politics_precision': 0.5426731078904555, 'eval_crossner_politics_recall': 0.5435483870967304, 'eval_crossner_politics_f1': 0.5431103947928249, 'eval_crossner_science_precision': 0.6300578034681473, 'eval_crossner_science_recall': 0.7131952017447423, 'eval_crossner_science_f1': 0.6690537083900209, 'eval_average_f1': 0.5113938165845879, 'eval_runtime': 37.4995, 'eval_samples_per_second': 37.334, 'eval_steps_per_second': 0.16, 'epoch': 7.0}
 58%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                               | 2891/4956 [58:38<40:50,  1.19s/it]
[INFO|trainer.py:3812] 2024-11-19 18:04:26,649 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-2891
[INFO|configuration_utils.py:414] 2024-11-19 18:04:26,651 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2891/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:04:26,651 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-2891/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:04:27,206 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-2891/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:04:27,207 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-2891/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:04:27,208 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-2891/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:04:27,208 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-2891/spiece.model
[2024-11-19 18:04:27,220] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step2891 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:04:27,226] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/mp_rank_00_model_states.pt
[2024-11-19 18:04:27,226] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/mp_rank_00_model_states.pt...
[2024-11-19 18:04:27,850] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/mp_rank_00_model_states.pt.
[2024-11-19 18:04:27,853] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:04:28,377] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:04:28,377] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-2891/global_step2891/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:04:28,377] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step2891 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0452, 'grad_norm': 0.13987200520814771, 'learning_rate': 5e-05, 'epoch': 7.02}
{'loss': 0.0452, 'grad_norm': 0.16142295954938773, 'learning_rate': 5e-05, 'epoch': 7.05}
{'loss': 0.0462, 'grad_norm': 0.1415439488506112, 'learning_rate': 5e-05, 'epoch': 7.07}
{'loss': 0.0446, 'grad_norm': 0.1332034220090894, 'learning_rate': 5e-05, 'epoch': 7.09}
{'loss': 0.0443, 'grad_norm': 0.3890527746984325, 'learning_rate': 5e-05, 'epoch': 7.12}
{'loss': 0.0447, 'grad_norm': 0.10656383023452544, 'learning_rate': 5e-05, 'epoch': 7.14}
{'loss': 0.0445, 'grad_norm': 0.12343525145088265, 'learning_rate': 5e-05, 'epoch': 7.17}
{'loss': 0.045, 'grad_norm': 0.14032870443352127, 'learning_rate': 5e-05, 'epoch': 7.19}
{'loss': 0.0448, 'grad_norm': 0.12163793664998335, 'learning_rate': 5e-05, 'epoch': 7.22}
{'loss': 0.0446, 'grad_norm': 0.11461231874743256, 'learning_rate': 5e-05, 'epoch': 7.24}
{'loss': 0.0439, 'grad_norm': 0.1374821196114334, 'learning_rate': 5e-05, 'epoch': 7.26}
{'loss': 0.0444, 'grad_norm': 0.1712954514550543, 'learning_rate': 5e-05, 'epoch': 7.29}
{'loss': 0.0444, 'grad_norm': 0.13978229456348581, 'learning_rate': 5e-05, 'epoch': 7.31}
{'loss': 0.0447, 'grad_norm': 0.20421094564280748, 'learning_rate': 5e-05, 'epoch': 7.34}
{'loss': 0.0443, 'grad_norm': 0.11196006059293216, 'learning_rate': 5e-05, 'epoch': 7.36}
{'loss': 0.0441, 'grad_norm': 0.10252199485058561, 'learning_rate': 5e-05, 'epoch': 7.38}
{'loss': 0.0436, 'grad_norm': 0.1188025798902903, 'learning_rate': 5e-05, 'epoch': 7.41}
{'loss': 0.0446, 'grad_norm': 0.17378235868118502, 'learning_rate': 5e-05, 'epoch': 7.43}
{'loss': 0.0444, 'grad_norm': 0.1639535917109866, 'learning_rate': 5e-05, 'epoch': 7.46}
{'loss': 0.0448, 'grad_norm': 0.18281466979996971, 'learning_rate': 5e-05, 'epoch': 7.48}
{'loss': 0.0434, 'grad_norm': 0.09848259354689452, 'learning_rate': 5e-05, 'epoch': 7.51}
{'loss': 0.0437, 'grad_norm': 0.12908018544049518, 'learning_rate': 5e-05, 'epoch': 7.53}
{'loss': 0.0444, 'grad_norm': 0.09260438273068179, 'learning_rate': 5e-05, 'epoch': 7.55}
{'loss': 0.0443, 'grad_norm': 0.12539134010515077, 'learning_rate': 5e-05, 'epoch': 7.58}
{'loss': 0.0434, 'grad_norm': 0.16976208682702695, 'learning_rate': 5e-05, 'epoch': 7.6}
{'loss': 0.0438, 'grad_norm': 0.10146835897486056, 'learning_rate': 5e-05, 'epoch': 7.63}
{'loss': 0.0433, 'grad_norm': 0.12620798190737426, 'learning_rate': 5e-05, 'epoch': 7.65}
{'loss': 0.0445, 'grad_norm': 0.18534295772601195, 'learning_rate': 5e-05, 'epoch': 7.68}
{'loss': 0.0448, 'grad_norm': 0.1338623917930886, 'learning_rate': 5e-05, 'epoch': 7.7}
{'loss': 0.0428, 'grad_norm': 0.11539200734167311, 'learning_rate': 5e-05, 'epoch': 7.72}
{'loss': 0.0437, 'grad_norm': 0.13882789431473902, 'learning_rate': 5e-05, 'epoch': 7.75}
{'loss': 0.0429, 'grad_norm': 0.14051090353735932, 'learning_rate': 5e-05, 'epoch': 7.77}
{'loss': 0.0432, 'grad_norm': 0.23744098846230602, 'learning_rate': 5e-05, 'epoch': 7.8}
{'loss': 0.0435, 'grad_norm': 0.12292974816300525, 'learning_rate': 5e-05, 'epoch': 7.82}
{'loss': 0.0442, 'grad_norm': 0.12226463491142534, 'learning_rate': 5e-05, 'epoch': 7.85}
{'loss': 0.0433, 'grad_norm': 0.15129286879703896, 'learning_rate': 5e-05, 'epoch': 7.87}
{'loss': 0.0437, 'grad_norm': 0.09275894553784822, 'learning_rate': 5e-05, 'epoch': 7.89}
{'loss': 0.0431, 'grad_norm': 0.14100518095486153, 'learning_rate': 5e-05, 'epoch': 7.92}
{'loss': 0.0444, 'grad_norm': 0.15032761975576095, 'learning_rate': 5e-05, 'epoch': 7.94}
{'loss': 0.0442, 'grad_norm': 0.12634239012434303, 'learning_rate': 5e-05, 'epoch': 7.97}
{'loss': 0.0439, 'grad_norm': 0.1704890825311992, 'learning_rate': 5e-05, 'epoch': 7.99}
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 3304/4956 [1:06:20<31:07,  1.13s/it][INFO|gner_trainer.py:60] 2024-11-19 18:12:08,388 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:12:08,388 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:12:08,388 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4209.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4201.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4228.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4234.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4255.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4232.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4227.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4214.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3853.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3826.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3852.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3868.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3923.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3873.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3850.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3842.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1363.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1374.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1360.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1351.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1359.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1363.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1186.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1196.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.47it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1174.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1028.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1026.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1029.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1024.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1016.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 934.77it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.55it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 925.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 934.05it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 932.16it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 925.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1181.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1166.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.61it/s]
{'eval_mit-movie_precision': 0.5171102661594992, 'eval_mit-movie_recall': 0.3942028985506104, 'eval_mit-movie_f1': 0.4473684210033939, 'eval_mit-restaurant_precision': 0.359999999999856, 'eval_mit-restaurant_recall': 0.20594965675052496, 'eval_mit-restaurant_f1': 0.2620087335780824, 'eval_crossner_ai_precision': 0.4509803921568162, 'eval_crossner_ai_recall': 0.5660621761657297, 'eval_crossner_ai_f1': 0.5020103388362804, 'eval_crossner_literature_precision': 0.5392376681613745, 'eval_crossner_literature_recall': 0.5068493150684397, 'eval_crossner_literature_f1': 0.5225420966365745, 'eval_crossner_music_precision': 0.6737381126554006, 'eval_crossner_music_recall': 0.6727538349159479, 'eval_crossner_music_f1': 0.6732456139850386, 'eval_crossner_politics_precision': 0.534003091190067, 'eval_crossner_politics_recall': 0.5572580645160841, 'eval_crossner_politics_f1': 0.5453827939515582, 'eval_crossner_science_precision': 0.5990610328637935, 'eval_crossner_science_recall': 0.6957470010904366, 'eval_crossner_science_f1': 0.6437941472761471, 'eval_average_f1': 0.5137645921810107, 'eval_runtime': 36.5694, 'eval_samples_per_second': 38.283, 'eval_steps_per_second': 0.164, 'epoch': 8.0}
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 3304/4956 [1:06:56<31:07,  1.13s/it]
[INFO|trainer.py:3812] 2024-11-19 18:12:45,190 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-3304
[INFO|configuration_utils.py:414] 2024-11-19 18:12:45,192 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-3304/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:12:45,192 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-3304/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:12:45,748 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-3304/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:12:45,749 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-3304/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:12:45,749 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-3304/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:12:45,750 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-3304/spiece.model
[2024-11-19 18:12:45,762] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step3304 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:12:45,768] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/mp_rank_00_model_states.pt
[2024-11-19 18:12:45,768] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/mp_rank_00_model_states.pt...
[2024-11-19 18:12:46,384] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/mp_rank_00_model_states.pt.
[2024-11-19 18:12:46,386] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:12:46,913] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:12:46,913] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-3304/global_step3304/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:12:46,913] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step3304 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0433, 'grad_norm': 0.10550947639257766, 'learning_rate': 5e-05, 'epoch': 8.01}
{'loss': 0.0426, 'grad_norm': 0.17431316853569787, 'learning_rate': 5e-05, 'epoch': 8.04}
{'loss': 0.0429, 'grad_norm': 0.13424724588330722, 'learning_rate': 5e-05, 'epoch': 8.06}
{'loss': 0.0436, 'grad_norm': 0.2117593437777001, 'learning_rate': 5e-05, 'epoch': 8.09}
{'loss': 0.0431, 'grad_norm': 0.13905942516999373, 'learning_rate': 5e-05, 'epoch': 8.11}
{'loss': 0.0445, 'grad_norm': 0.15418267550882045, 'learning_rate': 5e-05, 'epoch': 8.14}
{'loss': 0.044, 'grad_norm': 0.15735195916968056, 'learning_rate': 5e-05, 'epoch': 8.16}
{'loss': 0.0417, 'grad_norm': 0.1418543696423294, 'learning_rate': 5e-05, 'epoch': 8.18}
{'loss': 0.0437, 'grad_norm': 0.10980714423390729, 'learning_rate': 5e-05, 'epoch': 8.21}
{'loss': 0.0439, 'grad_norm': 0.13306574659073442, 'learning_rate': 5e-05, 'epoch': 8.23}
{'loss': 0.0421, 'grad_norm': 0.1396072366931765, 'learning_rate': 5e-05, 'epoch': 8.26}
{'loss': 0.044, 'grad_norm': 0.1071157819485855, 'learning_rate': 5e-05, 'epoch': 8.28}
{'loss': 0.0435, 'grad_norm': 0.14486980093883334, 'learning_rate': 5e-05, 'epoch': 8.31}
{'loss': 0.0431, 'grad_norm': 0.1353275016217111, 'learning_rate': 5e-05, 'epoch': 8.33}
{'loss': 0.0423, 'grad_norm': 0.15077211248550024, 'learning_rate': 5e-05, 'epoch': 8.35}
{'loss': 0.0428, 'grad_norm': 0.09685541808736084, 'learning_rate': 5e-05, 'epoch': 8.38}
{'loss': 0.0444, 'grad_norm': 0.2653608411101425, 'learning_rate': 5e-05, 'epoch': 8.4}
{'loss': 0.0421, 'grad_norm': 0.1410731420221054, 'learning_rate': 5e-05, 'epoch': 8.43}
{'loss': 0.0427, 'grad_norm': 0.104586527475306, 'learning_rate': 5e-05, 'epoch': 8.45}
{'loss': 0.043, 'grad_norm': 0.12256444103988674, 'learning_rate': 5e-05, 'epoch': 8.47}
{'loss': 0.0434, 'grad_norm': 0.13613792065049393, 'learning_rate': 5e-05, 'epoch': 8.5}
{'loss': 0.0432, 'grad_norm': 0.10602445259252002, 'learning_rate': 5e-05, 'epoch': 8.52}
{'loss': 0.0419, 'grad_norm': 0.12479690354359918, 'learning_rate': 5e-05, 'epoch': 8.55}
{'loss': 0.042, 'grad_norm': 0.09358158481486796, 'learning_rate': 5e-05, 'epoch': 8.57}
{'loss': 0.0417, 'grad_norm': 0.12102578932530948, 'learning_rate': 5e-05, 'epoch': 8.6}
{'loss': 0.0431, 'grad_norm': 0.11618043194613684, 'learning_rate': 5e-05, 'epoch': 8.62}
{'loss': 0.0422, 'grad_norm': 0.13178748900679316, 'learning_rate': 5e-05, 'epoch': 8.64}
{'loss': 0.0423, 'grad_norm': 0.12662962263863536, 'learning_rate': 5e-05, 'epoch': 8.67}
{'loss': 0.0439, 'grad_norm': 0.14396282488067608, 'learning_rate': 5e-05, 'epoch': 8.69}
{'loss': 0.0414, 'grad_norm': 0.14062167534606848, 'learning_rate': 5e-05, 'epoch': 8.72}
{'loss': 0.0419, 'grad_norm': 0.2103814106540764, 'learning_rate': 5e-05, 'epoch': 8.74}
{'loss': 0.0429, 'grad_norm': 0.10846593405003545, 'learning_rate': 5e-05, 'epoch': 8.77}
{'loss': 0.0428, 'grad_norm': 0.22807833409820838, 'learning_rate': 5e-05, 'epoch': 8.79}
{'loss': 0.0413, 'grad_norm': 0.1489428150879033, 'learning_rate': 5e-05, 'epoch': 8.81}
{'loss': 0.042, 'grad_norm': 0.1377719706345579, 'learning_rate': 5e-05, 'epoch': 8.84}
{'loss': 0.0424, 'grad_norm': 0.11398556054370072, 'learning_rate': 5e-05, 'epoch': 8.86}
{'loss': 0.0433, 'grad_norm': 0.10509322564909927, 'learning_rate': 5e-05, 'epoch': 8.89}
{'loss': 0.043, 'grad_norm': 0.12238189984884441, 'learning_rate': 5e-05, 'epoch': 8.91}
{'loss': 0.0425, 'grad_norm': 0.12653898032371158, 'learning_rate': 5e-05, 'epoch': 8.93}
{'loss': 0.0416, 'grad_norm': 0.12551145673555122, 'learning_rate': 5e-05, 'epoch': 8.96}
{'loss': 0.0416, 'grad_norm': 0.10987065184558549, 'learning_rate': 5e-05, 'epoch': 8.98}
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                        | 3717/4956 [1:14:39<23:29,  1.14s/it][INFO|gner_trainer.py:60] 2024-11-19 18:20:27,729 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:20:27,730 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:20:27,730 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4204.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4261.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4229.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4246.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4189.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4225.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4277.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4220.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3837.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3922.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3851.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3900.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3863.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3837.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3935.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3861.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1355.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1370.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1359.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1325.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1363.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1326.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1318.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1309.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1176.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1188.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1192.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1176.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1181.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1193.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1173.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1031.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1024.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1016.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1029.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1016.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1009.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 937.56it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 933.25it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 920.58it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 933.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 924.50it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.84it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 916.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1173.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1163.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1166.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1174.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1153.37it/s]
{'eval_mit-movie_precision': 0.49438202247172497, 'eval_mit-movie_recall': 0.382608695652063, 'eval_mit-movie_f1': 0.4313725489702791, 'eval_mit-restaurant_precision': 0.35968379446626103, 'eval_mit-restaurant_recall': 0.20823798626997525, 'eval_mit-restaurant_f1': 0.26376811589550814, 'eval_crossner_ai_precision': 0.473456121343394, 'eval_crossner_ai_recall': 0.5660621761657297, 'eval_crossner_ai_f1': 0.5156342182394215, 'eval_crossner_literature_precision': 0.5429864253393051, 'eval_crossner_literature_recall': 0.5057955742886716, 'eval_crossner_literature_f1': 0.5237315875113805, 'eval_crossner_music_precision': 0.6807095343680206, 'eval_crossner_music_recall': 0.6727538349159479, 'eval_crossner_music_f1': 0.6767083026685413, 'eval_crossner_politics_precision': 0.5380304243394285, 'eval_crossner_politics_recall': 0.541935483870924, 'eval_crossner_politics_f1': 0.5399758938832638, 'eval_crossner_science_precision': 0.5969581749048862, 'eval_crossner_science_recall': 0.6848418756814956, 'eval_crossner_science_f1': 0.6378872523625623, 'eval_average_f1': 0.512725417075851, 'eval_runtime': 36.2622, 'eval_samples_per_second': 38.608, 'eval_steps_per_second': 0.165, 'epoch': 9.0}
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                        | 3717/4956 [1:15:15<23:29,  1.14s/it]
[INFO|trainer.py:3812] 2024-11-19 18:21:04,231 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-3717
[INFO|configuration_utils.py:414] 2024-11-19 18:21:04,233 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-3717/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:21:04,233 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-3717/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:21:04,791 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-3717/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:21:04,793 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-3717/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:21:04,793 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-3717/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:21:04,794 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-3717/spiece.model
[2024-11-19 18:21:04,805] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step3717 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:21:04,811] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/mp_rank_00_model_states.pt
[2024-11-19 18:21:04,811] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/mp_rank_00_model_states.pt...
[2024-11-19 18:21:05,436] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/mp_rank_00_model_states.pt.
[2024-11-19 18:21:05,437] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:21:06,062] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:21:06,062] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-3717/global_step3717/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:21:06,062] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step3717 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0415, 'grad_norm': 0.10208229326753107, 'learning_rate': 5e-05, 'epoch': 9.01}
{'loss': 0.0422, 'grad_norm': 0.10526566910257955, 'learning_rate': 5e-05, 'epoch': 9.03}
{'loss': 0.0429, 'grad_norm': 0.1476589351490638, 'learning_rate': 5e-05, 'epoch': 9.06}
{'loss': 0.0418, 'grad_norm': 0.17698627270926973, 'learning_rate': 5e-05, 'epoch': 9.08}
{'loss': 0.0419, 'grad_norm': 0.1497722894084238, 'learning_rate': 5e-05, 'epoch': 9.1}
{'loss': 0.0418, 'grad_norm': 0.12088821256966178, 'learning_rate': 5e-05, 'epoch': 9.13}
{'loss': 0.0411, 'grad_norm': 0.1339544332318691, 'learning_rate': 5e-05, 'epoch': 9.15}
{'loss': 0.0423, 'grad_norm': 0.09051526018830082, 'learning_rate': 5e-05, 'epoch': 9.18}
{'loss': 0.0421, 'grad_norm': 0.10436917131675744, 'learning_rate': 5e-05, 'epoch': 9.2}
{'loss': 0.0418, 'grad_norm': 0.13001477557586655, 'learning_rate': 5e-05, 'epoch': 9.23}
{'loss': 0.0421, 'grad_norm': 0.13892050737517203, 'learning_rate': 5e-05, 'epoch': 9.25}
{'loss': 0.0413, 'grad_norm': 0.21554391518109572, 'learning_rate': 5e-05, 'epoch': 9.27}
{'loss': 0.0418, 'grad_norm': 0.21791827940359282, 'learning_rate': 5e-05, 'epoch': 9.3}
{'loss': 0.0415, 'grad_norm': 0.16468835846751387, 'learning_rate': 5e-05, 'epoch': 9.32}
{'loss': 0.0427, 'grad_norm': 0.12992721888412948, 'learning_rate': 5e-05, 'epoch': 9.35}
{'loss': 0.0421, 'grad_norm': 0.10955946132490361, 'learning_rate': 5e-05, 'epoch': 9.37}
{'loss': 0.0409, 'grad_norm': 0.13705029478145797, 'learning_rate': 5e-05, 'epoch': 9.39}
{'loss': 0.0423, 'grad_norm': 0.16461474140582644, 'learning_rate': 5e-05, 'epoch': 9.42}
{'loss': 0.0411, 'grad_norm': 0.16222759325493163, 'learning_rate': 5e-05, 'epoch': 9.44}
{'loss': 0.0428, 'grad_norm': 0.12207172774448159, 'learning_rate': 5e-05, 'epoch': 9.47}
{'loss': 0.0417, 'grad_norm': 0.13539716384514922, 'learning_rate': 5e-05, 'epoch': 9.49}
{'loss': 0.0409, 'grad_norm': 0.18841659501109673, 'learning_rate': 5e-05, 'epoch': 9.52}
{'loss': 0.0407, 'grad_norm': 0.11165373434243063, 'learning_rate': 5e-05, 'epoch': 9.54}
{'loss': 0.0412, 'grad_norm': 0.11237387391901003, 'learning_rate': 5e-05, 'epoch': 9.56}
{'loss': 0.0405, 'grad_norm': 0.09493037546815994, 'learning_rate': 5e-05, 'epoch': 9.59}
{'loss': 0.0418, 'grad_norm': 0.12598162648276784, 'learning_rate': 5e-05, 'epoch': 9.61}
{'loss': 0.0409, 'grad_norm': 0.17007566486168688, 'learning_rate': 5e-05, 'epoch': 9.64}
{'loss': 0.0412, 'grad_norm': 0.1209035348510934, 'learning_rate': 5e-05, 'epoch': 9.66}
{'loss': 0.0416, 'grad_norm': 0.09779644915934019, 'learning_rate': 5e-05, 'epoch': 9.69}
{'loss': 0.0407, 'grad_norm': 0.12947306139334905, 'learning_rate': 5e-05, 'epoch': 9.71}
{'loss': 0.0427, 'grad_norm': 0.15654291473026022, 'learning_rate': 5e-05, 'epoch': 9.73}
{'loss': 0.0411, 'grad_norm': 0.12486647761272658, 'learning_rate': 5e-05, 'epoch': 9.76}
{'loss': 0.0408, 'grad_norm': 0.12867642636057952, 'learning_rate': 5e-05, 'epoch': 9.78}
{'loss': 0.0417, 'grad_norm': 0.11526265039906806, 'learning_rate': 5e-05, 'epoch': 9.81}
{'loss': 0.0417, 'grad_norm': 0.1102504182302669, 'learning_rate': 5e-05, 'epoch': 9.83}
{'loss': 0.0412, 'grad_norm': 0.10720438180611251, 'learning_rate': 5e-05, 'epoch': 9.85}
{'loss': 0.0415, 'grad_norm': 0.11308620778975527, 'learning_rate': 5e-05, 'epoch': 9.88}
{'loss': 0.0406, 'grad_norm': 0.13464352010275155, 'learning_rate': 5e-05, 'epoch': 9.9}
{'loss': 0.0403, 'grad_norm': 0.10462398773134356, 'learning_rate': 5e-05, 'epoch': 9.93}
{'loss': 0.0416, 'grad_norm': 0.1419519561589291, 'learning_rate': 5e-05, 'epoch': 9.95}
{'loss': 0.0408, 'grad_norm': 0.17382896080244772, 'learning_rate': 5e-05, 'epoch': 9.98}
{'loss': 0.0408, 'grad_norm': 0.1466857670160297, 'learning_rate': 5e-05, 'epoch': 10.0}
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 4130/4956 [1:22:58<15:20,  1.11s/it][INFO|gner_trainer.py:60] 2024-11-19 18:28:46,904 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:28:46,904 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:28:46,905 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4236.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4267.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4185.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4166.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4260.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4230.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4243.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4204.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3904.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3924.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3848.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3805.82it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3894.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3872.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3886.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1371.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1362.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1346.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1354.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1347.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1353.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1359.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1193.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1175.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1033.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1016.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1012.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1006.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1027.79it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 938.54it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.59it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.01it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.70it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 919.97it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 912.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 920.61it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 928.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1185.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1172.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1167.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1161.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1157.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1160.80it/s]
{'eval_mit-movie_precision': 0.5249042145591859, 'eval_mit-movie_recall': 0.3971014492752472, 'eval_mit-movie_f1': 0.45214521447226363, 'eval_mit-restaurant_precision': 0.3830645161288778, 'eval_mit-restaurant_recall': 0.21739130434777634, 'eval_mit-restaurant_f1': 0.277372262727448, 'eval_crossner_ai_precision': 0.4481675392669688, 'eval_crossner_ai_recall': 0.5544041450776483, 'eval_crossner_ai_f1': 0.49565720898350923, 'eval_crossner_literature_precision': 0.5598194130924876, 'eval_crossner_literature_recall': 0.5226554267649607, 'eval_crossner_literature_f1': 0.5405994549908719, 'eval_crossner_music_precision': 0.6852122986822339, 'eval_crossner_music_recall': 0.6837107377647419, 'eval_crossner_music_f1': 0.6844606946483046, 'eval_crossner_politics_precision': 0.5484133441822173, 'eval_crossner_politics_recall': 0.5435483870967304, 'eval_crossner_politics_f1': 0.5459700283015161, 'eval_crossner_science_precision': 0.6202898550724039, 'eval_crossner_science_recall': 0.700109051254013, 'eval_crossner_science_f1': 0.6577868851960169, 'eval_average_f1': 0.5219988213314186, 'eval_runtime': 36.3873, 'eval_samples_per_second': 38.475, 'eval_steps_per_second': 0.165, 'epoch': 10.0}
 83%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                     | 4130/4956 [1:23:35<15:20,  1.11s/it]
[INFO|trainer.py:3812] 2024-11-19 18:29:23,515 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-4130
[INFO|configuration_utils.py:414] 2024-11-19 18:29:23,517 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4130/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:29:23,518 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4130/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:29:24,082 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-4130/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:29:24,084 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-4130/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:29:24,084 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-4130/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:29:24,085 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-4130/spiece.model
[2024-11-19 18:29:24,097] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step4130 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:29:24,103] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/mp_rank_00_model_states.pt
[2024-11-19 18:29:24,103] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/mp_rank_00_model_states.pt...
[2024-11-19 18:29:24,734] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/mp_rank_00_model_states.pt.
[2024-11-19 18:29:24,737] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:29:25,374] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:29:25,374] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-4130/global_step4130/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:29:25,374] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step4130 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0399, 'grad_norm': 0.11956532793519363, 'learning_rate': 5e-05, 'epoch': 10.02}
{'loss': 0.0406, 'grad_norm': 0.1292277791121827, 'learning_rate': 5e-05, 'epoch': 10.05}
{'loss': 0.0406, 'grad_norm': 0.12137527580676775, 'learning_rate': 5e-05, 'epoch': 10.07}
{'loss': 0.0418, 'grad_norm': 0.11212937312916853, 'learning_rate': 5e-05, 'epoch': 10.1}
{'loss': 0.0413, 'grad_norm': 0.14326289747880488, 'learning_rate': 5e-05, 'epoch': 10.12}
{'loss': 0.04, 'grad_norm': 0.08447142142567479, 'learning_rate': 5e-05, 'epoch': 10.15}
{'loss': 0.0405, 'grad_norm': 0.12469279641898703, 'learning_rate': 5e-05, 'epoch': 10.17}
{'loss': 0.0409, 'grad_norm': 0.17459202195884993, 'learning_rate': 5e-05, 'epoch': 10.19}
{'loss': 0.0409, 'grad_norm': 0.1670402100874527, 'learning_rate': 5e-05, 'epoch': 10.22}
{'loss': 0.0404, 'grad_norm': 0.13801007783716548, 'learning_rate': 5e-05, 'epoch': 10.24}
{'loss': 0.0399, 'grad_norm': 0.09786597143900552, 'learning_rate': 5e-05, 'epoch': 10.27}
{'loss': 0.0408, 'grad_norm': 0.14841002912804332, 'learning_rate': 5e-05, 'epoch': 10.29}
{'loss': 0.0412, 'grad_norm': 0.09908039685718636, 'learning_rate': 5e-05, 'epoch': 10.31}
{'loss': 0.0411, 'grad_norm': 0.1244880354553667, 'learning_rate': 5e-05, 'epoch': 10.34}
{'loss': 0.0409, 'grad_norm': 0.1250274076812921, 'learning_rate': 5e-05, 'epoch': 10.36}
{'loss': 0.0412, 'grad_norm': 0.12231943268833215, 'learning_rate': 5e-05, 'epoch': 10.39}
{'loss': 0.0416, 'grad_norm': 0.10764880486117043, 'learning_rate': 5e-05, 'epoch': 10.41}
{'loss': 0.0392, 'grad_norm': 0.09411591407343137, 'learning_rate': 5e-05, 'epoch': 10.44}
{'loss': 0.0413, 'grad_norm': 0.10324406992696859, 'learning_rate': 5e-05, 'epoch': 10.46}
{'loss': 0.0401, 'grad_norm': 0.12518944391787723, 'learning_rate': 5e-05, 'epoch': 10.48}
{'loss': 0.0403, 'grad_norm': 0.14769961764748452, 'learning_rate': 5e-05, 'epoch': 10.51}
{'loss': 0.0403, 'grad_norm': 0.10046053448661564, 'learning_rate': 5e-05, 'epoch': 10.53}
{'loss': 0.0404, 'grad_norm': 0.0950942425008375, 'learning_rate': 5e-05, 'epoch': 10.56}
{'loss': 0.041, 'grad_norm': 0.11736565002676581, 'learning_rate': 5e-05, 'epoch': 10.58}
{'loss': 0.0405, 'grad_norm': 0.10969671125805927, 'learning_rate': 5e-05, 'epoch': 10.61}
{'loss': 0.0412, 'grad_norm': 0.12614105633600836, 'learning_rate': 5e-05, 'epoch': 10.63}
{'loss': 0.0408, 'grad_norm': 0.14159989191582564, 'learning_rate': 5e-05, 'epoch': 10.65}
{'loss': 0.0405, 'grad_norm': 0.1060466914385422, 'learning_rate': 5e-05, 'epoch': 10.68}
{'loss': 0.0403, 'grad_norm': 0.17544942902322344, 'learning_rate': 5e-05, 'epoch': 10.7}
{'loss': 0.0402, 'grad_norm': 0.12823890850326589, 'learning_rate': 5e-05, 'epoch': 10.73}
{'loss': 0.0413, 'grad_norm': 0.18073097227185833, 'learning_rate': 5e-05, 'epoch': 10.75}
{'loss': 0.0403, 'grad_norm': 0.1336345337079756, 'learning_rate': 5e-05, 'epoch': 10.77}
{'loss': 0.0396, 'grad_norm': 0.09991750555498917, 'learning_rate': 5e-05, 'epoch': 10.8}
{'loss': 0.0396, 'grad_norm': 0.11855820268827473, 'learning_rate': 5e-05, 'epoch': 10.82}
{'loss': 0.0404, 'grad_norm': 0.1060122332947521, 'learning_rate': 5e-05, 'epoch': 10.85}
{'loss': 0.0407, 'grad_norm': 0.12788649550606357, 'learning_rate': 5e-05, 'epoch': 10.87}
{'loss': 0.0407, 'grad_norm': 0.1292953470952322, 'learning_rate': 5e-05, 'epoch': 10.9}
{'loss': 0.0404, 'grad_norm': 0.1247417232917868, 'learning_rate': 5e-05, 'epoch': 10.92}
{'loss': 0.0397, 'grad_norm': 0.14012338661282506, 'learning_rate': 5e-05, 'epoch': 10.94}
{'loss': 0.0397, 'grad_norm': 0.11880519816939263, 'learning_rate': 5e-05, 'epoch': 10.97}
{'loss': 0.04, 'grad_norm': 0.13858949874069015, 'learning_rate': 5e-05, 'epoch': 10.99}
 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 4543/4956 [1:31:18<08:00,  1.16s/it][INFO|gner_trainer.py:60] 2024-11-19 18:37:06,620 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:37:06,620 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:37:06,620 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4242.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4214.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4213.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4190.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4188.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4224.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4182.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4202.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3875.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3852.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3837.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3827.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3844.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3824.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3804.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3826.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1372.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1356.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1349.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1353.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1352.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1352.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1194.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1175.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1174.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1030.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1014.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1011.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1015.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1013.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 934.87it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.06it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.00it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 917.95it/s]
  0%|                                                                                                                                                                                                                                                | 0/200 [00:00<?, ?it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 916.98it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1168.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1173.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1160.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1157.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1157.84it/s]
{'eval_mit-movie_precision': 0.5340501792112782, 'eval_mit-movie_recall': 0.4318840579708893, 'eval_mit-movie_f1': 0.4775641025145088, 'eval_mit-restaurant_precision': 0.352517985611384, 'eval_mit-restaurant_recall': 0.22425629290612717, 'eval_mit-restaurant_f1': 0.27412587407827, 'eval_crossner_ai_precision': 0.43892750744782133, 'eval_crossner_ai_recall': 0.5725388601035527, 'eval_crossner_ai_f1': 0.496908375442666, 'eval_crossner_literature_precision': 0.5456521739129842, 'eval_crossner_literature_recall': 0.5289778714435691, 'eval_crossner_literature_f1': 0.537185660731121, 'eval_crossner_music_precision': 0.6955266955266454, 'eval_crossner_music_recall': 0.7041636230824906, 'eval_crossner_music_f1': 0.6998185117466842, 'eval_crossner_politics_precision': 0.5358519660755177, 'eval_crossner_politics_recall': 0.5604838709676967, 'eval_crossner_politics_f1': 0.5478912100406403, 'eval_crossner_science_precision': 0.5816326530611705, 'eval_crossner_science_recall': 0.6837513631406015, 'eval_crossner_science_f1': 0.6285714285216911, 'eval_average_f1': 0.5231521661536545, 'eval_runtime': 36.8052, 'eval_samples_per_second': 38.038, 'eval_steps_per_second': 0.163, 'epoch': 11.0}
 92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                  | 4543/4956 [1:31:55<08:00,  1.16s/it]
[INFO|trainer.py:3812] 2024-11-19 18:37:43,660 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-4543
[INFO|configuration_utils.py:414] 2024-11-19 18:37:43,662 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4543/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:37:43,662 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4543/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:37:44,226 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-4543/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:37:44,228 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-4543/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:37:44,228 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-4543/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:37:44,229 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-4543/spiece.model
[2024-11-19 18:37:44,241] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step4543 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:37:44,247] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/mp_rank_00_model_states.pt
[2024-11-19 18:37:44,247] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/mp_rank_00_model_states.pt...
[2024-11-19 18:37:44,877] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/mp_rank_00_model_states.pt.
[2024-11-19 18:37:44,879] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:37:45,406] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:37:45,406] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-4543/global_step4543/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:37:45,406] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step4543 is ready now!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: c10d::broadcast_: an autograd kernel was not registered to the Autograd key(s) but we are trying to backprop through it. This may lead to silently incorrect behavior. This behavior is deprecated and will be removed in a future version of PyTorch. If your operator is differentiable, please ensure you have registered an autograd kernel to the correct Autograd key (e.g. DispatchKey::Autograd, DispatchKey::CompositeImplicitAutograd). If your operator is not differentiable, or to squash this warning and use the previous behavior, please register torch::CppFunction::makeFallthrough() to DispatchKey::Autograd. (Triggered internally at ../torch/csrc/autograd/autograd_not_implemented_fallback.cpp:63.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
{'loss': 0.0408, 'grad_norm': 0.1389944394859607, 'learning_rate': 5e-05, 'epoch': 11.02}
{'loss': 0.0394, 'grad_norm': 0.11220405050091768, 'learning_rate': 5e-05, 'epoch': 11.04}
{'loss': 0.0392, 'grad_norm': 0.11170331574910758, 'learning_rate': 5e-05, 'epoch': 11.07}
{'loss': 0.0396, 'grad_norm': 0.10104207896200923, 'learning_rate': 5e-05, 'epoch': 11.09}
{'loss': 0.0397, 'grad_norm': 0.11971365204070854, 'learning_rate': 5e-05, 'epoch': 11.11}
{'loss': 0.0391, 'grad_norm': 0.15470164961593438, 'learning_rate': 5e-05, 'epoch': 11.14}
{'loss': 0.0392, 'grad_norm': 0.1408518577300489, 'learning_rate': 5e-05, 'epoch': 11.16}
{'loss': 0.0402, 'grad_norm': 0.17164756617620744, 'learning_rate': 5e-05, 'epoch': 11.19}
{'loss': 0.0405, 'grad_norm': 0.1618224327608929, 'learning_rate': 5e-05, 'epoch': 11.21}
{'loss': 0.0394, 'grad_norm': 0.14277658628652262, 'learning_rate': 5e-05, 'epoch': 11.23}
{'loss': 0.0392, 'grad_norm': 0.1675599635226404, 'learning_rate': 5e-05, 'epoch': 11.26}
{'loss': 0.0393, 'grad_norm': 0.10088394979625954, 'learning_rate': 5e-05, 'epoch': 11.28}
{'loss': 0.0393, 'grad_norm': 0.1390433440248248, 'learning_rate': 5e-05, 'epoch': 11.31}
{'loss': 0.0394, 'grad_norm': 0.17806920800740772, 'learning_rate': 5e-05, 'epoch': 11.33}
{'loss': 0.0392, 'grad_norm': 0.09552505041164534, 'learning_rate': 5e-05, 'epoch': 11.36}
{'loss': 0.0401, 'grad_norm': 0.15154602192250127, 'learning_rate': 5e-05, 'epoch': 11.38}
{'loss': 0.04, 'grad_norm': 0.14705207174593435, 'learning_rate': 5e-05, 'epoch': 11.4}
{'loss': 0.0394, 'grad_norm': 0.18280967726525232, 'learning_rate': 5e-05, 'epoch': 11.43}
{'loss': 0.0404, 'grad_norm': 0.1472780723269447, 'learning_rate': 5e-05, 'epoch': 11.45}
{'loss': 0.0392, 'grad_norm': 0.10681511137249504, 'learning_rate': 5e-05, 'epoch': 11.48}
{'loss': 0.039, 'grad_norm': 0.1272448415980061, 'learning_rate': 5e-05, 'epoch': 11.5}
{'loss': 0.0391, 'grad_norm': 0.13109599257041224, 'learning_rate': 5e-05, 'epoch': 11.53}
{'loss': 0.0406, 'grad_norm': 0.12277762912897794, 'learning_rate': 5e-05, 'epoch': 11.55}
{'loss': 0.0393, 'grad_norm': 0.12376449616857352, 'learning_rate': 5e-05, 'epoch': 11.57}
{'loss': 0.0394, 'grad_norm': 0.09215187358230943, 'learning_rate': 5e-05, 'epoch': 11.6}
{'loss': 0.0403, 'grad_norm': 0.13656630191049932, 'learning_rate': 5e-05, 'epoch': 11.62}
{'loss': 0.0391, 'grad_norm': 0.1061710358755651, 'learning_rate': 5e-05, 'epoch': 11.65}
{'loss': 0.0402, 'grad_norm': 0.13807843388912144, 'learning_rate': 5e-05, 'epoch': 11.67}
{'loss': 0.0401, 'grad_norm': 0.11334350125138527, 'learning_rate': 5e-05, 'epoch': 11.69}
{'loss': 0.0397, 'grad_norm': 0.1356753932813452, 'learning_rate': 5e-05, 'epoch': 11.72}
{'loss': 0.039, 'grad_norm': 0.10286930582416785, 'learning_rate': 5e-05, 'epoch': 11.74}
{'loss': 0.0394, 'grad_norm': 0.11122402125587312, 'learning_rate': 5e-05, 'epoch': 11.77}
{'loss': 0.0389, 'grad_norm': 0.12850388673320162, 'learning_rate': 5e-05, 'epoch': 11.79}
{'loss': 0.0398, 'grad_norm': 0.20941980402098295, 'learning_rate': 5e-05, 'epoch': 11.82}
{'loss': 0.0385, 'grad_norm': 0.09069390369990066, 'learning_rate': 5e-05, 'epoch': 11.84}
{'loss': 0.0399, 'grad_norm': 0.10886347740758211, 'learning_rate': 5e-05, 'epoch': 11.86}
{'loss': 0.0392, 'grad_norm': 0.13840892199695187, 'learning_rate': 5e-05, 'epoch': 11.89}
{'loss': 0.039, 'grad_norm': 0.13023063865981674, 'learning_rate': 5e-05, 'epoch': 11.91}
{'loss': 0.0393, 'grad_norm': 0.12175584724193798, 'learning_rate': 5e-05, 'epoch': 11.94}
{'loss': 0.0388, 'grad_norm': 0.10925081133786713, 'learning_rate': 5e-05, 'epoch': 11.96}
{'loss': 0.0391, 'grad_norm': 0.08711851910208107, 'learning_rate': 5e-05, 'epoch': 11.99}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4956/4956 [1:39:38<00:00,  1.11s/it][INFO|trainer.py:3812] 2024-11-19 18:45:26,595 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-4956
[INFO|configuration_utils.py:414] 2024-11-19 18:45:26,597 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4956/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:45:26,598 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4956/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:45:27,155 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-4956/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:45:27,157 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-4956/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:45:27,157 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-4956/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:45:27,158 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-4956/spiece.model
[2024-11-19 18:45:27,170] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step4956 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:45:27,176] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt
[2024-11-19 18:45:27,176] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt...
[2024-11-19 18:45:27,804] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt.
[2024-11-19 18:45:27,806] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:45:28,343] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:45:28,344] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:45:28,344] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step4956 is ready now!
[INFO|gner_trainer.py:60] 2024-11-19 18:45:28,454 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:45:28,454 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:45:28,454 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4212.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4273.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4254.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4233.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3834.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3864.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3838.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3840.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4275.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4300.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4227.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4274.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1360.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3895.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3922.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1359.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3857.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3874.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1365.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1363.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1356.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1181.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1364.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1184.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1196.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1180.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1183.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1020.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1033.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1017.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1016.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1008.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.94it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 927.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 923.02it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 927.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 939.43it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 921.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1161.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 916.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1164.15it/s]
{'eval_mit-movie_precision': 0.5576208178436589, 'eval_mit-movie_recall': 0.43478260869552615, 'eval_mit-movie_f1': 0.4885993484848089, 'eval_mit-restaurant_precision': 0.3820224719099693, 'eval_mit-restaurant_recall': 0.2334096109839283, 'eval_mit-restaurant_f1': 0.2897727272255605, 'eval_crossner_ai_precision': 0.471957671957622, 'eval_crossner_ai_recall': 0.5777202072538111, 'eval_crossner_ai_f1': 0.5195107745573194, 'eval_crossner_literature_precision': 0.5544217687074201, 'eval_crossner_literature_recall': 0.5152792413065842, 'eval_crossner_literature_f1': 0.5341343527626792, 'eval_crossner_music_precision': 0.6882738528768617, 'eval_crossner_music_recall': 0.6902848794740182, 'eval_crossner_music_f1': 0.6892778992934946, 'eval_crossner_politics_precision': 0.5462590506837854, 'eval_crossner_politics_recall': 0.5475806451612462, 'eval_crossner_politics_f1': 0.5469190494868066, 'eval_crossner_science_precision': 0.6129032258063934, 'eval_crossner_science_recall': 0.7044711014175894, 'eval_crossner_science_f1': 0.6555048198385566, 'eval_average_f1': 0.5319598530927465, 'eval_runtime': 36.2959, 'eval_samples_per_second': 38.572, 'eval_steps_per_second': 0.165, 'epoch': 12.0}
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1189.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1171.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1166.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1160.96it/s]
[INFO|trainer.py:3812] 2024-11-19 18:46:05,134 >> Saving model checkpoint to output/flan-t5-base-task-adaptation/checkpoint-4956
[INFO|configuration_utils.py:414] 2024-11-19 18:46:05,136 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4956/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:46:05,136 >> Configuration saved in output/flan-t5-base-task-adaptation/checkpoint-4956/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:46:05,891 >> Model weights saved in output/flan-t5-base-task-adaptation/checkpoint-4956/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:46:05,893 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/checkpoint-4956/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:46:05,893 >> Special tokens file saved in output/flan-t5-base-task-adaptation/checkpoint-4956/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:46:05,894 >> Copy vocab file to output/flan-t5-base-task-adaptation/checkpoint-4956/spiece.model
[2024-11-19 18:46:05,906] [INFO] [logging.py:96:log_dist] [Rank 0] [Torch] Checkpoint global_step4956 is about to be saved!
/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.11/site-packages/torch/nn/modules/module.py:1898: UserWarning: Positional args are being deprecated, use kwargs instead. Refer to https://pytorch.org/docs/master/generated/torch.nn.Module.html#torch.nn.Module.state_dict for details.
  warnings.warn(
[2024-11-19 18:46:05,912] [INFO] [logging.py:96:log_dist] [Rank 0] Saving model checkpoint: output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt
[2024-11-19 18:46:05,912] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt...
[2024-11-19 18:46:06,685] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt.
[2024-11-19 18:46:06,687] [INFO] [torch_checkpoint_engine.py:21:save] [Torch] Saving output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:46:07,396] [INFO] [torch_checkpoint_engine.py:23:save] [Torch] Saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:46:07,396] [INFO] [engine.py:3477:_save_zero_checkpoint] bf16_zero checkpoint saved output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt
[2024-11-19 18:46:07,396] [INFO] [torch_checkpoint_engine.py:33:commit] [Torch] Checkpoint global_step4956 is ready now!
[INFO|trainer.py:2591] 2024-11-19 18:46:07,455 >>

Training completed. Do not forget to share your model on huggingface.co/models =)


[INFO|trainer.py:2829] 2024-11-19 18:46:07,455 >> Loading best model from output/flan-t5-base-task-adaptation/checkpoint-4956 (score: 0.5319598530927465).
[INFO|deepspeed.py:436] 2024-11-19 18:46:07,456 >> Attempting to resume from output/flan-t5-base-task-adaptation/checkpoint-4956
[2024-11-19 18:46:07,456] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt...
[2024-11-19 18:46:07,729] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt.
[2024-11-19 18:46:07,752] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt...
[2024-11-19 18:46:07,978] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/mp_rank_00_model_states.pt.
[2024-11-19 18:46:08,145] [INFO] [torch_checkpoint_engine.py:27:load] [Torch] Loading checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt...
[2024-11-19 18:46:08,236] [INFO] [torch_checkpoint_engine.py:29:load] [Torch] Loaded checkpoint from output/flan-t5-base-task-adaptation/checkpoint-4956/global_step4956/bf16_zero_pp_rank_0_mp_rank_00_optim_states.pt.
[2024-11-19 18:46:08,237] [INFO] [engine.py:3019:_get_all_zero_checkpoint_state_dicts] successfully read 8 ZeRO state_dicts for rank 0
[2024-11-19 18:46:08,294] [INFO] [engine.py:2951:_load_zero_checkpoint] loading 8 zero partition checkpoints for rank 0
{'train_runtime': 6020.0578, 'train_samples_per_second': 210.614, 'train_steps_per_second': 0.823, 'train_loss': 0.05633618198545639, 'epoch': 12.0}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4956/4956 [1:40:20<00:00,  1.21s/it]
[INFO|trainer.py:3812] 2024-11-19 18:46:08,491 >> Saving model checkpoint to output/flan-t5-base-task-adaptation
[INFO|configuration_utils.py:414] 2024-11-19 18:46:08,493 >> Configuration saved in output/flan-t5-base-task-adaptation/config.json
[INFO|configuration_utils.py:865] 2024-11-19 18:46:08,493 >> Configuration saved in output/flan-t5-base-task-adaptation/generation_config.json
[INFO|modeling_utils.py:3035] 2024-11-19 18:46:09,058 >> Model weights saved in output/flan-t5-base-task-adaptation/model.safetensors
[INFO|tokenization_utils_base.py:2646] 2024-11-19 18:46:09,061 >> tokenizer config file saved in output/flan-t5-base-task-adaptation/tokenizer_config.json
[INFO|tokenization_utils_base.py:2655] 2024-11-19 18:46:09,061 >> Special tokens file saved in output/flan-t5-base-task-adaptation/special_tokens_map.json
[INFO|tokenization_t5_fast.py:175] 2024-11-19 18:46:09,062 >> Copy vocab file to output/flan-t5-base-task-adaptation/spiece.model
***** train metrics *****
  epoch                    =        12.0
  total_flos               = 684172904GF
  train_loss               =      0.0563
  train_runtime            =  1:40:20.05
  train_samples            =      105659
  train_samples_per_second =     210.614
  train_steps_per_second   =       0.823
11/19/2024 18:46:09 - INFO - __main__ - Metrics {'train_runtime': 6020.0578, 'train_samples_per_second': 210.614, 'train_steps_per_second': 0.823, 'total_flos': 7.346250619730002e+17, 'train_loss': 0.05633618198545639, 'epoch': 12.0, 'train_samples': 105659}
11/19/2024 18:46:09 - INFO - __main__ - *** Evaluate ***
[INFO|gner_trainer.py:60] 2024-11-19 18:46:09,081 >> ***** Running Evaluation *****
[INFO|gner_trainer.py:62] 2024-11-19 18:46:09,081 >>   Num examples = 1400
[INFO|gner_trainer.py:65] 2024-11-19 18:46:09,081 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4204.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4232.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4208.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4263.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4214.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3882.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3833.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3830.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3885.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3830.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4310.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4264.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 4240.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3844.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3873.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1358.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1357.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1367.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1342.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 3871.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1352.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1349.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1362.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1355.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1192.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1186.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1166.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1179.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1182.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1023.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1015.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1025.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1007.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1018.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1019.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1006.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1014.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 936.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 932.09it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 922.15it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 922.18it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 926.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 927.07it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 916.04it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 920.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1177.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1178.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1174.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1165.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:35<00:00,  5.84s/it]
***** eval metrics *****
  epoch                              =       12.0
  eval_average_f1                    =      0.532
  eval_crossner_ai_f1                =     0.5195
  eval_crossner_ai_precision         =      0.472
  eval_crossner_ai_recall            =     0.5777
  eval_crossner_literature_f1        =     0.5341
  eval_crossner_literature_precision =     0.5544
  eval_crossner_literature_recall    =     0.5153
  eval_crossner_music_f1             =     0.6893
  eval_crossner_music_precision      =     0.6883
  eval_crossner_music_recall         =     0.6903
  eval_crossner_politics_f1          =     0.5469
  eval_crossner_politics_precision   =     0.5463
  eval_crossner_politics_recall      =     0.5476
  eval_crossner_science_f1           =     0.6555
  eval_crossner_science_precision    =     0.6129
  eval_crossner_science_recall       =     0.7045
  eval_mit-movie_f1                  =     0.4886
  eval_mit-movie_precision           =     0.5576
  eval_mit-movie_recall              =     0.4348
  eval_mit-restaurant_f1             =     0.2898
  eval_mit-restaurant_precision      =      0.382
  eval_mit-restaurant_recall         =     0.2334
  eval_runtime                       = 0:00:36.28
  eval_samples                       =       1400
  eval_samples_per_second            =     38.579
  eval_steps_per_second              =      0.165
11/19/2024 18:46:45 - INFO - __main__ - *** Predict ***
[INFO|gner_trainer.py:60] 2024-11-19 18:46:45,372 >> ***** Running Prediction *****
[INFO|gner_trainer.py:62] 2024-11-19 18:46:45,372 >>   Num examples = 6470
[INFO|gner_trainer.py:65] 2024-11-19 18:46:45,372 >>   Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1170.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1157.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:00<00:00, 1163.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3674.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3637.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3644.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3643.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3624.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3626.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3608.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2443/2443 [00:00<00:00, 3585.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4096.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4093.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4062.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4092.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4036.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4067.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4038.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1521/1521 [00:00<00:00, 4059.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1405.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1392.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1376.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1394.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1378.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1382.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1379.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 431/431 [00:00<00:00, 1385.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1102.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1089.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1086.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1085.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1092.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1081.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 416/416 [00:00<00:00, 1088.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 1002.85it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 998.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 982.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 995.65it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 987.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 994.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 990.10it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 465/465 [00:00<00:00, 994.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 1002.14it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 987.82it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 977.69it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 985.19it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 981.88it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 980.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 980.73it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 651/651 [00:00<00:00, 983.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1137.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1124.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1122.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1112.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1118.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1114.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1124.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 543/543 [00:00<00:00, 1120.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 26/26 [01:44<00:00,  4.02s/it]
***** predict metrics *****
  predict_average_f1                    =     0.5482
  predict_crossner_ai_f1                =     0.5469
  predict_crossner_ai_precision         =     0.4925
  predict_crossner_ai_recall            =     0.6148
  predict_crossner_literature_f1        =     0.5406
  predict_crossner_literature_precision =     0.5547
  predict_crossner_literature_recall    =     0.5272
  predict_crossner_music_f1             =     0.6754
  predict_crossner_music_precision      =     0.6777
  predict_crossner_music_recall         =     0.6732
  predict_crossner_politics_f1          =     0.6074
  predict_crossner_politics_precision   =     0.6018
  predict_crossner_politics_recall      =     0.6131
  predict_crossner_science_f1           =     0.6408
  predict_crossner_science_precision    =     0.5945
  predict_crossner_science_recall       =     0.6949
  predict_mit-movie_f1                  =     0.4869
  predict_mit-movie_precision           =     0.5487
  predict_mit-movie_recall              =     0.4375
  predict_mit-restaurant_f1             =     0.3393
  predict_mit-restaurant_precision      =     0.4682
  predict_mit-restaurant_recall         =      0.266
  predict_runtime                       = 0:01:45.86
  predict_samples                       =       6470
  predict_samples_per_second            =     61.117
  predict_steps_per_second              =      0.246
[2024-11-19 18:48:36,122] [INFO] [launch.py:347:main] Process 2876423 exits successfully.
[2024-11-19 18:48:36,122] [INFO] [launch.py:347:main] Process 2876426 exits successfully.
[2024-11-19 18:48:36,122] [INFO] [launch.py:347:main] Process 2876424 exits successfully.
[2024-11-19 18:48:36,122] [INFO] [launch.py:347:main] Process 2876429 exits successfully.
[2024-11-19 18:48:36,122] [INFO] [launch.py:347:main] Process 2876427 exits successfully.
[2024-11-19 18:48:36,123] [INFO] [launch.py:347:main] Process 2876422 exits successfully.
[2024-11-19 18:48:36,123] [INFO] [launch.py:347:main] Process 2876428 exits successfully.
[2024-11-19 18:48:37,123] [INFO] [launch.py:347:main] Process 2876425 exits successfully.
