(GNER) chrisjihee@dgx-a100:~/proj/GNER$ python scripts/GNER_supervised_BL.py
************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Base-BL --pretrained google/flan-t5-base --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 07:48:38,898] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:48:45,098] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 07:48:45,099] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Base-BL --pretrained google/flan-t5-base --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 07:48:47,392] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:48:52,688] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 07:48:52,688] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 07:48:52,688] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 07:48:52,688] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 07:48:52,688] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 07:48:52,689] [INFO] [launch.py:256:main] process 3658621 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 07:48:52,689] [INFO] [launch.py:256:main] process 3658622 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 07:48:52,690] [INFO] [launch.py:256:main] process 3658623 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 07:48:52,691] [INFO] [launch.py:256:main] process 3658624 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 07:49:07,836] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:49:07,837] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:49:07,837] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:49:07,841] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 07:49:08,530] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 07:49:08,530] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 07:49:08,533] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 07:49:08,574] [INFO] [comm.py:652:init_distributed] cdb=None
Generating train split: 143180 examples [00:17, 8350.30 examples/s]
Generating validation split: 3600 examples [00:02, 1463.30 examples/s]
Generating test split: 124835 examples [00:10, 12227.26 examples/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 50.97ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.72ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.25ba/s]
[02.22 07:49:43] ┇ INFO    ┇                     gner ┇ Loaded raw train (#=143180): configs/dataset/supervised -> data/supervised-train.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 48.95ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 48.80ba/s]
[02.22 07:49:43] ┇ INFO    ┇                     gner ┇ Loaded raw validation (#=3600): configs/dataset/supervised -> data/supervised-validation.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 47.64ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 45.34ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 48.82ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.26ba/s]
[02.22 07:49:46] ┇ INFO    ┇                     gner ┇ Loaded raw test (#=124835): configs/dataset/supervised -> data/supervised-test.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 47.08ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 46.54ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 46.44ba/s]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Base-BL --pretrained google/flan-t5-base --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   #	TrainingArgumentsForAccelerator              	value
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   1	env.hostname                                 	dgx-a100
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   2	env.hostaddr                                 	129.254.23.12
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   3	env.global_rank                              	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   4	env.local_rank                               	0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   5	env.node_rank                                	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   6	env.world_size                               	4
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   7	env.time_stamp                               	0222-074859
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   8	env.python_path                              	/raid/chrisjihee/miniforge3/envs/GNER/bin/python
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇   9	env.current_dir                              	/raid/chrisjihee/proj/GNER
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  10	env.current_file                             	finetune.py
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  11	env.command_args                             	['--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  12	env.output_home                              	output
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  13	env.output_name                              	GNER-supervised
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  14	env.run_version                              	FlanT5-Base-BL
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  15	env.output_file                              	train-metrics-united-12ep-0222-074859.csv
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  16	env.logging_file                             	train-loggings-united-12ep-0222-074859.out
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  17	env.logging_level                            	30
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  18	env.logging_format                           	%(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  19	env.datetime_format                          	[%m.%d %H:%M:%S]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  20	env.argument_file                            	train-arguments-0222-074859.json
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  21	env.random_seed                              	7
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  22	env.max_workers                              	4
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  23	env.debugging                                	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  24	env.output_dir                               	output/GNER-supervised/FlanT5-Base-BL
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  25	time.t1                                      	2025-02-22 07:49:46.495270
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  26	time.t2                                      	2025-02-22 07:48:56.705029
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  27	time.started                                 	[02.22 07:49:46]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  28	time.settled
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  29	time.elapsed
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  30	data.data_dir                                	data
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  31	data.data_config_dir                         	configs/dataset/supervised
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  32	data.instruct_file                           	configs/instruction/GNER-paper.json
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  33	data.train_file
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  34	data.study_file
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  35	data.eval_file
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  36	data.pred_file
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  37	data.pretrained                              	google/flan-t5-base
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  38	data.max_train_samples                       	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  39	data.max_study_samples                       	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  40	data.max_eval_samples                        	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  41	data.max_pred_samples                        	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  42	data.use_cache_data                          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  43	data.progress_seconds                        	10.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  44	data.max_source_length                       	640
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  45	data.max_target_length                       	640
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  46	data.write_predictions                       	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  47	data.ignore_pad_token_for_loss               	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  48	train._n_gpu                                 	1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  49	train.accelerator_config                     	{'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  50	train.adafactor                              	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  51	train.adam_beta1                             	0.9
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  52	train.adam_beta2                             	0.999
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  53	train.adam_epsilon                           	1e-08
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  54	train.auto_find_batch_size                   	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  55	train.average_tokens_across_devices          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  56	train.batch_eval_metrics                     	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  57	train.bf16                                   	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  58	train.bf16_full_eval                         	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  59	train.data_seed
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  60	train.dataloader_drop_last                   	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  61	train.dataloader_num_workers                 	0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  62	train.dataloader_persistent_workers          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  63	train.dataloader_pin_memory                  	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  64	train.dataloader_prefetch_factor
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  65	train.ddp_backend
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  66	train.ddp_broadcast_buffers
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  67	train.ddp_bucket_cap_mb
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  68	train.ddp_find_unused_parameters
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  69	train.ddp_timeout                            	1800
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  70	train.debug                                  	[]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  71	train.deepspeed                              	configs/deepspeed/ds2_t5.json
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  72	train.disable_tqdm                           	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  73	train.dispatch_batches
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  74	train.do_eval                                	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  75	train.do_predict                             	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  76	train.do_train                               	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  77	train.eval_accumulation_steps                	1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  78	train.eval_delay                             	0.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  79	train.eval_do_concat_batches                 	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  80	train.eval_epochs                            	0.5
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  81	train.eval_on_start                          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  82	train.eval_steps                             	9223372036854775807
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  83	train.eval_strategy                          	IntervalStrategy.NO
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  84	train.eval_use_gather_object                 	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  85	train.evaluation_strategy
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  86	train.fp16                                   	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  87	train.fp16_backend                           	auto
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  88	train.fp16_full_eval                         	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  89	train.fp16_opt_level                         	O1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  90	train.fsdp                                   	[]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  91	train.fsdp_config                            	{'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  92	train.fsdp_min_num_params                    	0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  93	train.fsdp_transformer_layer_cls_to_wrap
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  94	train.full_determinism                       	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  95	train.generation_config
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  96	train.generation_max_length                  	640
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  97	train.generation_num_beams                   	1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  98	train.gradient_accumulation_steps            	8
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇  99	train.gradient_checkpointing                 	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 100	train.gradient_checkpointing_kwargs
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 101	train.greater_is_better                      	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 102	train.group_by_length                        	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 103	train.half_precision_backend                 	auto
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 104	train.hub_always_push                        	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 105	train.hub_model_id
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 106	train.hub_private_repo
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 107	train.hub_strategy                           	HubStrategy.EVERY_SAVE
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 108	train.hub_token
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 109	train.ignore_data_skip                       	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 110	train.include_for_metrics                    	[]
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 111	train.include_inputs_for_metrics             	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 112	train.include_num_input_tokens_seen          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 113	train.include_tokens_per_second              	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 114	train.jit_mode_eval                          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 115	train.label_names
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 116	train.label_smoothing_factor                 	0.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 117	train.learning_rate                          	5e-05
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 118	train.length_column_name                     	length
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 119	train.load_best_model_at_end                 	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 120	train.local_rank                             	0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 121	train.log_level                              	warning
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 122	train.log_level_replica                      	error
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 123	train.log_on_each_node                       	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 124	train.logging_dir                            	output/GNER-supervised/FlanT5-Base-BL/runs/Feb22_07-49-07_dgx-a100
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 125	train.logging_epochs                         	-1.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 126	train.logging_first_step                     	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 127	train.logging_nan_inf_filter                 	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 128	train.logging_steps                          	5
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 129	train.logging_strategy                       	IntervalStrategy.STEPS
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 130	train.lr_scheduler_kwargs                    	{}
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 131	train.lr_scheduler_type                      	SchedulerType.COSINE
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 132	train.max_grad_norm                          	1.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 133	train.max_steps                              	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 134	train.metric_for_best_model                  	eval_average
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 135	train.mp_parameters
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 136	train.neftune_noise_alpha
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 137	train.no_cuda                                	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 138	train.num_train_epochs                       	12.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 139	train.optim                                  	OptimizerNames.ADAMW_TORCH
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 140	train.optim_args
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 141	train.optim_target_modules
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 142	train.output_dir                             	output/GNER-supervised/FlanT5-Base-BL
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 143	train.overwrite_output_dir                   	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 144	train.past_index                             	-1
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 145	train.per_device_eval_batch_size             	16
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 146	train.per_device_train_batch_size            	4
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 147	train.per_gpu_eval_batch_size
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 148	train.per_gpu_train_batch_size
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 149	train.predict_with_generate                  	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 150	train.prediction_loss_only                   	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 151	train.push_to_hub                            	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 152	train.push_to_hub_model_id
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 153	train.push_to_hub_organization
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 154	train.push_to_hub_token
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 155	train.ray_scope                              	last
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 156	train.remove_unused_columns                  	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 157	train.report_to                              	['tensorboard']
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 158	train.restore_callback_states_from_checkpoint	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 159	train.resume_from_checkpoint
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 160	train.run_name                               	output/GNER-supervised/FlanT5-Base-BL
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 161	train.save_epochs                            	0.5
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 162	train.save_on_each_node                      	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 163	train.save_only_model                        	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 164	train.save_safetensors                       	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 165	train.save_steps                             	9223372036854775807
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 166	train.save_strategy                          	SaveStrategy.NO
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 167	train.save_total_limit                       	2
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 168	train.seed                                   	7
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 169	train.skip_memory_metrics                    	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 170	train.sortish_sampler                        	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 171	train.split_batches
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 172	train.tf32                                   	True
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 173	train.torch_compile                          	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 174	train.torch_compile_backend
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 175	train.torch_compile_mode
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 176	train.torch_empty_cache_steps
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 177	train.torchdynamo
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 178	train.tpu_metrics_debug                      	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 179	train.tpu_num_cores
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 180	train.use_cpu                                	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 181	train.use_flash_attention                    	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 182	train.use_ipex                               	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 183	train.use_legacy_prediction_loop             	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 184	train.use_liger_kernel                       	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 185	train.use_mps_device                         	False
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 186	train.warmup_ratio                           	0.04
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 187	train.warmup_steps                           	0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ 188	train.weight_decay                           	0.0
[02.22 07:49:46] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 07:49:48] ┇ INFO    ┇                     gner ┇ model type: <class 'transformers.models.t5.modeling_t5.T5ForConditionalGeneration'>
[02.22 07:49:48] ┇ INFO    ┇                     gner ┇ model pad_token_id: 0
[02.22 07:49:48] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   0%|                    |      4/143180 [0:00:00<1:49:49, 21.73Hz]
[02.22 07:49:50] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   7%|█▍                  |  10040/143180 [0:00:02<0:00:23, 5704.24Hz]
[02.22 07:49:52] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  14%|██▊                 |  20004/143180 [0:00:04<0:01:10, 1755.83Hz]
[02.22 07:49:54] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  22%|████▎               |  30828/143180 [0:00:06<0:00:18, 6229.59Hz]
[02.22 07:49:56] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  29%|█████▊              |  41876/143180 [0:00:08<0:00:17, 5804.67Hz]
[02.22 07:49:58] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  35%|███████             |  50796/143180 [0:00:10<0:00:16, 5612.31Hz]
[02.22 07:50:00] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  42%|████████▍           |  60756/143180 [0:00:12<0:00:14, 5708.47Hz]
[02.22 07:50:02] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  50%|█████████▉          |  70920/143180 [0:00:14<0:00:13, 5300.28Hz]
[02.22 07:50:04] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  56%|███████████▏        |  80004/143180 [0:00:16<0:00:41, 1505.58Hz]
[02.22 07:50:06] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  62%|████████████▍       |  89412/143180 [0:00:18<0:00:10, 5304.19Hz]
[02.22 07:50:08] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  69%|█████████████▊      |  98912/143180 [0:00:20<0:00:08, 5047.50Hz]
[02.22 07:50:10] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  76%|███████████████▏    | 108568/143180 [0:00:22<0:00:05, 6211.53Hz]
[02.22 07:50:12] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  83%|████████████████▋   | 119340/143180 [0:00:24<0:00:03, 6301.22Hz]
[02.22 07:50:14] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  91%|██████████████████▎ | 130980/143180 [0:00:26<0:00:01, 6568.28Hz]
[02.22 07:50:16] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset: 100%|███████████████████▉| 142836/143180 [0:00:28<0:00:00, 6398.04Hz]
[02.22 07:50:16] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset: 100%|████████████████████| 143180/143180 [0:00:28<0:00:00, 6378.63Hz]
[02.22 07:50:18] ┇ INFO    ┇                     gner ┇ Completed preprocessing for train_dataset by google/flan-t5-base at [02.22 07:50:18]
[02.22 07:50:19] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset:   0%|                    |    4/3600 [0:00:00<0:02:47, 21.51Hz]
[02.22 07:50:19] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset: 100%|████████████████████| 3600/3600 [0:00:00<0:00:00, 8683.47Hz]
[02.22 07:50:19] ┇ INFO    ┇                     gner ┇ Completed preprocessing for eval_dataset by google/flan-t5-base at [02.22 07:50:19]
[02.22 07:50:20] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:   0%|                    |      4/124835 [0:00:00<1:36:38, 21.53Hz]
[02.22 07:50:22] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  10%|█▉                  |  12424/124835 [0:00:02<0:00:15, 7271.92Hz]
[02.22 07:50:24] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  22%|████▎               |  26940/124835 [0:00:04<0:00:12, 7854.95Hz]
[02.22 07:50:26] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  33%|██████▌             |  40848/124835 [0:00:06<0:00:11, 7428.10Hz]
[02.22 07:50:28] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  43%|████████▋           |  54040/124835 [0:00:08<0:00:09, 7566.94Hz]
[02.22 07:50:30] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  52%|██████████▍         |  64892/124835 [0:00:10<0:00:08, 7379.68Hz]
[02.22 07:50:32] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  62%|████████████▍       |  77940/124835 [0:00:12<0:00:06, 6822.02Hz]
[02.22 07:50:34] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  72%|██████████████▍     |  90136/124835 [0:00:14<0:00:05, 6711.80Hz]
[02.22 07:50:36] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  82%|████████████████▎   | 102064/124835 [0:00:16<0:00:03, 7339.85Hz]
[02.22 07:50:38] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  92%|██████████████████▎ | 114424/124835 [0:00:18<0:00:01, 7342.96Hz]
[02.22 07:50:40] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset: 100%|████████████████████| 124835/124835 [0:00:19<0:00:00, 7060.32Hz]
[02.22 07:50:41] ┇ INFO    ┇                     gner ┇ Completed preprocessing for pred_dataset by google/flan-t5-base at [02.22 07:50:41]
[02.22 07:50:57] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ ***** Beginning Training *****
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Epochs       = 12.0
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Examples     = 143,180
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Batch Size   = 128 = 4 * 8 * 4
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Optim Steps  = 13,416 = 1,118 * 12.0
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Type   = t5
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Path   = google/flan-t5-base
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Class  = T5ForConditionalGeneration
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Params = 247,577,856
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, TensorBoardCallback, CustomProgressCallback
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Zero Optim Stage   = 2
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Examples      = 3,600
[02.22 07:50:57] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Batch Size    = 64 = 16 * 4
[02.22 07:51:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |     5/13416 [0:00:09<6:51:46, 0.54Hz] | epoch=0.00, loss=1.811000
[02.22 07:51:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    10/13416 [0:00:15<5:42:00, 0.65Hz] | epoch=0.01, loss=1.551200
[02.22 07:51:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    15/13416 [0:00:21<5:19:24, 0.70Hz] | epoch=0.01, loss=1.049400
[02.22 07:51:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    20/13416 [0:00:27<5:10:48, 0.72Hz] | epoch=0.02, loss=0.748500
[02.22 07:51:31] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    25/13416 [0:00:33<5:02:30, 0.74Hz] | epoch=0.02, loss=0.558200
[02.22 07:51:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    30/13416 [0:00:39<4:56:35, 0.75Hz] | epoch=0.03, loss=0.419600
[02.22 07:51:43] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    35/13416 [0:00:45<4:52:05, 0.76Hz] | epoch=0.03, loss=0.333300
[02.22 07:51:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    40/13416 [0:00:51<4:48:39, 0.77Hz] | epoch=0.04, loss=0.283300
[02.22 07:51:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    45/13416 [0:00:57<4:45:54, 0.78Hz] | epoch=0.04, loss=0.247600
[02.22 07:52:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    50/13416 [0:01:04<4:45:50, 0.78Hz] | epoch=0.04, loss=0.226400
[02.22 07:52:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    55/13416 [0:01:10<4:43:48, 0.78Hz] | epoch=0.05, loss=0.199000
[02.22 07:52:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    60/13416 [0:01:16<4:42:07, 0.79Hz] | epoch=0.05, loss=0.177900
[02.22 07:52:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    65/13416 [0:01:22<4:41:45, 0.79Hz] | epoch=0.06, loss=0.171900
[02.22 07:52:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    70/13416 [0:01:28<4:40:23, 0.79Hz] | epoch=0.06, loss=0.163200
[02.22 07:52:31] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    75/13416 [0:01:34<4:39:16, 0.80Hz] | epoch=0.07, loss=0.159000
[02.22 07:52:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    80/13416 [0:01:40<4:38:39, 0.80Hz] | epoch=0.07, loss=0.155100
[02.22 07:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    85/13416 [0:01:46<4:38:02, 0.80Hz] | epoch=0.08, loss=0.146900
[02.22 07:52:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    90/13416 [0:01:52<4:37:24, 0.80Hz] | epoch=0.08, loss=0.134900
[02.22 07:52:56] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    95/13416 [0:01:58<4:36:51, 0.80Hz] | epoch=0.09, loss=0.138600
[02.22 07:53:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   100/13416 [0:02:04<4:36:16, 0.80Hz] | epoch=0.09, loss=0.137600
[02.22 07:53:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   105/13416 [0:02:10<4:35:42, 0.80Hz] | epoch=0.09, loss=0.132000
[02.22 07:53:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   110/13416 [0:02:16<4:35:10, 0.81Hz] | epoch=0.10, loss=0.127400
[02.22 07:53:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   115/13416 [0:02:23<4:36:13, 0.80Hz] | epoch=0.10, loss=0.120200
[02.22 07:53:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   120/13416 [0:02:29<4:35:41, 0.80Hz] | epoch=0.11, loss=0.116300
[02.22 07:53:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   125/13416 [0:02:35<4:35:09, 0.81Hz] | epoch=0.11, loss=0.120700
[02.22 07:53:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   130/13416 [0:02:41<4:34:40, 0.81Hz] | epoch=0.12, loss=0.107200
[02.22 07:53:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   135/13416 [0:02:47<4:34:14, 0.81Hz] | epoch=0.12, loss=0.107500
[02.22 07:53:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   140/13416 [0:02:54<4:35:50, 0.80Hz] | epoch=0.12, loss=0.108200
[02.22 07:53:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   145/13416 [0:03:01<4:36:48, 0.80Hz] | epoch=0.13, loss=0.106400
[02.22 07:54:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   150/13416 [0:03:07<4:36:18, 0.80Hz] | epoch=0.13, loss=0.093900
[02.22 07:54:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   155/13416 [0:03:13<4:35:48, 0.80Hz] | epoch=0.14, loss=0.102600
[02.22 07:54:18] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   160/13416 [0:03:20<4:36:51, 0.80Hz] | epoch=0.14, loss=0.097000
[02.22 07:54:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   165/13416 [0:03:26<4:36:22, 0.80Hz] | epoch=0.15, loss=0.095400
[02.22 07:54:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   170/13416 [0:03:32<4:35:54, 0.80Hz] | epoch=0.15, loss=0.093300
[02.22 07:54:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   175/13416 [0:03:39<4:37:07, 0.80Hz] | epoch=0.16, loss=0.096500
[02.22 07:54:43] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   180/13416 [0:03:45<4:36:40, 0.80Hz] | epoch=0.16, loss=0.086500
[02.22 07:54:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   185/13416 [0:03:51<4:36:15, 0.80Hz] | epoch=0.17, loss=0.092100
[02.22 07:54:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   190/13416 [0:03:57<4:35:51, 0.80Hz] | epoch=0.17, loss=0.085700
[02.22 07:55:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   195/13416 [0:04:04<4:35:48, 0.80Hz] | epoch=0.17, loss=0.087100
[02.22 07:55:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   200/13416 [0:04:10<4:35:25, 0.80Hz] | epoch=0.18, loss=0.086000
[02.22 07:55:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   205/13416 [0:04:16<4:35:03, 0.80Hz] | epoch=0.18, loss=0.090400
[02.22 07:55:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   210/13416 [0:04:22<4:34:43, 0.80Hz] | epoch=0.19, loss=0.084000
[02.22 07:55:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   215/13416 [0:04:28<4:34:23, 0.80Hz] | epoch=0.19, loss=0.083700
[02.22 07:55:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   220/13416 [0:04:35<4:35:04, 0.80Hz] | epoch=0.20, loss=0.082800
[02.22 07:55:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   225/13416 [0:04:41<4:34:42, 0.80Hz] | epoch=0.20, loss=0.084200
[02.22 07:55:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   230/13416 [0:04:47<4:34:22, 0.80Hz] | epoch=0.21, loss=0.079100
[02.22 07:55:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   235/13416 [0:04:53<4:34:03, 0.80Hz] | epoch=0.21, loss=0.083200
[02.22 07:55:56] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   240/13416 [0:04:59<4:33:43, 0.80Hz] | epoch=0.21, loss=0.076400
[02.22 07:56:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   245/13416 [0:05:05<4:33:24, 0.80Hz] | epoch=0.22, loss=0.078200
[02.22 07:56:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   250/13416 [0:05:11<4:33:06, 0.80Hz] | epoch=0.22, loss=0.070100
[02.22 07:56:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   255/13416 [0:05:17<4:32:48, 0.80Hz] | epoch=0.23, loss=0.076500
[02.22 07:56:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   260/13416 [0:05:23<4:32:31, 0.80Hz] | epoch=0.23, loss=0.073400
[02.22 07:56:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   265/13416 [0:05:29<4:32:15, 0.81Hz] | epoch=0.24, loss=0.066100
[02.22 07:56:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   270/13416 [0:05:35<4:31:58, 0.81Hz] | epoch=0.24, loss=0.072200
[02.22 07:56:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   275/13416 [0:05:41<4:31:42, 0.81Hz] | epoch=0.25, loss=0.078200
[02.22 07:56:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   280/13416 [0:05:47<4:31:26, 0.81Hz] | epoch=0.25, loss=0.070400
[02.22 07:56:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   285/13416 [0:05:53<4:31:11, 0.81Hz] | epoch=0.26, loss=0.069400
[02.22 07:56:56] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   290/13416 [0:05:59<4:30:57, 0.81Hz] | epoch=0.26, loss=0.072800
[02.22 07:57:03] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   295/13416 [0:06:06<4:31:28, 0.81Hz] | epoch=0.26, loss=0.073300
[02.22 07:57:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   300/13416 [0:06:12<4:31:14, 0.81Hz] | epoch=0.27, loss=0.069300
[02.22 07:57:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   305/13416 [0:06:18<4:30:59, 0.81Hz] | epoch=0.27, loss=0.068000
[02.22 07:57:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   310/13416 [0:06:24<4:30:45, 0.81Hz] | epoch=0.28, loss=0.072200
[02.22 07:57:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   315/13416 [0:06:30<4:30:31, 0.81Hz] | epoch=0.28, loss=0.068500
[02.22 07:57:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   320/13416 [0:06:36<4:28:12, 0.81Hz] | epoch=0.29, loss=0.070300
[02.22 07:57:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   325/13416 [0:06:42<4:28:03, 0.81Hz] | epoch=0.29, loss=0.066400
[02.22 07:57:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   330/13416 [0:06:48<4:27:51, 0.81Hz] | epoch=0.29, loss=0.069500
[02.22 07:57:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   335/13416 [0:06:54<4:27:30, 0.82Hz] | epoch=0.30, loss=0.065700
[02.22 07:57:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   340/13416 [0:07:00<4:27:22, 0.82Hz] | epoch=0.30, loss=0.062100
[02.22 07:58:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   345/13416 [0:07:06<4:27:16, 0.82Hz] | epoch=0.31, loss=0.066600
[02.22 07:58:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   350/13416 [0:07:12<4:27:12, 0.81Hz] | epoch=0.31, loss=0.066600
[02.22 07:58:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   355/13416 [0:07:18<4:27:08, 0.81Hz] | epoch=0.32, loss=0.066600
[02.22 07:58:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   360/13416 [0:07:24<4:27:05, 0.81Hz] | epoch=0.32, loss=0.059900
[02.22 07:58:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   365/13416 [0:07:30<4:26:42, 0.82Hz] | epoch=0.33, loss=0.060000
[02.22 07:58:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   370/13416 [0:07:36<4:26:39, 0.82Hz] | epoch=0.33, loss=0.064700
[02.22 07:58:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   375/13416 [0:07:42<4:26:36, 0.82Hz] | epoch=0.34, loss=0.061400
[02.22 07:58:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   380/13416 [0:07:48<4:26:20, 0.82Hz] | epoch=0.34, loss=0.064200
[02.22 07:58:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   385/13416 [0:07:54<4:26:18, 0.82Hz] | epoch=0.34, loss=0.063600
[02.22 07:58:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   390/13416 [0:08:00<4:26:13, 0.82Hz] | epoch=0.35, loss=0.067200
[02.22 07:59:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   395/13416 [0:08:06<4:26:05, 0.82Hz] | epoch=0.35, loss=0.061600
[02.22 07:59:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   400/13416 [0:08:12<4:25:56, 0.82Hz] | epoch=0.36, loss=0.061300
[02.22 07:59:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   405/13416 [0:08:18<4:25:49, 0.82Hz] | epoch=0.36, loss=0.059000
[02.22 07:59:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   410/13416 [0:08:24<4:25:39, 0.82Hz] | epoch=0.37, loss=0.058500
[02.22 07:59:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   415/13416 [0:08:30<4:25:33, 0.82Hz] | epoch=0.37, loss=0.058900
[02.22 07:59:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   420/13416 [0:08:36<4:25:26, 0.82Hz] | epoch=0.38, loss=0.063100
[02.22 07:59:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   425/13416 [0:08:42<4:25:21, 0.82Hz] | epoch=0.38, loss=0.060300
[02.22 07:59:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   430/13416 [0:08:48<4:24:41, 0.82Hz] | epoch=0.39, loss=0.057800
[02.22 07:59:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   435/13416 [0:08:54<4:24:35, 0.82Hz] | epoch=0.39, loss=0.060200
[02.22 07:59:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   440/13416 [0:09:00<4:24:30, 0.82Hz] | epoch=0.39, loss=0.055000
[02.22 08:00:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   445/13416 [0:09:06<4:24:24, 0.82Hz] | epoch=0.40, loss=0.058600
[02.22 08:00:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   450/13416 [0:09:12<4:24:18, 0.82Hz] | epoch=0.40, loss=0.053700
[02.22 08:00:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   455/13416 [0:09:18<4:23:20, 0.82Hz] | epoch=0.41, loss=0.057100
[02.22 08:00:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   460/13416 [0:09:24<4:22:35, 0.82Hz] | epoch=0.41, loss=0.053600
[02.22 08:00:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   465/13416 [0:09:30<4:22:30, 0.82Hz] | epoch=0.42, loss=0.058300
[02.22 08:00:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   470/13416 [0:09:36<4:22:25, 0.82Hz] | epoch=0.42, loss=0.055100
[02.22 08:00:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   475/13416 [0:09:42<4:21:36, 0.82Hz] | epoch=0.42, loss=0.051400
[02.22 08:00:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   480/13416 [0:09:48<4:21:31, 0.82Hz] | epoch=0.43, loss=0.059900
[02.22 08:00:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   485/13416 [0:09:54<4:21:26, 0.82Hz] | epoch=0.43, loss=0.051700
[02.22 08:00:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   490/13416 [0:10:00<4:20:26, 0.83Hz] | epoch=0.44, loss=0.054300
[02.22 08:01:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   495/13416 [0:10:06<4:20:20, 0.83Hz] | epoch=0.44, loss=0.052800
[02.22 08:01:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   500/13416 [0:10:12<4:20:13, 0.83Hz] | epoch=0.45, loss=0.051700
[02.22 08:01:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   505/13416 [0:10:18<4:20:06, 0.83Hz] | epoch=0.45, loss=0.051400
[02.22 08:01:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   510/13416 [0:10:24<4:19:48, 0.83Hz] | epoch=0.46, loss=0.053700
[02.22 08:01:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   515/13416 [0:10:30<4:19:42, 0.83Hz] | epoch=0.46, loss=0.052100
[02.22 08:01:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   520/13416 [0:10:36<4:19:36, 0.83Hz] | epoch=0.47, loss=0.053100
[02.22 08:01:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   525/13416 [0:10:42<4:19:29, 0.83Hz] | epoch=0.47, loss=0.049100
[02.22 08:01:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   530/13416 [0:10:48<4:19:21, 0.83Hz] | epoch=0.47, loss=0.051100
[02.22 08:01:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   535/13416 [0:10:54<4:18:33, 0.83Hz] | epoch=0.48, loss=0.053500
[02.22 08:01:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   540/13416 [0:11:00<4:18:27, 0.83Hz] | epoch=0.48, loss=0.053200
[02.22 08:02:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   545/13416 [0:11:06<4:18:21, 0.83Hz] | epoch=0.49, loss=0.053900
[02.22 08:02:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   550/13416 [0:11:12<4:18:14, 0.83Hz] | epoch=0.49, loss=0.053400
[02.22 08:02:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   555/13416 [0:11:18<4:18:09, 0.83Hz] | epoch=0.50, loss=0.051400
[02.22 08:02:31] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   2%|▎                   |  1/57 [0:00:10<0:09:23, 0.10Hz]
[02.22 08:02:40] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   4%|▋                   |  2/57 [0:00:19<0:09:05, 0.10Hz]
[02.22 08:02:50] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   5%|█                   |  3/57 [0:00:29<0:08:51, 0.10Hz]
[02.22 08:02:54] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   7%|█▍                  |  4/57 [0:00:33<0:07:24, 0.12Hz]
[02.22 08:03:04] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   9%|█▊                  |  5/57 [0:00:43<0:07:28, 0.12Hz]
[02.22 08:03:10] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  11%|██                  |  6/57 [0:00:49<0:06:58, 0.12Hz]
[02.22 08:03:14] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  12%|██▍                 |  7/57 [0:00:53<0:06:19, 0.13Hz]
[02.22 08:03:22] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  14%|██▊                 |  8/57 [0:01:01<0:06:19, 0.13Hz]
[02.22 08:03:29] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  16%|███▏                |  9/57 [0:01:08<0:06:03, 0.13Hz]
[02.22 08:03:37] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  18%|███▌                | 10/57 [0:01:16<0:05:58, 0.13Hz]
[02.22 08:03:42] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  19%|███▊                | 11/57 [0:01:21<0:05:41, 0.13Hz]
[02.22 08:03:52] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  21%|████▏               | 12/57 [0:01:31<0:05:42, 0.13Hz]
[02.22 08:03:56] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  23%|████▌               | 13/57 [0:01:35<0:05:23, 0.14Hz]
[02.22 08:04:02] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  26%|█████▎              | 15/57 [0:01:41<0:04:43, 0.15Hz]
[02.22 08:04:08] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  30%|█████▉              | 17/57 [0:01:47<0:04:12, 0.16Hz]
[02.22 08:04:14] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  33%|██████▋             | 19/57 [0:01:53<0:03:47, 0.17Hz]
[02.22 08:04:17] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  35%|███████             | 20/57 [0:01:56<0:03:36, 0.17Hz]
[02.22 08:04:24] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  39%|███████▋            | 22/57 [0:02:03<0:03:16, 0.18Hz]
[02.22 08:04:28] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  40%|████████            | 23/57 [0:02:07<0:03:07, 0.18Hz]
[02.22 08:04:31] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  42%|████████▍           | 24/57 [0:02:10<0:02:59, 0.18Hz]
[02.22 08:04:36] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  44%|████████▊           | 25/57 [0:02:15<0:02:52, 0.19Hz]
[02.22 08:04:39] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  46%|█████████           | 26/57 [0:02:18<0:02:45, 0.19Hz]
[02.22 08:04:43] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  47%|█████████▍          | 27/57 [0:02:22<0:02:37, 0.19Hz]
[02.22 08:04:46] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  49%|█████████▊          | 28/57 [0:02:25<0:02:30, 0.19Hz]
[02.22 08:04:49] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  51%|██████████▏         | 29/57 [0:02:28<0:02:23, 0.19Hz]
[02.22 08:04:56] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  54%|██████████▉         | 31/57 [0:02:35<0:02:10, 0.20Hz]
[02.22 08:04:59] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  56%|███████████▏        | 32/57 [0:02:38<0:02:03, 0.20Hz]
[02.22 08:05:07] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  58%|███████████▌        | 33/57 [0:02:46<0:02:00, 0.20Hz]
[02.22 08:05:11] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  63%|████████████▋       | 36/57 [0:02:50<0:01:39, 0.21Hz]
[02.22 08:05:16] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  67%|█████████████▎      | 38/57 [0:02:55<0:01:27, 0.22Hz]
[02.22 08:05:20] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  68%|█████████████▋      | 39/57 [0:02:59<0:01:22, 0.22Hz]
[02.22 08:05:27] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  70%|██████████████      | 40/57 [0:03:06<0:01:19, 0.21Hz]
[02.22 08:05:31] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  72%|██████████████▍     | 41/57 [0:03:09<0:01:14, 0.22Hz]
[02.22 08:05:34] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  74%|██████████████▋     | 42/57 [0:03:13<0:01:09, 0.22Hz]
[02.22 08:05:38] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  75%|███████████████     | 43/57 [0:03:17<0:01:04, 0.22Hz]
[02.22 08:05:43] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  77%|███████████████▍    | 44/57 [0:03:22<0:00:59, 0.22Hz]
[02.22 08:05:52] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  79%|███████████████▊    | 45/57 [0:03:31<0:00:56, 0.21Hz]
[02.22 08:05:58] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  81%|████████████████▏   | 46/57 [0:03:37<0:00:51, 0.21Hz]
[02.22 08:06:01] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  82%|████████████████▍   | 47/57 [0:03:40<0:00:46, 0.21Hz]
[02.22 08:06:06] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  84%|████████████████▊   | 48/57 [0:03:45<0:00:42, 0.21Hz]
[02.22 08:06:11] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  86%|█████████████████▏  | 49/57 [0:03:49<0:00:37, 0.21Hz]
[02.22 08:06:15] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  88%|█████████████████▌  | 50/57 [0:03:54<0:00:32, 0.21Hz]
[02.22 08:06:20] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  91%|██████████████████▏ | 52/57 [0:03:59<0:00:23, 0.22Hz]
[02.22 08:06:29] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  95%|██████████████████▉ | 54/57 [0:04:07<0:00:13, 0.22Hz]
[02.22 08:06:32] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  96%|███████████████████▎| 55/57 [0:04:11<0:00:09, 0.22Hz]
[02.22 08:06:37] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  98%|███████████████████▋| 56/57 [0:04:16<0:00:04, 0.22Hz]
[02.22 08:06:47] ┇ INFO    ┇        gner.gner_trainer ┇ [checking] 100%|████████████████████| 57/57 [0:04:26<0:00:00, 0.21Hz]
[02.22 08:06:49] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:06:49] ┇ INFO    ┇           chrisbase.data ┇ [EXIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Base-BL --pretrained google/flan-t5-base --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging ($=00:17:02.676)
[02.22 08:06:49] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[rank0]: Traceback (most recent call last):
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank0]:     train_result: TrainOutput = trainer.train()
[rank0]:                                 ^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank0]:     self._maybe_log_save_evaluate(
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank0]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank0]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank0]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank0]:     output = eval_loop(
[rank0]:              ^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank0]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank0]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank0]:                                         ^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank0]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank0]:     all_examples[example['dataset']].append(example)
[rank0]:                  ~~~~~~~^^^^^^^^^^^
[rank0]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank3]: Traceback (most recent call last):
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank3]:     AppTyper.run(main)
[rank3]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank3]:     app()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank3]:     raise e
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank3]:     return get_command(self)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank3]:     return self.main(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank3]:     return _main(
[rank3]:            ^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank3]:     rv = self.invoke(ctx)
[rank3]:          ^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank3]:     return ctx.invoke(self.callback, **ctx.params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank3]:     return __callback(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank3]:     return callback(**use_params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank3]:     train_result: TrainOutput = trainer.train()
[rank3]:                                 ^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank3]:     return inner_training_loop(
[rank3]:            ^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank3]:     self._maybe_log_save_evaluate(
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank3]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank3]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank3]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank3]:     output = eval_loop(
[rank3]:              ^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank3]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank3]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank3]:                                         ^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank3]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank3]:     all_examples[example['dataset']].append(example)
[rank3]:                  ~~~~~~~^^^^^^^^^^^
[rank3]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank2]:     train_result: TrainOutput = trainer.train()
[rank2]:                                 ^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank2]:     return inner_training_loop(
[rank2]:            ^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank2]:     self._maybe_log_save_evaluate(
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank2]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank2]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank2]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank2]:     output = eval_loop(
[rank2]:              ^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank2]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank2]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank2]:                                         ^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank2]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank2]:     all_examples[example['dataset']].append(example)
[rank2]:                  ~~~~~~~^^^^^^^^^^^
[rank2]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank1]:     train_result: TrainOutput = trainer.train()
[rank1]:                                 ^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank1]:     return inner_training_loop(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank1]:     self._maybe_log_save_evaluate(
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank1]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank1]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank1]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank1]:     output = eval_loop(
[rank1]:              ^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank1]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank1]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank1]:                                         ^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank1]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank1]:     all_examples[example['dataset']].append(example)
[rank1]:                  ~~~~~~~^^^^^^^^^^^
[rank1]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[2025-02-22 08:06:52,748] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3658621
[2025-02-22 08:06:52,789] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3658622
[2025-02-22 08:06:52,828] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3658623
[2025-02-22 08:06:52,828] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3658624
[2025-02-22 08:06:52,865] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Base-BL', '--pretrained', 'google/flan-t5-base', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Large-BL --pretrained google/flan-t5-large --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 08:07:00,203] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:06,086] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 08:07:06,087] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-Large-BL --pretrained google/flan-t5-large --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 08:07:08,541] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:14,115] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 08:07:14,115] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 08:07:14,115] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 08:07:14,116] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 08:07:14,116] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 08:07:14,116] [INFO] [launch.py:256:main] process 3674826 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Large-BL', '--pretrained', 'google/flan-t5-large', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:14,117] [INFO] [launch.py:256:main] process 3674827 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Large-BL', '--pretrained', 'google/flan-t5-large', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:14,117] [INFO] [launch.py:256:main] process 3674828 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Large-BL', '--pretrained', 'google/flan-t5-large', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:14,118] [INFO] [launch.py:256:main] process 3674829 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Large-BL', '--pretrained', 'google/flan-t5-large', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:29,266] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:29,266] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:29,267] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:29,271] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:29,917] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:07:29,957] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:07:29,961] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:07:29,996] [INFO] [comm.py:652:init_distributed] cdb=None
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank2]:     raw_datasets.cleanup_cache_files()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank2]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank2]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank2]:     os.remove(file_path)
[rank2]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-835eebeae23bb0ba_00000_of_00004.arrow'
[rank0]: Traceback (most recent call last):
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank0]:     raw_datasets.cleanup_cache_files()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank0]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank0]:     os.remove(file_path)
[rank0]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-1c4d1b7a38257792_00002_of_00004.arrow'
[rank3]: Traceback (most recent call last):
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank3]:     AppTyper.run(main)
[rank3]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank3]:     app()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank3]:     raise e
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank3]:     return get_command(self)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank3]:     return self.main(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank3]:     return _main(
[rank3]:            ^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank3]:     rv = self.invoke(ctx)
[rank3]:          ^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank3]:     return ctx.invoke(self.callback, **ctx.params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank3]:     return __callback(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank3]:     return callback(**use_params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank3]:     raw_datasets.cleanup_cache_files()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank3]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank3]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank3]:     os.remove(file_path)
[rank3]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-8198c838d4857dc7_00003_of_00004.arrow'
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 47.45ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 46.27ba/s]
Creating json from Arrow format:   4%|█████████▉                                                                                                                                                                                                                                              | 5/125 [00:00<00:02, 49.43ba/s][2025-02-22 08:07:36,120] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3674826
Creating json from Arrow format:   9%|█████████████████████▋                                                                                                                                                                                                                                 | 11/125 [00:00<00:02, 52.33ba/s][2025-02-22 08:07:36,162] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3674827
[2025-02-22 08:07:36,536] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3674828
[2025-02-22 08:07:36,536] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3674829
[2025-02-22 08:07:36,578] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-Large-BL', '--pretrained', 'google/flan-t5-large', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-3B-BL --pretrained google/flan-t5-xl --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 08:07:44,556] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:50,397] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 08:07:50,398] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-3B-BL --pretrained google/flan-t5-xl --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 08:07:52,759] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:07:58,490] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 08:07:58,490] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 08:07:58,490] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 08:07:58,490] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 08:07:58,490] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 08:07:58,491] [INFO] [launch.py:256:main] process 3676380 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:58,491] [INFO] [launch.py:256:main] process 3676381 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:58,492] [INFO] [launch.py:256:main] process 3676382 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:07:58,492] [INFO] [launch.py:256:main] process 3676383 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:08:13,806] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:08:13,809] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:08:13,809] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:08:13,811] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:08:14,433] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:08:14,481] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:08:14,482] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:08:14,492] [INFO] [comm.py:652:init_distributed] cdb=None
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 48.60ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.05ba/s]
Creating json from Arrow format:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 142/144 [00:02<00:00, 49.69ba/s][02.22 08:08:19] ┇ INFO    ┇                     gner ┇ Loaded raw train (#=143180): configs/dataset/supervised -> data/supervised-train.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.07ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.25ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 47.84ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 45.40ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 44.42ba/s]
[02.22 08:08:19] ┇ INFO    ┇                     gner ┇ Loaded raw validation (#=3600): configs/dataset/supervised -> data/supervised-validation.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 44.38ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.19ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 48.38ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 48.38ba/s]
[02.22 08:08:22] ┇ INFO    ┇                     gner ┇ Loaded raw test (#=124835): configs/dataset/supervised -> data/supervised-test.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 47.90ba/s]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-3B-BL --pretrained google/flan-t5-xl --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   #	TrainingArgumentsForAccelerator              	value
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   1	env.hostname                                 	dgx-a100
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   2	env.hostaddr                                 	129.254.23.12
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   3	env.global_rank                              	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   4	env.local_rank                               	0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   5	env.node_rank                                	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   6	env.world_size                               	4
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   7	env.time_stamp                               	0222-080805
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   8	env.python_path                              	/raid/chrisjihee/miniforge3/envs/GNER/bin/python
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇   9	env.current_dir                              	/raid/chrisjihee/proj/GNER
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  10	env.current_file                             	finetune.py
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  11	env.command_args                             	['--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  12	env.output_home                              	output
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  13	env.output_name                              	GNER-supervised
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  14	env.run_version                              	FlanT5-3B-BL
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  15	env.output_file                              	train-metrics-united-12ep-0222-080805.csv
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  16	env.logging_file                             	train-loggings-united-12ep-0222-080805.out
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  17	env.logging_level                            	30
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  18	env.logging_format                           	%(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  19	env.datetime_format                          	[%m.%d %H:%M:%S]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  20	env.argument_file                            	train-arguments-0222-080805.json
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  21	env.random_seed                              	7
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  22	env.max_workers                              	4
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  23	env.debugging                                	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  24	env.output_dir                               	output/GNER-supervised/FlanT5-3B-BL
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  25	time.t1                                      	2025-02-22 08:08:22.617498
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  26	time.t2                                      	2025-02-22 08:08:02.497882
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  27	time.started                                 	[02.22 08:08:22]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  28	time.settled
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  29	time.elapsed
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  30	data.data_dir                                	data
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  31	data.data_config_dir                         	configs/dataset/supervised
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  32	data.instruct_file                           	configs/instruction/GNER-paper.json
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  33	data.train_file
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  34	data.study_file
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  35	data.eval_file
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  36	data.pred_file
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  37	data.pretrained                              	google/flan-t5-xl
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  38	data.max_train_samples                       	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  39	data.max_study_samples                       	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  40	data.max_eval_samples                        	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  41	data.max_pred_samples                        	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  42	data.use_cache_data                          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  43	data.progress_seconds                        	10.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  44	data.max_source_length                       	640
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  45	data.max_target_length                       	640
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  46	data.write_predictions                       	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  47	data.ignore_pad_token_for_loss               	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  48	train._n_gpu                                 	1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  49	train.accelerator_config                     	{'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  50	train.adafactor                              	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  51	train.adam_beta1                             	0.9
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  52	train.adam_beta2                             	0.999
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  53	train.adam_epsilon                           	1e-08
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  54	train.auto_find_batch_size                   	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  55	train.average_tokens_across_devices          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  56	train.batch_eval_metrics                     	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  57	train.bf16                                   	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  58	train.bf16_full_eval                         	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  59	train.data_seed
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  60	train.dataloader_drop_last                   	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  61	train.dataloader_num_workers                 	0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  62	train.dataloader_persistent_workers          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  63	train.dataloader_pin_memory                  	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  64	train.dataloader_prefetch_factor
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  65	train.ddp_backend
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  66	train.ddp_broadcast_buffers
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  67	train.ddp_bucket_cap_mb
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  68	train.ddp_find_unused_parameters
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  69	train.ddp_timeout                            	1800
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  70	train.debug                                  	[]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  71	train.deepspeed                              	configs/deepspeed/ds2_t5.json
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  72	train.disable_tqdm                           	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  73	train.dispatch_batches
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  74	train.do_eval                                	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  75	train.do_predict                             	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  76	train.do_train                               	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  77	train.eval_accumulation_steps                	1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  78	train.eval_delay                             	0.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  79	train.eval_do_concat_batches                 	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  80	train.eval_epochs                            	0.5
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  81	train.eval_on_start                          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  82	train.eval_steps                             	9223372036854775807
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  83	train.eval_strategy                          	IntervalStrategy.NO
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  84	train.eval_use_gather_object                 	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  85	train.evaluation_strategy
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  86	train.fp16                                   	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  87	train.fp16_backend                           	auto
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  88	train.fp16_full_eval                         	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  89	train.fp16_opt_level                         	O1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  90	train.fsdp                                   	[]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  91	train.fsdp_config                            	{'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  92	train.fsdp_min_num_params                    	0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  93	train.fsdp_transformer_layer_cls_to_wrap
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  94	train.full_determinism                       	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  95	train.generation_config
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  96	train.generation_max_length                  	640
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  97	train.generation_num_beams                   	1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  98	train.gradient_accumulation_steps            	8
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇  99	train.gradient_checkpointing                 	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 100	train.gradient_checkpointing_kwargs
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 101	train.greater_is_better                      	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 102	train.group_by_length                        	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 103	train.half_precision_backend                 	auto
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 104	train.hub_always_push                        	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 105	train.hub_model_id
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 106	train.hub_private_repo
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 107	train.hub_strategy                           	HubStrategy.EVERY_SAVE
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 108	train.hub_token
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 109	train.ignore_data_skip                       	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 110	train.include_for_metrics                    	[]
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 111	train.include_inputs_for_metrics             	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 112	train.include_num_input_tokens_seen          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 113	train.include_tokens_per_second              	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 114	train.jit_mode_eval                          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 115	train.label_names
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 116	train.label_smoothing_factor                 	0.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 117	train.learning_rate                          	5e-05
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 118	train.length_column_name                     	length
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 119	train.load_best_model_at_end                 	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 120	train.local_rank                             	0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 121	train.log_level                              	warning
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 122	train.log_level_replica                      	error
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 123	train.log_on_each_node                       	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 124	train.logging_dir                            	output/GNER-supervised/FlanT5-3B-BL/runs/Feb22_08-08-13_dgx-a100
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 125	train.logging_epochs                         	-1.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 126	train.logging_first_step                     	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 127	train.logging_nan_inf_filter                 	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 128	train.logging_steps                          	5
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 129	train.logging_strategy                       	IntervalStrategy.STEPS
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 130	train.lr_scheduler_kwargs                    	{}
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 131	train.lr_scheduler_type                      	SchedulerType.COSINE
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 132	train.max_grad_norm                          	1.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 133	train.max_steps                              	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 134	train.metric_for_best_model                  	eval_average
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 135	train.mp_parameters
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 136	train.neftune_noise_alpha
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 137	train.no_cuda                                	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 138	train.num_train_epochs                       	12.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 139	train.optim                                  	OptimizerNames.ADAMW_TORCH
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 140	train.optim_args
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 141	train.optim_target_modules
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 142	train.output_dir                             	output/GNER-supervised/FlanT5-3B-BL
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 143	train.overwrite_output_dir                   	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 144	train.past_index                             	-1
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 145	train.per_device_eval_batch_size             	16
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 146	train.per_device_train_batch_size            	4
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 147	train.per_gpu_eval_batch_size
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 148	train.per_gpu_train_batch_size
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 149	train.predict_with_generate                  	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 150	train.prediction_loss_only                   	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 151	train.push_to_hub                            	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 152	train.push_to_hub_model_id
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 153	train.push_to_hub_organization
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 154	train.push_to_hub_token
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 155	train.ray_scope                              	last
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 156	train.remove_unused_columns                  	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 157	train.report_to                              	['tensorboard']
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 158	train.restore_callback_states_from_checkpoint	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 159	train.resume_from_checkpoint
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 160	train.run_name                               	output/GNER-supervised/FlanT5-3B-BL
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 161	train.save_epochs                            	0.5
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 162	train.save_on_each_node                      	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 163	train.save_only_model                        	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 164	train.save_safetensors                       	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 165	train.save_steps                             	9223372036854775807
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 166	train.save_strategy                          	SaveStrategy.NO
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 167	train.save_total_limit                       	2
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 168	train.seed                                   	7
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 169	train.skip_memory_metrics                    	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 170	train.sortish_sampler                        	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 171	train.split_batches
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 172	train.tf32                                   	True
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 173	train.torch_compile                          	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 174	train.torch_compile_backend
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 175	train.torch_compile_mode
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 176	train.torch_empty_cache_steps
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 177	train.torchdynamo
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 178	train.tpu_metrics_debug                      	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 179	train.tpu_num_cores
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 180	train.use_cpu                                	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 181	train.use_flash_attention                    	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 182	train.use_ipex                               	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 183	train.use_legacy_prediction_loop             	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 184	train.use_liger_kernel                       	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 185	train.use_mps_device                         	False
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 186	train.warmup_ratio                           	0.04
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 187	train.warmup_steps                           	0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ 188	train.weight_decay                           	0.0
[02.22 08:08:22] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.42it/s]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  2.33it/s]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  3.65it/s]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00,  4.13it/s]
[02.22 08:08:24] ┇ INFO    ┇                     gner ┇ model type: <class 'transformers.models.t5.modeling_t5.T5ForConditionalGeneration'>
[02.22 08:08:24] ┇ INFO    ┇                     gner ┇ model pad_token_id: 0
[02.22 08:08:25] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   0%|                    |      4/143180 [0:00:00<1:50:34, 21.58Hz]
[02.22 08:08:27] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   7%|█▎                  |   9824/143180 [0:00:02<0:00:23, 5763.04Hz]
[02.22 08:08:29] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  14%|██▋                 |  19564/143180 [0:00:04<0:00:24, 4999.17Hz]
[02.22 08:08:31] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  21%|████▏               |  29540/143180 [0:00:06<0:00:18, 6122.38Hz]
[02.22 08:08:33] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  28%|█████▋              |  40392/143180 [0:00:08<0:00:15, 6697.31Hz]
[02.22 08:08:35] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  36%|███████▏            |  51060/143180 [0:00:10<0:00:15, 5976.37Hz]
[02.22 08:08:37] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  43%|████████▌           |  61148/143180 [0:00:12<0:00:13, 5974.45Hz]
[02.22 08:08:39] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  50%|█████████▉          |  71224/143180 [0:00:14<0:00:12, 5661.00Hz]
[02.22 08:08:41] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  56%|███████████▏        |  80452/143180 [0:00:16<0:00:11, 5346.20Hz]
[02.22 08:08:43] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  63%|████████████▌       |  90276/143180 [0:00:18<0:00:10, 5280.89Hz]
[02.22 08:08:45] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  70%|█████████████▉      |  99764/143180 [0:00:20<0:00:08, 5361.88Hz]
[02.22 08:08:47] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  76%|███████████████▏    | 108952/143180 [0:00:22<0:00:05, 5780.44Hz]
[02.22 08:08:49] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  83%|████████████████▋   | 119464/143180 [0:00:24<0:00:03, 5988.66Hz]
[02.22 08:08:51] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  91%|██████████████████▎ | 130788/143180 [0:00:26<0:00:01, 6763.05Hz]
[02.22 08:08:53] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  98%|███████████████████▋| 140880/143180 [0:00:28<0:00:00, 6811.13Hz]
[02.22 08:08:53] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset: 100%|████████████████████| 143180/143180 [0:00:28<0:00:00, 6337.07Hz]
[02.22 08:08:55] ┇ INFO    ┇                     gner ┇ Completed preprocessing for train_dataset by google/flan-t5-xl at [02.22 08:08:54]
[02.22 08:08:55] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset:   0%|                    |    4/3600 [0:00:00<0:02:58, 20.09Hz]
[02.22 08:08:55] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset: 100%|████████████████████| 3600/3600 [0:00:00<0:00:00, 9110.93Hz]
[02.22 08:08:56] ┇ INFO    ┇                     gner ┇ Completed preprocessing for eval_dataset by google/flan-t5-xl at [02.22 08:08:55]
[02.22 08:08:56] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:   0%|                    |      4/124835 [0:00:00<1:37:16, 21.39Hz]
[02.22 08:08:58] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  11%|██                  |  13192/124835 [0:00:02<0:00:14, 7534.41Hz]
[02.22 08:09:00] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  22%|████▍               |  28004/124835 [0:00:04<0:00:35, 2756.80Hz]
[02.22 08:09:02] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  34%|██████▊             |  42280/124835 [0:00:06<0:00:11, 7417.80Hz]
[02.22 08:09:04] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  44%|████████▉           |  55540/124835 [0:00:08<0:00:09, 7669.64Hz]
[02.22 08:09:06] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  55%|██████████▉         |  68256/124835 [0:00:10<0:00:07, 7625.64Hz]
[02.22 08:09:08] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  65%|█████████████       |  81500/124835 [0:00:12<0:00:05, 7542.31Hz]
[02.22 08:09:10] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  76%|███████████████▏    |  94872/124835 [0:00:14<0:00:03, 7597.06Hz]
[02.22 08:09:12] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  87%|█████████████████▎  | 108004/124835 [0:00:16<0:00:07, 2362.32Hz]
[02.22 08:09:14] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  97%|███████████████████▍| 121244/124835 [0:00:18<0:00:00, 7595.32Hz]
[02.22 08:09:15] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset: 100%|████████████████████| 124835/124835 [0:00:18<0:00:00, 7441.95Hz]
[02.22 08:09:16] ┇ INFO    ┇                     gner ┇ Completed preprocessing for pred_dataset by google/flan-t5-xl at [02.22 08:09:16]
[02.22 08:10:28] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ ***** Beginning Training *****
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Epochs       = 12.0
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Examples     = 143,180
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Batch Size   = 128 = 4 * 8 * 4
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Optim Steps  = 13,416 = 1,118 * 12.0
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Type   = t5
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Path   = google/flan-t5-xl
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Class  = T5ForConditionalGeneration
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Params = 2,849,757,184
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, TensorBoardCallback, CustomProgressCallback
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Zero Optim Stage   = 2
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Examples      = 3,600
[02.22 08:10:28] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Batch Size    = 64 = 16 * 4
[02.22 08:10:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |     5/13416 [0:00:20<15:24:59, 0.24Hz] | epoch=0.00, loss=0.726000
[02.22 08:11:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    10/13416 [0:00:36<13:34:36, 0.27Hz] | epoch=0.01, loss=0.441800
[02.22 08:11:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    15/13416 [0:00:52<12:54:23, 0.29Hz] | epoch=0.01, loss=0.223600
[02.22 08:11:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    20/13416 [0:01:09<12:59:52, 0.29Hz] | epoch=0.02, loss=0.150100
[02.22 08:11:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    25/13416 [0:01:25<12:46:58, 0.29Hz] | epoch=0.02, loss=0.130600
[02.22 08:12:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    30/13416 [0:01:41<12:38:09, 0.29Hz] | epoch=0.03, loss=0.109800
[02.22 08:12:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    35/13416 [0:01:57<12:28:40, 0.30Hz] | epoch=0.03, loss=0.098200
[02.22 08:12:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    40/13416 [0:02:13<12:26:02, 0.30Hz] | epoch=0.04, loss=0.088800
[02.22 08:12:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    45/13416 [0:02:30<12:23:51, 0.30Hz] | epoch=0.04, loss=0.079000
[02.22 08:13:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    50/13416 [0:02:46<12:22:16, 0.30Hz] | epoch=0.04, loss=0.073500
[02.22 08:13:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    55/13416 [0:03:02<12:16:57, 0.30Hz] | epoch=0.05, loss=0.065700
[02.22 08:13:47] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    60/13416 [0:03:18<12:15:45, 0.30Hz] | epoch=0.05, loss=0.064200
[02.22 08:14:03] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    65/13416 [0:03:34<12:15:28, 0.30Hz] | epoch=0.06, loss=0.062100
[02.22 08:14:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    70/13416 [0:03:50<12:12:17, 0.30Hz] | epoch=0.06, loss=0.057200
[02.22 08:14:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    75/13416 [0:04:06<12:10:10, 0.30Hz] | epoch=0.07, loss=0.056600
[02.22 08:14:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    80/13416 [0:04:22<12:09:21, 0.30Hz] | epoch=0.07, loss=0.054800
[02.22 08:15:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    85/13416 [0:04:37<12:06:38, 0.31Hz] | epoch=0.08, loss=0.054500
[02.22 08:15:23] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    90/13416 [0:04:54<12:06:46, 0.31Hz] | epoch=0.08, loss=0.048900
[02.22 08:15:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    95/13416 [0:05:11<12:07:27, 0.31Hz] | epoch=0.09, loss=0.051900
[02.22 08:15:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   100/13416 [0:05:26<12:05:24, 0.31Hz] | epoch=0.09, loss=0.051800
[02.22 08:16:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   105/13416 [0:05:42<12:04:15, 0.31Hz] | epoch=0.09, loss=0.050000
[02.22 08:16:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   110/13416 [0:05:58<12:02:48, 0.31Hz] | epoch=0.10, loss=0.048500
[02.22 08:16:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   115/13416 [0:06:15<12:03:17, 0.31Hz] | epoch=0.10, loss=0.046500
[02.22 08:17:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   120/13416 [0:06:31<12:03:13, 0.31Hz] | epoch=0.11, loss=0.042800
[02.22 08:17:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   125/13416 [0:06:47<12:02:02, 0.31Hz] | epoch=0.11, loss=0.046700
[02.22 08:17:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   130/13416 [0:07:03<12:01:23, 0.31Hz] | epoch=0.12, loss=0.039200
[02.22 08:17:48] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   135/13416 [0:07:19<12:00:48, 0.31Hz] | epoch=0.12, loss=0.041700
[02.22 08:18:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   140/13416 [0:07:35<12:00:24, 0.31Hz] | epoch=0.12, loss=0.042500
[02.22 08:18:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   145/13416 [0:07:51<11:59:23, 0.31Hz] | epoch=0.13, loss=0.041000
[02.22 08:18:36] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   150/13416 [0:08:07<11:58:14, 0.31Hz] | epoch=0.13, loss=0.034500
[02.22 08:18:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   155/13416 [0:08:22<11:57:01, 0.31Hz] | epoch=0.14, loss=0.038800
[02.22 08:19:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   160/13416 [0:08:38<11:56:34, 0.31Hz] | epoch=0.14, loss=0.038300
[02.22 08:19:23] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   165/13416 [0:08:54<11:55:57, 0.31Hz] | epoch=0.15, loss=0.038000
[02.22 08:19:39] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   170/13416 [0:09:10<11:54:32, 0.31Hz] | epoch=0.15, loss=0.036100
[02.22 08:19:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   175/13416 [0:09:26<11:54:54, 0.31Hz] | epoch=0.16, loss=0.036000
[02.22 08:20:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   180/13416 [0:09:42<11:54:24, 0.31Hz] | epoch=0.16, loss=0.032700
[02.22 08:20:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   185/13416 [0:09:58<11:53:59, 0.31Hz] | epoch=0.17, loss=0.034300
[02.22 08:20:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   190/13416 [0:10:15<11:54:27, 0.31Hz] | epoch=0.17, loss=0.034400
[02.22 08:21:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   195/13416 [0:10:31<11:54:09, 0.31Hz] | epoch=0.17, loss=0.032200
[02.22 08:21:17] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   200/13416 [0:10:48<11:54:14, 0.31Hz] | epoch=0.18, loss=0.032800
[02.22 08:21:33] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   205/13416 [0:11:04<11:53:43, 0.31Hz] | epoch=0.18, loss=0.033000
[02.22 08:21:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   210/13416 [0:11:20<11:53:13, 0.31Hz] | epoch=0.19, loss=0.030300
[02.22 08:22:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   215/13416 [0:11:36<11:52:56, 0.31Hz] | epoch=0.19, loss=0.032900
[02.22 08:22:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   220/13416 [0:11:52<11:52:27, 0.31Hz] | epoch=0.20, loss=0.031500
[02.22 08:22:36] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   225/13416 [0:12:08<11:51:28, 0.31Hz] | epoch=0.20, loss=0.031900
[02.22 08:22:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   230/13416 [0:12:24<11:51:00, 0.31Hz] | epoch=0.21, loss=0.030500
[02.22 08:23:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   235/13416 [0:12:40<11:50:59, 0.31Hz] | epoch=0.21, loss=0.033000
[02.22 08:23:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   240/13416 [0:12:56<11:50:36, 0.31Hz] | epoch=0.21, loss=0.027000
[02.22 08:23:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   245/13416 [0:13:13<11:50:59, 0.31Hz] | epoch=0.22, loss=0.028300
[02.22 08:23:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   250/13416 [0:13:29<11:50:28, 0.31Hz] | epoch=0.22, loss=0.025500
[02.22 08:24:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   255/13416 [0:13:45<11:49:53, 0.31Hz] | epoch=0.23, loss=0.028900
[02.22 08:24:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   260/13416 [0:14:01<11:49:54, 0.31Hz] | epoch=0.23, loss=0.026900
[02.22 08:24:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   265/13416 [0:14:17<11:49:01, 0.31Hz] | epoch=0.24, loss=0.025100
[02.22 08:25:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   270/13416 [0:14:32<11:48:06, 0.31Hz] | epoch=0.24, loss=0.028800
[02.22 08:25:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   275/13416 [0:14:47<11:47:01, 0.31Hz] | epoch=0.25, loss=0.028900
[02.22 08:25:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   280/13416 [0:15:03<11:46:33, 0.31Hz] | epoch=0.25, loss=0.027000
[02.22 08:25:47] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   285/13416 [0:15:19<11:45:43, 0.31Hz] | epoch=0.26, loss=0.026100
[02.22 08:26:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   290/13416 [0:15:35<11:45:55, 0.31Hz] | epoch=0.26, loss=0.029000
[02.22 08:26:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   295/13416 [0:15:50<11:44:57, 0.31Hz] | epoch=0.26, loss=0.030200
[02.22 08:26:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   300/13416 [0:16:07<11:44:40, 0.31Hz] | epoch=0.27, loss=0.027800
[02.22 08:26:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   305/13416 [0:16:23<11:44:43, 0.31Hz] | epoch=0.27, loss=0.025100
[02.22 08:27:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   310/13416 [0:16:39<11:44:28, 0.31Hz] | epoch=0.28, loss=0.028100
[02.22 08:27:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   315/13416 [0:16:56<11:44:19, 0.31Hz] | epoch=0.28, loss=0.027600
[02.22 08:27:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   320/13416 [0:17:12<11:41:12, 0.31Hz] | epoch=0.29, loss=0.027300
[02.22 08:27:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   325/13416 [0:17:28<11:41:16, 0.31Hz] | epoch=0.29, loss=0.022800
[02.22 08:28:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   330/13416 [0:17:45<11:41:26, 0.31Hz] | epoch=0.29, loss=0.028000
[02.22 08:28:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   335/13416 [0:18:01<11:40:08, 0.31Hz] | epoch=0.30, loss=0.026000
[02.22 08:28:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   340/13416 [0:18:17<11:39:48, 0.31Hz] | epoch=0.30, loss=0.023400
[02.22 08:29:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   345/13416 [0:18:33<11:39:20, 0.31Hz] | epoch=0.31, loss=0.023800
[02.22 08:29:18] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   350/13416 [0:18:50<11:39:59, 0.31Hz] | epoch=0.31, loss=0.025700
[02.22 08:29:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   355/13416 [0:19:05<11:38:59, 0.31Hz] | epoch=0.32, loss=0.025600
[02.22 08:29:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   360/13416 [0:19:20<11:37:58, 0.31Hz] | epoch=0.32, loss=0.022500
[02.22 08:30:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   365/13416 [0:19:36<11:37:13, 0.31Hz] | epoch=0.33, loss=0.021800
[02.22 08:30:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   370/13416 [0:19:52<11:37:18, 0.31Hz] | epoch=0.33, loss=0.023900
[02.22 08:30:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   375/13416 [0:20:08<11:36:53, 0.31Hz] | epoch=0.34, loss=0.022400
[02.22 08:30:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   380/13416 [0:20:23<11:36:01, 0.31Hz] | epoch=0.34, loss=0.022100
[02.22 08:31:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   385/13416 [0:20:40<11:36:18, 0.31Hz] | epoch=0.34, loss=0.025000
[02.22 08:31:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   390/13416 [0:20:56<11:36:07, 0.31Hz] | epoch=0.35, loss=0.025100
[02.22 08:31:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   395/13416 [0:21:12<11:35:56, 0.31Hz] | epoch=0.35, loss=0.023600
[02.22 08:31:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   400/13416 [0:21:28<11:35:57, 0.31Hz] | epoch=0.36, loss=0.022400
[02.22 08:32:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   405/13416 [0:21:44<11:35:17, 0.31Hz] | epoch=0.36, loss=0.021800
[02.22 08:32:29] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   410/13416 [0:22:00<11:34:18, 0.31Hz] | epoch=0.37, loss=0.022900
[02.22 08:32:45] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   415/13416 [0:22:16<11:34:34, 0.31Hz] | epoch=0.37, loss=0.021800
[02.22 08:33:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   420/13416 [0:22:31<11:33:50, 0.31Hz] | epoch=0.38, loss=0.024700
[02.22 08:33:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   425/13416 [0:22:47<11:33:35, 0.31Hz] | epoch=0.38, loss=0.023200
[02.22 08:33:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   430/13416 [0:23:03<11:33:04, 0.31Hz] | epoch=0.39, loss=0.021600
[02.22 08:33:47] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   435/13416 [0:23:19<11:31:54, 0.31Hz] | epoch=0.39, loss=0.023200
[02.22 08:34:03] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   440/13416 [0:23:34<11:31:27, 0.31Hz] | epoch=0.39, loss=0.019400
[02.22 08:34:18] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   445/13416 [0:23:50<11:30:49, 0.31Hz] | epoch=0.40, loss=0.023100
[02.22 08:34:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   450/13416 [0:24:06<11:30:29, 0.31Hz] | epoch=0.40, loss=0.020400
[02.22 08:34:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   455/13416 [0:24:21<11:29:41, 0.31Hz] | epoch=0.41, loss=0.021200
[02.22 08:35:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   460/13416 [0:24:37<11:29:33, 0.31Hz] | epoch=0.41, loss=0.019800
[02.22 08:35:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   465/13416 [0:24:53<11:29:26, 0.31Hz] | epoch=0.42, loss=0.022800
[02.22 08:35:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   470/13416 [0:25:09<11:29:18, 0.31Hz] | epoch=0.42, loss=0.020500
[02.22 08:35:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   475/13416 [0:25:25<11:29:00, 0.31Hz] | epoch=0.42, loss=0.020500
[02.22 08:36:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   480/13416 [0:25:41<11:28:43, 0.31Hz] | epoch=0.43, loss=0.022300
[02.22 08:36:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   485/13416 [0:25:57<11:28:57, 0.31Hz] | epoch=0.43, loss=0.020400
[02.22 08:36:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   490/13416 [0:26:12<11:28:02, 0.31Hz] | epoch=0.44, loss=0.022000
[02.22 08:36:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   495/13416 [0:26:29<11:27:59, 0.31Hz] | epoch=0.44, loss=0.020000
[02.22 08:37:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   500/13416 [0:26:44<11:27:28, 0.31Hz] | epoch=0.45, loss=0.018900
[02.22 08:37:29] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   505/13416 [0:27:00<11:26:08, 0.31Hz] | epoch=0.45, loss=0.020000
[02.22 08:37:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   510/13416 [0:27:15<11:25:25, 0.31Hz] | epoch=0.46, loss=0.020400
[02.22 08:38:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   515/13416 [0:27:31<11:24:55, 0.31Hz] | epoch=0.46, loss=0.021100
[02.22 08:38:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   520/13416 [0:27:47<11:24:26, 0.31Hz] | epoch=0.47, loss=0.020600
[02.22 08:38:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   525/13416 [0:28:03<11:24:20, 0.31Hz] | epoch=0.47, loss=0.017700
[02.22 08:38:48] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   530/13416 [0:28:19<11:23:57, 0.31Hz] | epoch=0.47, loss=0.020300
[02.22 08:39:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   535/13416 [0:28:36<11:24:01, 0.31Hz] | epoch=0.48, loss=0.021700
[02.22 08:39:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   540/13416 [0:28:52<11:24:04, 0.31Hz] | epoch=0.48, loss=0.020800
[02.22 08:39:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   545/13416 [0:29:08<11:24:14, 0.31Hz] | epoch=0.49, loss=0.019600
[02.22 08:39:53] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   550/13416 [0:29:24<11:23:37, 0.31Hz] | epoch=0.49, loss=0.020300
[02.22 08:40:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   555/13416 [0:29:40<11:22:57, 0.31Hz] | epoch=0.50, loss=0.020100
[02.22 08:40:41] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   2%|▎                   |  1/57 [0:00:19<0:18:17, 0.05Hz]
[02.22 08:41:00] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   4%|▋                   |  2/57 [0:00:38<0:17:50, 0.05Hz]
[02.22 08:41:15] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   5%|█                   |  3/57 [0:00:53<0:16:03, 0.06Hz]
[02.22 08:41:23] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   7%|█▍                  |  4/57 [0:01:01<0:13:35, 0.06Hz]
[02.22 08:41:42] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]   9%|█▊                  |  5/57 [0:01:20<0:13:56, 0.06Hz]
[02.22 08:41:54] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  11%|██                  |  6/57 [0:01:32<0:13:06, 0.06Hz]
[02.22 08:42:03] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  12%|██▍                 |  7/57 [0:01:41<0:12:05, 0.07Hz]
[02.22 08:42:22] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  14%|██▊                 |  8/57 [0:02:00<0:12:18, 0.07Hz]
[02.22 08:42:38] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  16%|███▏                |  9/57 [0:02:17<0:12:12, 0.07Hz]
[02.22 08:42:57] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  18%|███▌                | 10/57 [0:02:35<0:12:11, 0.06Hz]
[02.22 08:43:07] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  19%|███▊                | 11/57 [0:02:45<0:11:33, 0.07Hz]
[02.22 08:43:24] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  21%|████▏               | 12/57 [0:03:02<0:11:26, 0.07Hz]
[02.22 08:43:31] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  23%|████▌               | 13/57 [0:03:10<0:10:44, 0.07Hz]
[02.22 08:43:37] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  25%|████▉               | 14/57 [0:03:15<0:10:00, 0.07Hz]
[02.22 08:43:42] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  26%|█████▎              | 15/57 [0:03:21<0:09:23, 0.07Hz]
[02.22 08:43:48] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  28%|█████▌              | 16/57 [0:03:26<0:08:50, 0.08Hz]
[02.22 08:43:54] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  30%|█████▉              | 17/57 [0:03:33<0:08:21, 0.08Hz]
[02.22 08:43:59] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  32%|██████▎             | 18/57 [0:03:38<0:07:53, 0.08Hz]
[02.22 08:44:07] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  33%|██████▋             | 19/57 [0:03:45<0:07:31, 0.08Hz]
[02.22 08:44:13] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  35%|███████             | 20/57 [0:03:51<0:07:08, 0.09Hz]
[02.22 08:44:18] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  37%|███████▎            | 21/57 [0:03:57<0:06:46, 0.09Hz]
[02.22 08:44:26] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  39%|███████▋            | 22/57 [0:04:04<0:06:29, 0.09Hz]
[02.22 08:44:33] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  40%|████████            | 23/57 [0:04:12<0:06:12, 0.09Hz]
[02.22 08:44:41] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  42%|████████▍           | 24/57 [0:04:19<0:05:56, 0.09Hz]
[02.22 08:44:49] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  44%|████████▊           | 25/57 [0:04:27<0:05:42, 0.09Hz]
[02.22 08:44:55] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  46%|█████████           | 26/57 [0:04:34<0:05:27, 0.09Hz]
[02.22 08:45:02] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  47%|█████████▍          | 27/57 [0:04:41<0:05:12, 0.10Hz]
[02.22 08:45:09] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  49%|█████████▊          | 28/57 [0:04:48<0:04:58, 0.10Hz]
[02.22 08:45:16] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  51%|██████████▏         | 29/57 [0:04:54<0:04:44, 0.10Hz]
[02.22 08:45:23] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  53%|██████████▌         | 30/57 [0:05:01<0:04:31, 0.10Hz]
[02.22 08:45:29] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  54%|██████████▉         | 31/57 [0:05:07<0:04:18, 0.10Hz]
[02.22 08:45:35] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  56%|███████████▏        | 32/57 [0:05:13<0:04:04, 0.10Hz]
[02.22 08:45:39] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  60%|███████████▉        | 34/57 [0:05:18<0:03:35, 0.11Hz]
[02.22 08:45:43] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  61%|████████████▎       | 35/57 [0:05:21<0:03:22, 0.11Hz]
[02.22 08:45:46] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  63%|████████████▋       | 36/57 [0:05:25<0:03:09, 0.11Hz]
[02.22 08:45:50] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  65%|████████████▉       | 37/57 [0:05:28<0:02:57, 0.11Hz]
[02.22 08:45:57] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  67%|█████████████▎      | 38/57 [0:05:35<0:02:47, 0.11Hz]
[02.22 08:46:05] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  68%|█████████████▋      | 39/57 [0:05:43<0:02:38, 0.11Hz]
[02.22 08:46:18] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  70%|██████████████      | 40/57 [0:05:57<0:02:31, 0.11Hz]
[02.22 08:46:25] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  72%|██████████████▍     | 41/57 [0:06:04<0:02:22, 0.11Hz]
[02.22 08:46:32] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  74%|██████████████▋     | 42/57 [0:06:11<0:02:12, 0.11Hz]
[02.22 08:46:40] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  75%|███████████████     | 43/57 [0:06:19<0:02:03, 0.11Hz]
[02.22 08:46:50] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  77%|███████████████▍    | 44/57 [0:06:29<0:01:54, 0.11Hz]
[02.22 08:47:07] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  79%|███████████████▊    | 45/57 [0:06:45<0:01:48, 0.11Hz]
[02.22 08:47:18] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  81%|████████████████▏   | 46/57 [0:06:57<0:01:39, 0.11Hz]
[02.22 08:47:25] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  82%|████████████████▍   | 47/57 [0:07:03<0:01:30, 0.11Hz]
[02.22 08:47:44] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  84%|████████████████▊   | 48/57 [0:07:22<0:01:23, 0.11Hz]
[02.22 08:47:52] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  86%|█████████████████▏  | 49/57 [0:07:31<0:01:13, 0.11Hz]
[02.22 08:48:03] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  88%|█████████████████▌  | 50/57 [0:07:41<0:01:04, 0.11Hz]
[02.22 08:48:06] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  89%|█████████████████▉  | 51/57 [0:07:45<0:00:54, 0.11Hz]
[02.22 08:48:11] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  91%|██████████████████▏ | 52/57 [0:07:50<0:00:45, 0.11Hz]
[02.22 08:48:17] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  93%|██████████████████▌ | 53/57 [0:07:55<0:00:35, 0.11Hz]
[02.22 08:48:27] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  95%|██████████████████▉ | 54/57 [0:08:05<0:00:26, 0.11Hz]
[02.22 08:48:33] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  96%|███████████████████▎| 55/57 [0:08:12<0:00:17, 0.11Hz]
[02.22 08:48:44] ┇ INFO    ┇        gner.gner_trainer ┇ [checking]  98%|███████████████████▋| 56/57 [0:08:23<0:00:08, 0.11Hz]
[02.22 08:49:03] ┇ INFO    ┇        gner.gner_trainer ┇ [checking] 100%|████████████████████| 57/57 [0:08:42<0:00:00, 0.11Hz]
[02.22 08:49:05] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:49:05] ┇ INFO    ┇           chrisbase.data ┇ [EXIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version FlanT5-3B-BL --pretrained google/flan-t5-xl --trainer_deepspeed configs/deepspeed/ds2_t5.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging ($=00:40:42.659)
[02.22 08:49:05] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank1]:     train_result: TrainOutput = trainer.train()
[rank1]:                                 ^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank1]:     return inner_training_loop(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank1]:     self._maybe_log_save_evaluate(
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank1]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank1]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank1]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank1]:     output = eval_loop(
[rank1]:              ^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank1]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank1]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank1]:                                         ^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank1]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank1]:     all_examples[example['dataset']].append(example)
[rank1]:                  ~~~~~~~^^^^^^^^^^^
[rank1]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank2]:     train_result: TrainOutput = trainer.train()
[rank2]:                                 ^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank2]:     return inner_training_loop(
[rank2]:            ^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank2]:     self._maybe_log_save_evaluate(
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank2]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank2]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank2]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank2]:     output = eval_loop(
[rank2]:              ^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank2]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank2]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank2]:                                         ^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank2]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank2]:     all_examples[example['dataset']].append(example)
[rank2]:                  ~~~~~~~^^^^^^^^^^^
[rank2]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank0]: Traceback (most recent call last):
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank0]:     train_result: TrainOutput = trainer.train()
[rank0]:                                 ^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank0]:     return inner_training_loop(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank0]:     self._maybe_log_save_evaluate(
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank0]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank0]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank0]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank0]:     output = eval_loop(
[rank0]:              ^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank0]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank0]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank0]:                                         ^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank0]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank0]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank0]:     all_examples[example['dataset']].append(example)
[rank0]:                  ~~~~~~~^^^^^^^^^^^
[rank0]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[rank3]: Traceback (most recent call last):
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank3]:     AppTyper.run(main)
[rank3]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank3]:     app()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank3]:     raise e
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank3]:     return get_command(self)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank3]:     return self.main(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank3]:     return _main(
[rank3]:            ^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank3]:     rv = self.invoke(ctx)
[rank3]:          ^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank3]:     return ctx.invoke(self.callback, **ctx.params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank3]:     return __callback(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank3]:     return callback(**use_params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank3]:     train_result: TrainOutput = trainer.train()
[rank3]:                                 ^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank3]:     return inner_training_loop(
[rank3]:            ^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank3]:     self._maybe_log_save_evaluate(
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank3]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank3]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank3]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank3]:     output = eval_loop(
[rank3]:              ^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 403, in evaluation_loop
[rank3]:     metrics = self.compute_metrics(dataset=eval_dataset, preds=all_preds,
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 699, in <lambda>
[rank3]:     compute_metrics = lambda *vs, **ws: eval_predictions(
[rank3]:                                         ^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 366, in eval_predictions
[rank3]:     results = gner.compute_metrics(all_examples, tokenizer=tokenizer, detailed=False, average_key="average")
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/gner/gner_evaluator.py", line 268, in compute_metrics
[rank3]:     all_examples[example['dataset']].append(example)
[rank3]:                  ~~~~~~~^^^^^^^^^^^
[rank3]: TypeError: 'GenNERSampleWrapper' object is not subscriptable
[2025-02-22 08:49:09,689] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3676380
[2025-02-22 08:49:09,732] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3676381
[2025-02-22 08:49:09,772] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3676382
[2025-02-22 08:49:09,773] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3676383
[2025-02-22 08:49:09,815] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'FlanT5-3B-BL', '--pretrained', 'google/flan-t5-xl', '--trainer_deepspeed', 'configs/deepspeed/ds2_t5.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version Llama3-1B-BL --pretrained meta-llama/Llama-3.2-1B --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 08:49:16,971] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:22,780] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 08:49:22,781] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version Llama3-1B-BL --pretrained meta-llama/Llama-3.2-1B --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 08:49:25,160] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:30,936] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 08:49:30,936] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 08:49:30,936] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 08:49:30,936] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 08:49:30,936] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 08:49:30,937] [INFO] [launch.py:256:main] process 3705891 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-1B-BL', '--pretrained', 'meta-llama/Llama-3.2-1B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:49:30,938] [INFO] [launch.py:256:main] process 3705892 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-1B-BL', '--pretrained', 'meta-llama/Llama-3.2-1B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:49:30,938] [INFO] [launch.py:256:main] process 3705893 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-1B-BL', '--pretrained', 'meta-llama/Llama-3.2-1B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:49:30,939] [INFO] [launch.py:256:main] process 3705894 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-1B-BL', '--pretrained', 'meta-llama/Llama-3.2-1B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:49:45,717] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:45,718] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:45,718] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:45,719] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:49:46,378] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:49:46,388] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:49:46,405] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:49:46,405] [INFO] [comm.py:652:init_distributed] cdb=None
[rank0]: Traceback (most recent call last):
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank0]:     raw_datasets.cleanup_cache_files()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank0]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank0]:     os.remove(file_path)
[rank0]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-dfa3775b11797109_00000_of_00004.arrow'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank1]:     raw_datasets.cleanup_cache_files()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank1]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank1]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank1]:     os.remove(file_path)
[rank1]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-d7f72c3e06b5323d_00001_of_00004.arrow'
[rank3]: Traceback (most recent call last):
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank3]:     AppTyper.run(main)
[rank3]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank3]:     app()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank3]:     raise e
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank3]:     return get_command(self)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank3]:     return self.main(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank3]:     return _main(
[rank3]:            ^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank3]:     rv = self.invoke(ctx)
[rank3]:          ^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank3]:     return ctx.invoke(self.callback, **ctx.params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank3]:     return __callback(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank3]:     return callback(**use_params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank3]:     raw_datasets.cleanup_cache_files()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank3]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank3]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank3]:     os.remove(file_path)
[rank3]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-5859a335a6284cac_00002_of_00004.arrow'
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 47.85ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 47.22ba/s]
Creating json from Arrow format:  19%|███████████████████████████████████████████████▍                                                                                                                                                                                                       | 24/125 [00:00<00:01, 51.82ba/s][2025-02-22 08:49:52,941] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3705891
[2025-02-22 08:49:52,941] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3705892
Creating json from Arrow format:  24%|███████████████████████████████████████████████████████████▎                                                                                                                                                                                           | 30/125 [00:00<00:01, 51.89ba/s][2025-02-22 08:49:52,987] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3705893
[2025-02-22 08:49:53,283] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3705894
[2025-02-22 08:49:53,327] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-1B-BL', '--pretrained', 'meta-llama/Llama-3.2-1B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version Llama3-3B-BL --pretrained meta-llama/Llama-3.2-3B --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 08:50:00,666] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:03,569] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 08:50:03,570] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version Llama3-3B-BL --pretrained meta-llama/Llama-3.2-3B --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 08:50:08,870] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:14,620] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 08:50:14,620] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 08:50:14,620] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 08:50:14,620] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 08:50:14,620] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 08:50:14,621] [INFO] [launch.py:256:main] process 3707256 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:50:14,621] [INFO] [launch.py:256:main] process 3707257 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:50:14,622] [INFO] [launch.py:256:main] process 3707258 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:50:14,622] [INFO] [launch.py:256:main] process 3707259 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 08:50:29,560] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:29,562] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:29,563] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:29,563] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 08:50:30,226] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:50:30,233] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:50:30,259] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 08:50:30,300] [INFO] [comm.py:652:init_distributed] cdb=None
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 47.64ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 46.67ba/s]
[02.22 08:50:35] ┇ INFO    ┇                     gner ┇ Loaded raw train (#=143180): configs/dataset/supervised -> data/supervised-train.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 45.63ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 46.80ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 45.71ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 45.59ba/s]
[02.22 08:50:35] ┇ INFO    ┇                     gner ┇ Loaded raw validation (#=3600): configs/dataset/supervised -> data/supervised-validation.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 46.13ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 43.45ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 48.90ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 48.82ba/s]
Creating json from Arrow format:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 122/125 [00:02<00:00, 55.73ba/s][02.22 08:50:38] ┇ INFO    ┇                     gner ┇ Loaded raw test (#=124835): configs/dataset/supervised -> data/supervised-test.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 47.16ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 46.77ba/s]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version Llama3-3B-BL --pretrained meta-llama/Llama-3.2-3B --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   #	TrainingArgumentsForAccelerator              	value
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   1	env.hostname                                 	dgx-a100
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   2	env.hostaddr                                 	129.254.23.12
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   3	env.global_rank                              	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   4	env.local_rank                               	0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   5	env.node_rank                                	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   6	env.world_size                               	4
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   7	env.time_stamp                               	0222-085021
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   8	env.python_path                              	/raid/chrisjihee/miniforge3/envs/GNER/bin/python
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇   9	env.current_dir                              	/raid/chrisjihee/proj/GNER
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  10	env.current_file                             	finetune.py
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  11	env.command_args                             	['--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  12	env.output_home                              	output
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  13	env.output_name                              	GNER-supervised
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  14	env.run_version                              	Llama3-3B-BL
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  15	env.output_file                              	train-metrics-united-12ep-0222-085021.csv
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  16	env.logging_file                             	train-loggings-united-12ep-0222-085021.out
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  17	env.logging_level                            	30
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  18	env.logging_format                           	%(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  19	env.datetime_format                          	[%m.%d %H:%M:%S]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  20	env.argument_file                            	train-arguments-0222-085021.json
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  21	env.random_seed                              	7
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  22	env.max_workers                              	4
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  23	env.debugging                                	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  24	env.output_dir                               	output/GNER-supervised/Llama3-3B-BL
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  25	time.t1                                      	2025-02-22 08:50:38.565909
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  26	time.t2                                      	2025-02-22 08:50:18.580915
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  27	time.started                                 	[02.22 08:50:38]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  28	time.settled
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  29	time.elapsed
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  30	data.data_dir                                	data
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  31	data.data_config_dir                         	configs/dataset/supervised
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  32	data.instruct_file                           	configs/instruction/GNER-paper.json
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  33	data.train_file
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  34	data.study_file
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  35	data.eval_file
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  36	data.pred_file
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  37	data.pretrained                              	meta-llama/Llama-3.2-3B
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  38	data.max_train_samples                       	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  39	data.max_study_samples                       	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  40	data.max_eval_samples                        	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  41	data.max_pred_samples                        	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  42	data.use_cache_data                          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  43	data.progress_seconds                        	10.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  44	data.max_source_length                       	640
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  45	data.max_target_length                       	640
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  46	data.write_predictions                       	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  47	data.ignore_pad_token_for_loss               	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  48	train._n_gpu                                 	1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  49	train.accelerator_config                     	{'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  50	train.adafactor                              	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  51	train.adam_beta1                             	0.9
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  52	train.adam_beta2                             	0.999
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  53	train.adam_epsilon                           	1e-08
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  54	train.auto_find_batch_size                   	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  55	train.average_tokens_across_devices          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  56	train.batch_eval_metrics                     	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  57	train.bf16                                   	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  58	train.bf16_full_eval                         	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  59	train.data_seed
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  60	train.dataloader_drop_last                   	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  61	train.dataloader_num_workers                 	0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  62	train.dataloader_persistent_workers          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  63	train.dataloader_pin_memory                  	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  64	train.dataloader_prefetch_factor
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  65	train.ddp_backend
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  66	train.ddp_broadcast_buffers
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  67	train.ddp_bucket_cap_mb
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  68	train.ddp_find_unused_parameters
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  69	train.ddp_timeout                            	1800
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  70	train.debug                                  	[]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  71	train.deepspeed                              	configs/deepspeed/ds2_llama.json
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  72	train.disable_tqdm                           	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  73	train.dispatch_batches
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  74	train.do_eval                                	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  75	train.do_predict                             	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  76	train.do_train                               	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  77	train.eval_accumulation_steps                	1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  78	train.eval_delay                             	0.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  79	train.eval_do_concat_batches                 	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  80	train.eval_epochs                            	0.5
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  81	train.eval_on_start                          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  82	train.eval_steps                             	9223372036854775807
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  83	train.eval_strategy                          	IntervalStrategy.NO
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  84	train.eval_use_gather_object                 	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  85	train.evaluation_strategy
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  86	train.fp16                                   	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  87	train.fp16_backend                           	auto
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  88	train.fp16_full_eval                         	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  89	train.fp16_opt_level                         	O1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  90	train.fsdp                                   	[]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  91	train.fsdp_config                            	{'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  92	train.fsdp_min_num_params                    	0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  93	train.fsdp_transformer_layer_cls_to_wrap
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  94	train.full_determinism                       	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  95	train.generation_config
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  96	train.generation_max_length                  	640
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  97	train.generation_num_beams                   	1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  98	train.gradient_accumulation_steps            	8
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇  99	train.gradient_checkpointing                 	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 100	train.gradient_checkpointing_kwargs
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 101	train.greater_is_better                      	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 102	train.group_by_length                        	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 103	train.half_precision_backend                 	auto
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 104	train.hub_always_push                        	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 105	train.hub_model_id
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 106	train.hub_private_repo
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 107	train.hub_strategy                           	HubStrategy.EVERY_SAVE
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 108	train.hub_token
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 109	train.ignore_data_skip                       	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 110	train.include_for_metrics                    	[]
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 111	train.include_inputs_for_metrics             	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 112	train.include_num_input_tokens_seen          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 113	train.include_tokens_per_second              	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 114	train.jit_mode_eval                          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 115	train.label_names
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 116	train.label_smoothing_factor                 	0.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 117	train.learning_rate                          	5e-05
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 118	train.length_column_name                     	length
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 119	train.load_best_model_at_end                 	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 120	train.local_rank                             	0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 121	train.log_level                              	warning
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 122	train.log_level_replica                      	error
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 123	train.log_on_each_node                       	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 124	train.logging_dir                            	output/GNER-supervised/Llama3-3B-BL/runs/Feb22_08-50-29_dgx-a100
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 125	train.logging_epochs                         	-1.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 126	train.logging_first_step                     	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 127	train.logging_nan_inf_filter                 	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 128	train.logging_steps                          	5
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 129	train.logging_strategy                       	IntervalStrategy.STEPS
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 130	train.lr_scheduler_kwargs                    	{}
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 131	train.lr_scheduler_type                      	SchedulerType.COSINE
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 132	train.max_grad_norm                          	1.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 133	train.max_steps                              	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 134	train.metric_for_best_model                  	eval_average
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 135	train.mp_parameters
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 136	train.neftune_noise_alpha
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 137	train.no_cuda                                	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 138	train.num_train_epochs                       	12.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 139	train.optim                                  	OptimizerNames.ADAMW_TORCH
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 140	train.optim_args
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 141	train.optim_target_modules
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 142	train.output_dir                             	output/GNER-supervised/Llama3-3B-BL
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 143	train.overwrite_output_dir                   	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 144	train.past_index                             	-1
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 145	train.per_device_eval_batch_size             	16
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 146	train.per_device_train_batch_size            	4
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 147	train.per_gpu_eval_batch_size
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 148	train.per_gpu_train_batch_size
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 149	train.predict_with_generate                  	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 150	train.prediction_loss_only                   	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 151	train.push_to_hub                            	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 152	train.push_to_hub_model_id
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 153	train.push_to_hub_organization
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 154	train.push_to_hub_token
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 155	train.ray_scope                              	last
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 156	train.remove_unused_columns                  	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 157	train.report_to                              	['tensorboard']
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 158	train.restore_callback_states_from_checkpoint	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 159	train.resume_from_checkpoint
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 160	train.run_name                               	output/GNER-supervised/Llama3-3B-BL
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 161	train.save_epochs                            	0.5
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 162	train.save_on_each_node                      	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 163	train.save_only_model                        	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 164	train.save_safetensors                       	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 165	train.save_steps                             	9223372036854775807
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 166	train.save_strategy                          	SaveStrategy.NO
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 167	train.save_total_limit                       	2
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 168	train.seed                                   	7
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 169	train.skip_memory_metrics                    	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 170	train.sortish_sampler                        	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 171	train.split_batches
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 172	train.tf32                                   	True
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 173	train.torch_compile                          	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 174	train.torch_compile_backend
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 175	train.torch_compile_mode
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 176	train.torch_empty_cache_steps
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 177	train.torchdynamo
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 178	train.tpu_metrics_debug                      	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 179	train.tpu_num_cores
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 180	train.use_cpu                                	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 181	train.use_flash_attention                    	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 182	train.use_ipex                               	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 183	train.use_legacy_prediction_loop             	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 184	train.use_liger_kernel                       	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 185	train.use_mps_device                         	False
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 186	train.warmup_ratio                           	0.04
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 187	train.warmup_steps                           	0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ 188	train.weight_decay                           	0.0
[02.22 08:50:38] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.08s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.46s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:04<00:00,  2.46s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:05<00:00,  2.51s/it]
[02.22 08:50:44] ┇ INFO    ┇                     gner ┇ model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
[02.22 08:50:44] ┇ INFO    ┇                     gner ┇ model pad_token_id: 128001
[02.22 08:50:46] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   0%|                    |      4/143180 [0:00:02<20:43:07, 1.92Hz]
[02.22 08:50:48] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   4%|▉                   |   6284/143180 [0:00:04<0:00:39, 3444.68Hz]
[02.22 08:50:50] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   8%|█▋                  |  12004/143180 [0:00:06<0:01:57, 1112.87Hz]
[02.22 08:50:52] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  12%|██▎                 |  16628/143180 [0:00:08<0:00:50, 2500.98Hz]
[02.22 08:50:54] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  15%|██▉                 |  21240/143180 [0:00:10<0:01:03, 1931.00Hz]
[02.22 08:50:56] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  19%|███▋                |  26788/143180 [0:00:12<0:00:36, 3168.48Hz]
[02.22 08:50:58] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  23%|████▌               |  32668/143180 [0:00:14<0:00:32, 3356.18Hz]
[02.22 08:51:00] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  27%|█████▍              |  39284/143180 [0:00:16<0:00:28, 3695.78Hz]
[02.22 08:51:02] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  32%|██████▎             |  45412/143180 [0:00:18<0:00:33, 2894.79Hz]
[02.22 08:51:04] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  36%|███████▎            |  51992/143180 [0:00:20<0:00:24, 3790.56Hz]
[02.22 08:51:06] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  41%|████████▏           |  58228/143180 [0:00:22<0:00:23, 3601.35Hz]
[02.22 08:51:08] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  45%|█████████           |  64576/143180 [0:00:24<0:00:22, 3418.20Hz]
[02.22 08:51:10] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  49%|█████████▉          |  70812/143180 [0:00:26<0:00:20, 3516.00Hz]
[02.22 08:51:12] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  54%|██████████▋         |  76644/143180 [0:00:28<0:00:19, 3410.31Hz]
[02.22 08:51:14] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  58%|███████████▌        |  83056/143180 [0:00:30<0:00:16, 3677.04Hz]
[02.22 08:51:16] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  62%|████████████▍       |  88884/143180 [0:00:32<0:00:21, 2487.74Hz]
[02.22 08:51:18] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  66%|█████████████▎      |  95172/143180 [0:00:34<0:00:14, 3394.76Hz]
[02.22 08:51:20] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  71%|██████████████▏     | 101168/143180 [0:00:36<0:00:11, 3524.46Hz]
[02.22 08:51:22] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  75%|███████████████     | 107944/143180 [0:00:38<0:00:09, 3811.19Hz]
[02.22 08:51:24] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  80%|████████████████    | 114592/143180 [0:00:40<0:00:07, 3929.67Hz]
[02.22 08:51:26] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  85%|████████████████▉   | 121336/143180 [0:00:42<0:00:05, 3925.95Hz]
[02.22 08:51:28] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  90%|██████████████████  | 129112/143180 [0:00:44<0:00:03, 4283.07Hz]
[02.22 08:51:30] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  95%|██████████████████▉ | 136004/143180 [0:00:46<0:00:04, 1624.70Hz]
[02.22 08:51:32] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset: 100%|████████████████████| 143180/143180 [0:00:48<0:00:00, 4105.54Hz]
[02.22 08:51:33] ┇ INFO    ┇                     gner ┇ Completed preprocessing for train_dataset by meta-llama/Llama-3.2-3B at [02.22 08:51:32]
[02.22 08:51:41] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset:   0%|                    |    4/3600 [0:00:02<0:30:56, 1.94Hz]
[02.22 08:51:41] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset: 100%|████████████████████| 3600/3600 [0:00:02<0:00:00, 8142.08Hz]
[02.22 08:51:43] ┇ INFO    ┇                     gner ┇ Completed preprocessing for eval_dataset by meta-llama/Llama-3.2-3B at [02.22 08:51:42]
[02.22 08:51:45] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:   0%|                    |      4/124835 [0:00:02<18:39:20, 1.86Hz]
[02.22 08:51:47] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:   9%|█▊                  |  11688/124835 [0:00:04<0:00:16, 6830.87Hz]
[02.22 08:51:49] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  19%|███▊                |  23992/124835 [0:00:06<0:00:14, 6963.97Hz]
[02.22 08:51:51] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  29%|█████▊              |  36432/124835 [0:00:08<0:00:13, 6651.23Hz]
[02.22 08:51:53] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  39%|███████▊            |  48380/124835 [0:00:10<0:00:10, 7230.31Hz]
[02.22 08:51:55] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  48%|█████████▋          |  60388/124835 [0:00:12<0:00:09, 7048.23Hz]
[02.22 08:51:57] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  58%|███████████▋        |  72788/124835 [0:00:14<0:00:07, 7039.84Hz]
[02.22 08:51:59] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  68%|█████████████▌      |  84288/124835 [0:00:16<0:00:05, 6903.55Hz]
[02.22 08:52:01] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  77%|███████████████▍    |  96408/124835 [0:00:18<0:00:04, 6824.98Hz]
[02.22 08:52:03] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  87%|█████████████████▍  | 108656/124835 [0:00:20<0:00:02, 6865.44Hz]
[02.22 08:52:05] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  97%|███████████████████▎| 120824/124835 [0:00:22<0:00:00, 6988.25Hz]
[02.22 08:52:05] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset: 100%|████████████████████| 124835/124835 [0:00:22<0:00:00, 6983.05Hz]
[02.22 08:52:07] ┇ INFO    ┇                     gner ┇ Completed preprocessing for pred_dataset by meta-llama/Llama-3.2-3B at [02.22 08:52:06]
[02.22 08:52:44] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ ***** Beginning Training *****
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Epochs       = 12.0
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Examples     = 143,180
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Batch Size   = 128 = 4 * 8 * 4
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Optim Steps  = 13,416 = 1,118 * 12.0
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Type   = llama
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Path   = meta-llama/Llama-3.2-3B
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Class  = LlamaForCausalLM
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Params = 3,212,749,824
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, TensorBoardCallback, CustomProgressCallback
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Zero Optim Stage   = 2
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Examples      = 3,600
[02.22 08:52:44] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Batch Size    = 64 = 16 * 4
[02.22 08:53:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |     5/13416 [0:00:22<16:46:08, 0.22Hz] | epoch=0.00, loss=0.664800
[02.22 08:53:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    10/13416 [0:00:38<14:11:58, 0.26Hz] | epoch=0.01, loss=0.246200
[02.22 08:53:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    15/13416 [0:00:53<13:19:22, 0.28Hz] | epoch=0.01, loss=0.118300
[02.22 08:53:53] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    20/13416 [0:01:09<12:55:13, 0.29Hz] | epoch=0.02, loss=0.077300
[02.22 08:54:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    25/13416 [0:01:25<12:43:00, 0.29Hz] | epoch=0.02, loss=0.064000
[02.22 08:54:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    30/13416 [0:01:41<12:33:45, 0.30Hz] | epoch=0.03, loss=0.056700
[02.22 08:54:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    35/13416 [0:01:57<12:27:03, 0.30Hz] | epoch=0.03, loss=0.048000
[02.22 08:54:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    40/13416 [0:02:13<12:21:21, 0.30Hz] | epoch=0.04, loss=0.046000
[02.22 08:55:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    45/13416 [0:02:28<12:17:11, 0.30Hz] | epoch=0.04, loss=0.045700
[02.22 08:55:29] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    50/13416 [0:02:45<12:17:04, 0.30Hz] | epoch=0.04, loss=0.039600
[02.22 08:55:45] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    55/13416 [0:03:00<12:11:59, 0.30Hz] | epoch=0.05, loss=0.033900
[02.22 08:56:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    60/13416 [0:03:16<12:10:00, 0.30Hz] | epoch=0.05, loss=0.037000
[02.22 08:56:17] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    65/13416 [0:03:33<12:09:28, 0.31Hz] | epoch=0.06, loss=0.033200
[02.22 08:56:33] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    70/13416 [0:03:48<12:07:03, 0.31Hz] | epoch=0.06, loss=0.032100
[02.22 08:56:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    75/13416 [0:04:04<12:04:56, 0.31Hz] | epoch=0.07, loss=0.031600
[02.22 08:57:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    80/13416 [0:04:20<12:04:19, 0.31Hz] | epoch=0.07, loss=0.031200
[02.22 08:57:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    85/13416 [0:04:36<12:02:12, 0.31Hz] | epoch=0.08, loss=0.032000
[02.22 08:57:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    90/13416 [0:04:52<12:02:26, 0.31Hz] | epoch=0.08, loss=0.029600
[02.22 08:57:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    95/13416 [0:05:10<12:04:35, 0.31Hz] | epoch=0.09, loss=0.030700
[02.22 08:58:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   100/13416 [0:05:26<12:04:14, 0.31Hz] | epoch=0.09, loss=0.029200
[02.22 08:58:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   105/13416 [0:05:42<12:02:59, 0.31Hz] | epoch=0.09, loss=0.031200
[02.22 08:58:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   110/13416 [0:05:57<12:01:23, 0.31Hz] | epoch=0.10, loss=0.028300
[02.22 08:58:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   115/13416 [0:06:14<12:01:34, 0.31Hz] | epoch=0.10, loss=0.028800
[02.22 08:59:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   120/13416 [0:06:30<12:01:16, 0.31Hz] | epoch=0.11, loss=0.026500
[02.22 08:59:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   125/13416 [0:06:46<12:00:08, 0.31Hz] | epoch=0.11, loss=0.026800
[02.22 08:59:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   130/13416 [0:07:02<11:59:36, 0.31Hz] | epoch=0.12, loss=0.024600
[02.22 09:00:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   135/13416 [0:07:18<11:58:53, 0.31Hz] | epoch=0.12, loss=0.026400
[02.22 09:00:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   140/13416 [0:07:34<11:58:36, 0.31Hz] | epoch=0.12, loss=0.028000
[02.22 09:00:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   145/13416 [0:07:50<11:57:38, 0.31Hz] | epoch=0.13, loss=0.024200
[02.22 09:00:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   150/13416 [0:08:06<11:56:39, 0.31Hz] | epoch=0.13, loss=0.021900
[02.22 09:01:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   155/13416 [0:08:21<11:55:22, 0.31Hz] | epoch=0.14, loss=0.028300
[02.22 09:01:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   160/13416 [0:08:37<11:55:11, 0.31Hz] | epoch=0.14, loss=0.032400
[02.22 09:01:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   165/13416 [0:08:53<11:54:39, 0.31Hz] | epoch=0.15, loss=0.028000
[02.22 09:01:53] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   170/13416 [0:09:09<11:53:23, 0.31Hz] | epoch=0.15, loss=0.025100
[02.22 09:02:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   175/13416 [0:09:26<11:54:31, 0.31Hz] | epoch=0.16, loss=0.024900
[02.22 09:02:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   180/13416 [0:09:42<11:54:04, 0.31Hz] | epoch=0.16, loss=0.023600
[02.22 09:02:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   185/13416 [0:10:00<11:55:14, 0.31Hz] | epoch=0.17, loss=0.024800
[02.22 09:03:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   190/13416 [0:10:17<11:56:48, 0.31Hz] | epoch=0.17, loss=0.025900
[02.22 09:03:18] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   195/13416 [0:10:34<11:56:43, 0.31Hz] | epoch=0.17, loss=0.022800
[02.22 09:03:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   200/13416 [0:10:50<11:56:46, 0.31Hz] | epoch=0.18, loss=0.022400
[02.22 09:03:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   205/13416 [0:11:06<11:56:05, 0.31Hz] | epoch=0.18, loss=0.024300
[02.22 09:04:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   210/13416 [0:11:22<11:55:33, 0.31Hz] | epoch=0.19, loss=0.020000
[02.22 09:04:23] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   215/13416 [0:11:38<11:55:13, 0.31Hz] | epoch=0.19, loss=0.024200
[02.22 09:04:40] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   220/13416 [0:11:56<11:55:51, 0.31Hz] | epoch=0.20, loss=0.022100
[02.22 09:04:56] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   225/13416 [0:12:11<11:54:50, 0.31Hz] | epoch=0.20, loss=0.023200
[02.22 09:05:12] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   230/13416 [0:12:27<11:54:21, 0.31Hz] | epoch=0.21, loss=0.022200
[02.22 09:05:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   235/13416 [0:12:44<11:54:36, 0.31Hz] | epoch=0.21, loss=0.025700
[02.22 09:05:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   240/13416 [0:13:00<11:53:56, 0.31Hz] | epoch=0.21, loss=0.022000
[02.22 09:06:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   245/13416 [0:13:16<11:53:54, 0.31Hz] | epoch=0.22, loss=0.025400
[02.22 09:06:17] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   250/13416 [0:13:32<11:53:11, 0.31Hz] | epoch=0.22, loss=0.020400
[02.22 09:06:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   255/13416 [0:13:48<11:52:27, 0.31Hz] | epoch=0.23, loss=0.024400
[02.22 09:06:48] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   260/13416 [0:14:04<11:51:58, 0.31Hz] | epoch=0.23, loss=0.027500
[02.22 09:07:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   265/13416 [0:14:19<11:51:10, 0.31Hz] | epoch=0.24, loss=0.025600
[02.22 09:07:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   270/13416 [0:14:35<11:50:19, 0.31Hz] | epoch=0.24, loss=0.025500
[02.22 09:07:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   275/13416 [0:14:50<11:49:01, 0.31Hz] | epoch=0.25, loss=0.020800
[02.22 09:07:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   280/13416 [0:15:05<11:48:19, 0.31Hz] | epoch=0.25, loss=0.020700
[02.22 09:08:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   285/13416 [0:15:21<11:47:28, 0.31Hz] | epoch=0.26, loss=0.021800
[02.22 09:08:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   290/13416 [0:15:38<11:47:44, 0.31Hz] | epoch=0.26, loss=0.019700
[02.22 09:08:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   295/13416 [0:15:53<11:46:55, 0.31Hz] | epoch=0.26, loss=0.022400
[02.22 09:08:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   300/13416 [0:16:10<11:47:27, 0.31Hz] | epoch=0.27, loss=0.021400
[02.22 09:09:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   305/13416 [0:16:27<11:47:25, 0.31Hz] | epoch=0.27, loss=0.021800
[02.22 09:09:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   310/13416 [0:16:44<11:47:34, 0.31Hz] | epoch=0.28, loss=0.021800
[02.22 09:09:45] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   315/13416 [0:17:00<11:47:31, 0.31Hz] | epoch=0.28, loss=0.020800
[02.22 09:10:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   320/13416 [0:17:17<11:43:00, 0.31Hz] | epoch=0.29, loss=0.020000
[02.22 09:10:17] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   325/13416 [0:17:33<11:43:08, 0.31Hz] | epoch=0.29, loss=0.019900
[02.22 09:10:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   330/13416 [0:17:49<11:43:22, 0.31Hz] | epoch=0.29, loss=0.021100
[02.22 09:10:50] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   335/13416 [0:18:05<11:43:34, 0.31Hz] | epoch=0.30, loss=0.020800
[02.22 09:11:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   340/13416 [0:18:22<11:43:21, 0.31Hz] | epoch=0.30, loss=0.017800
[02.22 09:11:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   345/13416 [0:18:37<11:42:57, 0.31Hz] | epoch=0.31, loss=0.018500
[02.22 09:11:39] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   350/13416 [0:18:54<11:43:16, 0.31Hz] | epoch=0.31, loss=0.020200
[02.22 09:11:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   355/13416 [0:19:09<11:42:43, 0.31Hz] | epoch=0.32, loss=0.018700
[02.22 09:12:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   360/13416 [0:19:25<11:42:02, 0.31Hz] | epoch=0.32, loss=0.016100
[02.22 09:12:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   365/13416 [0:19:41<11:41:21, 0.31Hz] | epoch=0.33, loss=0.019000
[02.22 09:12:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   370/13416 [0:19:56<11:41:24, 0.31Hz] | epoch=0.33, loss=0.020700
[02.22 09:12:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   375/13416 [0:20:13<11:41:30, 0.31Hz] | epoch=0.34, loss=0.019100
[02.22 09:13:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   380/13416 [0:20:29<11:40:46, 0.31Hz] | epoch=0.34, loss=0.020200
[02.22 09:13:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   385/13416 [0:20:45<11:41:01, 0.31Hz] | epoch=0.34, loss=0.020000
[02.22 09:13:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   390/13416 [0:21:01<11:40:58, 0.31Hz] | epoch=0.35, loss=0.021100
[02.22 09:14:03] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   395/13416 [0:21:18<11:41:21, 0.31Hz] | epoch=0.35, loss=0.022600
[02.22 09:14:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   400/13416 [0:21:34<11:41:24, 0.31Hz] | epoch=0.36, loss=0.019300
[02.22 09:14:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   405/13416 [0:21:50<11:40:40, 0.31Hz] | epoch=0.36, loss=0.019800
[02.22 09:14:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   410/13416 [0:22:06<11:39:33, 0.31Hz] | epoch=0.37, loss=0.022200
[02.22 09:15:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   415/13416 [0:22:23<11:39:21, 0.31Hz] | epoch=0.37, loss=0.019800
[02.22 09:15:23] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   420/13416 [0:22:38<11:38:50, 0.31Hz] | epoch=0.38, loss=0.021500
[02.22 09:15:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   425/13416 [0:22:54<11:38:44, 0.31Hz] | epoch=0.38, loss=0.020000
[02.22 09:15:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   430/13416 [0:23:10<11:38:21, 0.31Hz] | epoch=0.39, loss=0.019700
[02.22 09:16:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   435/13416 [0:23:25<11:37:21, 0.31Hz] | epoch=0.39, loss=0.018700
[02.22 09:16:25] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   440/13416 [0:23:41<11:36:51, 0.31Hz] | epoch=0.39, loss=0.017800
[02.22 09:16:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   445/13416 [0:23:56<11:36:13, 0.31Hz] | epoch=0.40, loss=0.020100
[02.22 09:16:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   450/13416 [0:24:12<11:35:50, 0.31Hz] | epoch=0.40, loss=0.016200
[02.22 09:17:12] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   455/13416 [0:24:28<11:35:00, 0.31Hz] | epoch=0.41, loss=0.019800
[02.22 09:17:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   460/13416 [0:24:44<11:34:47, 0.31Hz] | epoch=0.41, loss=0.017800
[02.22 09:17:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   465/13416 [0:24:59<11:34:36, 0.31Hz] | epoch=0.42, loss=0.019300
[02.22 09:18:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   470/13416 [0:25:15<11:34:33, 0.31Hz] | epoch=0.42, loss=0.018300
[02.22 09:18:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   475/13416 [0:25:31<11:34:06, 0.31Hz] | epoch=0.42, loss=0.017900
[02.22 09:18:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   480/13416 [0:25:47<11:33:48, 0.31Hz] | epoch=0.43, loss=0.020900
[02.22 09:18:48] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   485/13416 [0:26:03<11:34:00, 0.31Hz] | epoch=0.43, loss=0.019600
[02.22 09:19:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   490/13416 [0:26:19<11:32:44, 0.31Hz] | epoch=0.44, loss=0.019700
[02.22 09:19:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   495/13416 [0:26:35<11:32:41, 0.31Hz] | epoch=0.44, loss=0.019000
[02.22 09:19:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   500/13416 [0:26:51<11:31:08, 0.31Hz] | epoch=0.45, loss=0.016900
[02.22 09:19:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   505/13416 [0:27:06<11:29:14, 0.31Hz] | epoch=0.45, loss=0.019000
[02.22 09:20:07] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   510/13416 [0:27:22<11:28:30, 0.31Hz] | epoch=0.46, loss=0.017800
[02.22 09:20:23] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   515/13416 [0:27:38<11:27:57, 0.31Hz] | epoch=0.46, loss=0.019100
[02.22 09:20:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   520/13416 [0:27:54<11:27:30, 0.31Hz] | epoch=0.47, loss=0.020600
[02.22 09:20:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   525/13416 [0:28:09<11:26:59, 0.31Hz] | epoch=0.47, loss=0.018500
[02.22 09:21:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   530/13416 [0:28:25<11:26:22, 0.31Hz] | epoch=0.47, loss=0.019100
[02.22 09:21:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   535/13416 [0:28:41<11:25:31, 0.31Hz] | epoch=0.48, loss=0.019600
[02.22 09:21:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   540/13416 [0:28:57<11:25:32, 0.31Hz] | epoch=0.48, loss=0.019500
[02.22 09:21:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   545/13416 [0:29:15<11:26:10, 0.31Hz] | epoch=0.49, loss=0.018900
[02.22 09:22:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   550/13416 [0:29:31<11:25:17, 0.31Hz] | epoch=0.49, loss=0.018900
[02.22 09:22:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   555/13416 [0:29:46<11:24:40, 0.31Hz] | epoch=0.50, loss=0.019700
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank2]:     train_result: TrainOutput = trainer.train()
[rank2]:                                 ^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank2]:     return inner_training_loop(
[rank2]:            ^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank2]:     self._maybe_log_save_evaluate(
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank2]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank2]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank2]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank2]:     output = eval_loop(
[rank2]:              ^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 303, in evaluation_loop
[rank2]:     loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
[rank2]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 333, in prediction_step
[rank2]:     generated_tokens = self.model.generate(**generation_inputs, **gen_kwargs)
[rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 2080, in generate
[rank2]:     self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 1416, in _validate_generated_length
[rank2]:     raise ValueError(
[rank2]: ValueError: Input length of input_ids is 767, but `max_length` is set to 640. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank1]:     train_result: TrainOutput = trainer.train()
[rank1]:                                 ^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank1]:     return inner_training_loop(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank1]:     self._maybe_log_save_evaluate(
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank1]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank1]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank1]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank1]:     output = eval_loop(
[rank1]:              ^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 303, in evaluation_loop
[rank1]:     loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
[rank1]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 333, in prediction_step
[rank1]:     generated_tokens = self.model.generate(**generation_inputs, **gen_kwargs)
[rank1]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 2080, in generate
[rank1]:     self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 1416, in _validate_generated_length
[rank1]:     raise ValueError(
[rank1]: ValueError: Input length of input_ids is 660, but `max_length` is set to 640. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
[2025-02-22 09:22:47,764] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3707256
[2025-02-22 09:22:48,302] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3707257
[2025-02-22 09:22:48,344] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3707258
[2025-02-22 09:22:48,344] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3707259
[2025-02-22 09:22:51,184] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'Llama3-3B-BL', '--pretrained', 'meta-llama/Llama-3.2-3B', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version EAGLE-1B-BL --pretrained etri-lirs/egpt-1.3b-preview --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 09:22:55,681] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:01,464] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 09:23:01,464] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version EAGLE-1B-BL --pretrained etri-lirs/egpt-1.3b-preview --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 09:23:03,904] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:09,655] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 09:23:09,655] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 09:23:09,655] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 09:23:09,655] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 09:23:09,655] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 09:23:09,656] [INFO] [launch.py:256:main] process 3730981 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-1B-BL', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:09,656] [INFO] [launch.py:256:main] process 3730982 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-1B-BL', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:09,657] [INFO] [launch.py:256:main] process 3730983 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-1B-BL', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:09,658] [INFO] [launch.py:256:main] process 3730984 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-1B-BL', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:24,811] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:24,812] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:24,814] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:24,814] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:25,462] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:23:25,484] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:23:25,492] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:23:25,521] [INFO] [comm.py:652:init_distributed] cdb=None
[rank0]: Traceback (most recent call last):
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank0]:     AppTyper.run(main)
[rank0]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank0]:     app()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank0]:     raise e
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank0]:     return get_command(self)(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank0]:     return self.main(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank0]:     return _main(
[rank0]:            ^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank0]:     rv = self.invoke(ctx)
[rank0]:          ^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank0]:     return ctx.invoke(self.callback, **ctx.params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank0]:     return __callback(*args, **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank0]:     return callback(**use_params)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank0]:     raw_datasets.cleanup_cache_files()
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank0]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank0]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank0]:     os.remove(file_path)
[rank0]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-3771f73adbdb2fa6_00003_of_00004.arrow'
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank1]:     raw_datasets.cleanup_cache_files()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank1]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank1]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank1]:     os.remove(file_path)
[rank1]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-dfec97690ff825f1_00001_of_00004.arrow'
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 567, in main
[rank2]:     raw_datasets.cleanup_cache_files()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/dataset_dict.py", line 256, in cleanup_cache_files
[rank2]:     return {k: dataset.cleanup_cache_files() for k, dataset in self.items()}
[rank2]:                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/datasets/arrow_dataset.py", line 2824, in cleanup_cache_files
[rank2]:     os.remove(file_path)
[rank2]: FileNotFoundError: [Errno 2] No such file or directory: '/raid/chrisjihee/.cache/huggingface/datasets/gner_dataset/default-ab0c5a7139c42a8e/0.0.0/9109c58ada9591a04abc1d5c98f192ca2eec81ea7fa627a55c09354537b66ac8/cache-d137dc2d79266b46_00001_of_00004.arrow'
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 50.53ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 46.54ba/s]
Creating json from Arrow format:  29%|███████████████████████████████████████████████████████████████████████▏                                                                                                                                                                               | 36/125 [00:00<00:01, 52.18ba/s][2025-02-22 09:23:31,659] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3730981
[2025-02-22 09:23:31,701] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3730982
[2025-02-22 09:23:31,701] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3730983
Creating json from Arrow format:  34%|██████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                    | 42/125 [00:00<00:01, 53.59ba/s][2025-02-22 09:23:31,739] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3730984
[2025-02-22 09:23:32,030] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-1B-BL', '--pretrained', 'etri-lirs/egpt-1.3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




************************************************************************************************************************
[COMMAND] python -m deepspeed.launcher.runner --include=localhost:0,1,2,3 --master_port=29034 finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version EAGLE-3B-BL --pretrained etri-lirs/eagle-3b-preview --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
************************************************************************************************************************
[2025-02-22 09:23:39,515] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:42,447] [WARNING] [runner.py:215:fetch_hostfile] Unable to find hostfile, will proceed with training with local resources only.
[2025-02-22 09:23:42,448] [INFO] [runner.py:607:main] cmd = /raid/chrisjihee/miniforge3/envs/GNER/bin/python -u -m deepspeed.launcher.launch --world_info=eyJsb2NhbGhvc3QiOiBbMCwgMSwgMiwgM119 --master_addr=127.0.0.1 --master_port=29034 --enable_each_rank_log=None finetune.py --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version EAGLE-3B-BL --pretrained etri-lirs/eagle-3b-preview --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[2025-02-22 09:23:47,504] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:23:50,676] [INFO] [launch.py:146:main] WORLD INFO DICT: {'localhost': [0, 1, 2, 3]}
[2025-02-22 09:23:50,676] [INFO] [launch.py:152:main] nnodes=1, num_local_procs=4, node_rank=0
[2025-02-22 09:23:50,676] [INFO] [launch.py:163:main] global_rank_mapping=defaultdict(<class 'list'>, {'localhost': [0, 1, 2, 3]})
[2025-02-22 09:23:50,676] [INFO] [launch.py:164:main] dist_world_size=4
[2025-02-22 09:23:50,676] [INFO] [launch.py:168:main] Setting CUDA_VISIBLE_DEVICES=0,1,2,3
[2025-02-22 09:23:50,677] [INFO] [launch.py:256:main] process 3732353 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:50,678] [INFO] [launch.py:256:main] process 3732354 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=1', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:50,678] [INFO] [launch.py:256:main] process 3732355 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=2', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:23:50,679] [INFO] [launch.py:256:main] process 3732356 spawned with command: ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[2025-02-22 09:24:04,831] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:24:04,832] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:24:04,832] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:24:04,832] [INFO] [real_accelerator.py:222:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-02-22 09:24:05,505] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:24:05,507] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:24:05,517] [INFO] [comm.py:652:init_distributed] cdb=None
[2025-02-22 09:24:05,522] [INFO] [comm.py:652:init_distributed] cdb=None
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 51.72ba/s]
[02.22 09:24:10] ┇ INFO    ┇                     gner ┇ Loaded raw train (#=143180): configs/dataset/supervised -> data/supervised-train.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 48.99ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:02<00:00, 49.31ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 49.85ba/s]
[02.22 09:24:10] ┇ INFO    ┇                     gner ┇ Loaded raw validation (#=3600): configs/dataset/supervised -> data/supervised-validation.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 45.14ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 47.66ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 144/144 [00:03<00:00, 47.45ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 41.06ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.13ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.23ba/s]
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.22ba/s]
Creating json from Arrow format:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏             | 118/125 [00:02<00:00, 57.73ba/s][02.22 09:24:13] ┇ INFO    ┇                     gner ┇ Loaded raw test (#=124835): configs/dataset/supervised -> data/supervised-test.jsonl
Creating json from Arrow format: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 125/125 [00:02<00:00, 50.57ba/s]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ [INIT] python finetune.py --local_rank=0 --data_config_dir configs/dataset/supervised --output_file train-metrics-united-12ep.csv --logging_file train-loggings-united-12ep.out --output_name GNER-supervised --run_version EAGLE-3B-BL --pretrained etri-lirs/eagle-3b-preview --trainer_deepspeed configs/deepspeed/ds2_llama.json --num_train_epochs 12 --eval_epochs 0.5 --save_epochs 0.5 --learning_rate 5e-05 --logging_steps 5 --per_device_eval_batch_size 16 --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --generation_max_length 640 --save_total_limit 2 --metric_for_best_model eval_average --no_use_flash_attention --no_debugging
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ =========================================================================================================================================
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   #	TrainingArgumentsForAccelerator              	value
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   1	env.hostname                                 	dgx-a100
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   2	env.hostaddr                                 	129.254.23.12
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   3	env.global_rank                              	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   4	env.local_rank                               	0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   5	env.node_rank                                	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   6	env.world_size                               	4
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   7	env.time_stamp                               	0222-092355
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   8	env.python_path                              	/raid/chrisjihee/miniforge3/envs/GNER/bin/python
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇   9	env.current_dir                              	/raid/chrisjihee/proj/GNER
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  10	env.current_file                             	finetune.py
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  11	env.command_args                             	['--local_rank=0', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging']
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  12	env.output_home                              	output
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  13	env.output_name                              	GNER-supervised
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  14	env.run_version                              	EAGLE-3B-BL
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  15	env.output_file                              	train-metrics-united-12ep-0222-092355.csv
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  16	env.logging_file                             	train-loggings-united-12ep-0222-092355.out
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  17	env.logging_level                            	30
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  18	env.logging_format                           	%(asctime)s ┇ %(levelname)-7s ┇ %(name)24s ┇ %(message)s
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  19	env.datetime_format                          	[%m.%d %H:%M:%S]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  20	env.argument_file                            	train-arguments-0222-092355.json
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  21	env.random_seed                              	7
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  22	env.max_workers                              	4
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  23	env.debugging                                	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  24	env.output_dir                               	output/GNER-supervised/EAGLE-3B-BL
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  25	time.t1                                      	2025-02-22 09:24:13.515708
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  26	time.t2                                      	2025-02-22 09:23:54.388295
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  27	time.started                                 	[02.22 09:24:13]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  28	time.settled
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  29	time.elapsed
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  30	data.data_dir                                	data
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  31	data.data_config_dir                         	configs/dataset/supervised
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  32	data.instruct_file                           	configs/instruction/GNER-paper.json
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  33	data.train_file
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  34	data.study_file
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  35	data.eval_file
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  36	data.pred_file
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  37	data.pretrained                              	etri-lirs/eagle-3b-preview
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  38	data.max_train_samples                       	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  39	data.max_study_samples                       	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  40	data.max_eval_samples                        	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  41	data.max_pred_samples                        	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  42	data.use_cache_data                          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  43	data.progress_seconds                        	10.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  44	data.max_source_length                       	640
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  45	data.max_target_length                       	640
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  46	data.write_predictions                       	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  47	data.ignore_pad_token_for_loss               	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  48	train._n_gpu                                 	1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  49	train.accelerator_config                     	{'split_batches': False, 'dispatch_batches': None, 'even_batches': True, 'use_seedable_sampler': True, 'non_blocking': False, 'gradient_accumulation_kwargs': None, 'use_configured_state': False}
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  50	train.adafactor                              	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  51	train.adam_beta1                             	0.9
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  52	train.adam_beta2                             	0.999
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  53	train.adam_epsilon                           	1e-08
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  54	train.auto_find_batch_size                   	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  55	train.average_tokens_across_devices          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  56	train.batch_eval_metrics                     	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  57	train.bf16                                   	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  58	train.bf16_full_eval                         	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  59	train.data_seed
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  60	train.dataloader_drop_last                   	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  61	train.dataloader_num_workers                 	0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  62	train.dataloader_persistent_workers          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  63	train.dataloader_pin_memory                  	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  64	train.dataloader_prefetch_factor
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  65	train.ddp_backend
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  66	train.ddp_broadcast_buffers
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  67	train.ddp_bucket_cap_mb
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  68	train.ddp_find_unused_parameters
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  69	train.ddp_timeout                            	1800
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  70	train.debug                                  	[]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  71	train.deepspeed                              	configs/deepspeed/ds2_llama.json
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  72	train.disable_tqdm                           	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  73	train.dispatch_batches
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  74	train.do_eval                                	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  75	train.do_predict                             	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  76	train.do_train                               	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  77	train.eval_accumulation_steps                	1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  78	train.eval_delay                             	0.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  79	train.eval_do_concat_batches                 	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  80	train.eval_epochs                            	0.5
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  81	train.eval_on_start                          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  82	train.eval_steps                             	9223372036854775807
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  83	train.eval_strategy                          	IntervalStrategy.NO
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  84	train.eval_use_gather_object                 	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  85	train.evaluation_strategy
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  86	train.fp16                                   	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  87	train.fp16_backend                           	auto
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  88	train.fp16_full_eval                         	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  89	train.fp16_opt_level                         	O1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  90	train.fsdp                                   	[]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  91	train.fsdp_config                            	{'min_num_params': 0, 'xla': False, 'xla_fsdp_v2': False, 'xla_fsdp_grad_ckpt': False}
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  92	train.fsdp_min_num_params                    	0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  93	train.fsdp_transformer_layer_cls_to_wrap
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  94	train.full_determinism                       	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  95	train.generation_config
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  96	train.generation_max_length                  	640
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  97	train.generation_num_beams                   	1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  98	train.gradient_accumulation_steps            	8
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇  99	train.gradient_checkpointing                 	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 100	train.gradient_checkpointing_kwargs
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 101	train.greater_is_better                      	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 102	train.group_by_length                        	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 103	train.half_precision_backend                 	auto
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 104	train.hub_always_push                        	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 105	train.hub_model_id
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 106	train.hub_private_repo
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 107	train.hub_strategy                           	HubStrategy.EVERY_SAVE
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 108	train.hub_token
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 109	train.ignore_data_skip                       	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 110	train.include_for_metrics                    	[]
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 111	train.include_inputs_for_metrics             	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 112	train.include_num_input_tokens_seen          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 113	train.include_tokens_per_second              	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 114	train.jit_mode_eval                          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 115	train.label_names
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 116	train.label_smoothing_factor                 	0.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 117	train.learning_rate                          	5e-05
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 118	train.length_column_name                     	length
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 119	train.load_best_model_at_end                 	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 120	train.local_rank                             	0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 121	train.log_level                              	warning
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 122	train.log_level_replica                      	error
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 123	train.log_on_each_node                       	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 124	train.logging_dir                            	output/GNER-supervised/EAGLE-3B-BL/runs/Feb22_09-24-04_dgx-a100
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 125	train.logging_epochs                         	-1.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 126	train.logging_first_step                     	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 127	train.logging_nan_inf_filter                 	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 128	train.logging_steps                          	5
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 129	train.logging_strategy                       	IntervalStrategy.STEPS
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 130	train.lr_scheduler_kwargs                    	{}
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 131	train.lr_scheduler_type                      	SchedulerType.COSINE
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 132	train.max_grad_norm                          	1.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 133	train.max_steps                              	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 134	train.metric_for_best_model                  	eval_average
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 135	train.mp_parameters
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 136	train.neftune_noise_alpha
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 137	train.no_cuda                                	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 138	train.num_train_epochs                       	12.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 139	train.optim                                  	OptimizerNames.ADAMW_TORCH
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 140	train.optim_args
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 141	train.optim_target_modules
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 142	train.output_dir                             	output/GNER-supervised/EAGLE-3B-BL
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 143	train.overwrite_output_dir                   	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 144	train.past_index                             	-1
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 145	train.per_device_eval_batch_size             	16
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 146	train.per_device_train_batch_size            	4
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 147	train.per_gpu_eval_batch_size
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 148	train.per_gpu_train_batch_size
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 149	train.predict_with_generate                  	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 150	train.prediction_loss_only                   	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 151	train.push_to_hub                            	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 152	train.push_to_hub_model_id
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 153	train.push_to_hub_organization
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 154	train.push_to_hub_token
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 155	train.ray_scope                              	last
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 156	train.remove_unused_columns                  	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 157	train.report_to                              	['tensorboard']
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 158	train.restore_callback_states_from_checkpoint	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 159	train.resume_from_checkpoint
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 160	train.run_name                               	output/GNER-supervised/EAGLE-3B-BL
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 161	train.save_epochs                            	0.5
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 162	train.save_on_each_node                      	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 163	train.save_only_model                        	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 164	train.save_safetensors                       	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 165	train.save_steps                             	9223372036854775807
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 166	train.save_strategy                          	SaveStrategy.NO
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 167	train.save_total_limit                       	2
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 168	train.seed                                   	7
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 169	train.skip_memory_metrics                    	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 170	train.sortish_sampler                        	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 171	train.split_batches
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 172	train.tf32                                   	True
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 173	train.torch_compile                          	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 174	train.torch_compile_backend
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 175	train.torch_compile_mode
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 176	train.torch_empty_cache_steps
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 177	train.torchdynamo
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 178	train.tpu_metrics_debug                      	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 179	train.tpu_num_cores
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 180	train.use_cpu                                	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 181	train.use_flash_attention                    	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 182	train.use_ipex                               	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 183	train.use_legacy_prediction_loop             	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 184	train.use_liger_kernel                       	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 185	train.use_mps_device                         	False
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 186	train.warmup_ratio                           	0.04
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 187	train.warmup_steps                           	0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ 188	train.weight_decay                           	0.0
[02.22 09:24:13] ┇ INFO    ┇           chrisbase.data ┇ -----------------------------------------------------------------------------------------------------------------------------------------
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.78s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.90s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.91s/it]
Loading checkpoint shards: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:15<00:00,  7.87s/it]
[02.22 09:24:30] ┇ INFO    ┇                     gner ┇ model type: <class 'transformers.models.llama.modeling_llama.LlamaForCausalLM'>
[02.22 09:24:30] ┇ INFO    ┇                     gner ┇ model pad_token_id: 3
[02.22 09:24:32] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   0%|                    |      4/143180 [0:00:01<12:11:58, 3.26Hz]
[02.22 09:24:34] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   5%|▉                   |   6712/143180 [0:00:03<0:00:46, 2943.26Hz]
[02.22 09:24:36] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:   9%|█▊                  |  12764/143180 [0:00:05<0:00:37, 3514.63Hz]
[02.22 09:24:38] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  14%|██▋                 |  19464/143180 [0:00:07<0:00:32, 3847.53Hz]
[02.22 09:24:40] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  18%|███▋                |  26084/143180 [0:00:09<0:00:26, 4405.25Hz]
[02.22 09:24:42] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  23%|████▋               |  33544/143180 [0:00:11<0:00:25, 4377.72Hz]
[02.22 09:24:44] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  29%|█████▊              |  41500/143180 [0:00:13<0:00:23, 4249.42Hz]
[02.22 09:24:46] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  34%|██████▊             |  48808/143180 [0:00:15<0:00:22, 4184.47Hz]
[02.22 09:24:48] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  39%|███████▊            |  56072/143180 [0:00:17<0:01:11, 1225.40Hz]
[02.22 09:24:50] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  45%|████████▉           |  64004/143180 [0:00:19<0:01:04, 1230.18Hz]
[02.22 09:24:52] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  50%|█████████▉          |  71464/143180 [0:00:21<0:00:17, 4118.32Hz]
[02.22 09:24:54] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  55%|██████████▉         |  78144/143180 [0:00:23<0:00:16, 3976.93Hz]
[02.22 09:24:56] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  59%|███████████▊        |  84964/143180 [0:00:25<0:00:14, 4063.01Hz]
[02.22 09:24:58] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  64%|████████████▊       |  92004/143180 [0:00:27<0:00:44, 1146.66Hz]
[02.22 09:25:00] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  69%|█████████████▉      |  99384/143180 [0:00:29<0:00:10, 4215.66Hz]
[02.22 09:25:02] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  74%|██████████████▊     | 106444/143180 [0:00:31<0:00:08, 4450.50Hz]
[02.22 09:25:04] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  80%|███████████████▉    | 113852/143180 [0:00:33<0:00:07, 4177.36Hz]
[02.22 09:25:06] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  85%|████████████████▉   | 121488/143180 [0:00:35<0:00:04, 4405.87Hz]
[02.22 09:25:08] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  91%|██████████████████▏ | 130388/143180 [0:00:37<0:00:02, 5049.86Hz]
[02.22 09:25:10] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset:  96%|███████████████████▎| 138004/143180 [0:00:39<0:00:01, 4908.31Hz]
[02.22 09:25:11] ┇ INFO    ┇                     gner ┇ Preprocess train_dataset: 100%|████████████████████| 143180/143180 [0:00:40<0:00:00, 4727.08Hz]
[02.22 09:25:13] ┇ INFO    ┇                     gner ┇ Completed preprocessing for train_dataset by etri-lirs/eagle-3b-preview at [02.22 09:25:12]
[02.22 09:25:16] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset:   0%|                    |    4/3600 [0:00:01<0:18:18, 3.27Hz]
[02.22 09:25:16] ┇ INFO    ┇                     gner ┇ Preprocess eval_dataset: 100%|████████████████████| 3600/3600 [0:00:01<0:00:00, 8820.86Hz]
[02.22 09:25:17] ┇ INFO    ┇                     gner ┇ Completed preprocessing for eval_dataset by etri-lirs/eagle-3b-preview at [02.22 09:25:16]
[02.22 09:25:18] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:   0%|                    |      4/124835 [0:00:01<10:41:21, 3.24Hz]
[02.22 09:25:20] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  10%|█▉                  |  12004/124835 [0:00:03<0:00:52, 2135.62Hz]
[02.22 09:25:22] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  20%|████                |  25360/124835 [0:00:05<0:00:12, 7926.38Hz]
[02.22 09:25:24] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  31%|██████▎             |  39052/124835 [0:00:07<0:00:11, 7562.31Hz]
[02.22 09:25:26] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  42%|████████▎           |  52004/124835 [0:00:09<0:00:33, 2176.64Hz]
[02.22 09:25:28] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  52%|██████████▍         |  65004/124835 [0:00:11<0:00:08, 7160.60Hz]
[02.22 09:25:30] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  62%|████████████▍       |  77520/124835 [0:00:13<0:00:06, 7508.46Hz]
[02.22 09:25:32] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  73%|██████████████▌     |  90520/124835 [0:00:15<0:00:04, 7729.11Hz]
[02.22 09:25:34] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  83%|████████████████▌   | 103672/124835 [0:00:17<0:00:02, 7161.81Hz]
[02.22 09:25:36] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset:  93%|██████████████████▌ | 116008/124835 [0:00:19<0:00:03, 2311.99Hz]
[02.22 09:25:38] ┇ INFO    ┇                     gner ┇ Preprocess pred_dataset: 100%|████████████████████| 124835/124835 [0:00:20<0:00:00, 7678.79Hz]
[02.22 09:25:39] ┇ INFO    ┇                     gner ┇ Completed preprocessing for pred_dataset by etri-lirs/eagle-3b-preview at [02.22 09:25:38]
[02.22 09:26:15] ┇ WARNING ┇                DeepSpeed ┇ Attempting to get learning rate from scheduler before it has started
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ -----------------------------------------------------------------------------------------------------------------------------------------
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ ***** Beginning Training *****
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Epochs       = 12.0
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Examples     = 143,180
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Batch Size   = 128 = 4 * 8 * 4
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Optim Steps  = 13,416 = 1,118 * 12.0
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Type   = llama
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Path   = etri-lirs/eagle-3b-preview
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Class  = LlamaForCausalLM
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Train Model Params = 3,103,869,440
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Trainer Callbacks  = DefaultFlowCallback, TensorBoardCallback, CustomProgressCallback
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Zero Optim Stage   = 2
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Examples      = 3,600
[02.22 09:26:15] ┇ INFO    ┇        gner.gner_trainer ┇ >> Eval Batch Size    = 64 = 16 * 4
[02.22 09:26:33] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |     5/13416 [0:00:17<13:16:09, 0.28Hz] | epoch=0.00, loss=1.318900
[02.22 09:26:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    10/13416 [0:00:33<12:39:12, 0.29Hz] | epoch=0.01, loss=0.541500
[02.22 09:27:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    15/13416 [0:00:49<12:19:33, 0.30Hz] | epoch=0.01, loss=0.175700
[02.22 09:27:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    20/13416 [0:01:06<12:18:56, 0.30Hz] | epoch=0.02, loss=0.104100
[02.22 09:27:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    25/13416 [0:01:22<12:16:32, 0.30Hz] | epoch=0.02, loss=0.082100
[02.22 09:27:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    30/13416 [0:01:38<12:15:19, 0.30Hz] | epoch=0.03, loss=0.068000
[02.22 09:28:10] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    35/13416 [0:01:55<12:15:02, 0.30Hz] | epoch=0.03, loss=0.059100
[02.22 09:28:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    40/13416 [0:02:11<12:12:14, 0.30Hz] | epoch=0.04, loss=0.053000
[02.22 09:28:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    45/13416 [0:02:27<12:10:05, 0.31Hz] | epoch=0.04, loss=0.047100
[02.22 09:28:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    50/13416 [0:02:44<12:11:57, 0.30Hz] | epoch=0.04, loss=0.043900
[02.22 09:29:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    55/13416 [0:03:00<12:09:07, 0.31Hz] | epoch=0.05, loss=0.037000
[02.22 09:29:31] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    60/13416 [0:03:16<12:08:31, 0.31Hz] | epoch=0.05, loss=0.036100
[02.22 09:29:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   0%|                    |    65/13416 [0:03:33<12:11:06, 0.30Hz] | epoch=0.06, loss=0.035800
[02.22 09:30:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    70/13416 [0:03:49<12:09:06, 0.31Hz] | epoch=0.06, loss=0.034700
[02.22 09:30:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    75/13416 [0:04:05<12:07:34, 0.31Hz] | epoch=0.07, loss=0.033100
[02.22 09:30:37] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|                    |    80/13416 [0:04:21<12:07:26, 0.31Hz] | epoch=0.07, loss=0.034900
[02.22 09:30:53] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    85/13416 [0:04:37<12:05:51, 0.31Hz] | epoch=0.08, loss=0.032400
[02.22 09:31:09] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    90/13416 [0:04:54<12:06:39, 0.31Hz] | epoch=0.08, loss=0.031500
[02.22 09:31:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |    95/13416 [0:05:11<12:08:43, 0.30Hz] | epoch=0.09, loss=0.032100
[02.22 09:31:43] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   100/13416 [0:05:27<12:07:34, 0.31Hz] | epoch=0.09, loss=0.029300
[02.22 09:31:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   105/13416 [0:05:44<12:07:05, 0.31Hz] | epoch=0.09, loss=0.029100
[02.22 09:32:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   110/13416 [0:06:00<12:06:35, 0.31Hz] | epoch=0.10, loss=0.026500
[02.22 09:32:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   115/13416 [0:06:17<12:07:20, 0.30Hz] | epoch=0.10, loss=0.026000
[02.22 09:32:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   120/13416 [0:06:34<12:07:39, 0.30Hz] | epoch=0.11, loss=0.026700
[02.22 09:33:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   125/13416 [0:06:50<12:07:01, 0.30Hz] | epoch=0.11, loss=0.026400
[02.22 09:33:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   130/13416 [0:07:06<12:07:05, 0.30Hz] | epoch=0.12, loss=0.022500
[02.22 09:33:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   135/13416 [0:07:22<12:06:16, 0.30Hz] | epoch=0.12, loss=0.026200
[02.22 09:33:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   140/13416 [0:07:39<12:06:19, 0.30Hz] | epoch=0.12, loss=0.027500
[02.22 09:34:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   145/13416 [0:07:55<12:05:44, 0.30Hz] | epoch=0.13, loss=0.025000
[02.22 09:34:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   150/13416 [0:08:11<12:05:05, 0.30Hz] | epoch=0.13, loss=0.023100
[02.22 09:34:43] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   155/13416 [0:08:27<12:04:02, 0.31Hz] | epoch=0.14, loss=0.024000
[02.22 09:34:59] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   160/13416 [0:08:44<12:03:44, 0.31Hz] | epoch=0.14, loss=0.023700
[02.22 09:35:15] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▏                   |   165/13416 [0:09:00<12:03:25, 0.31Hz] | epoch=0.15, loss=0.024700
[02.22 09:35:31] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   170/13416 [0:09:16<12:02:28, 0.31Hz] | epoch=0.15, loss=0.021700
[02.22 09:35:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   175/13416 [0:09:33<12:03:18, 0.31Hz] | epoch=0.16, loss=0.021300
[02.22 09:36:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   180/13416 [0:09:49<12:02:44, 0.31Hz] | epoch=0.16, loss=0.021400
[02.22 09:36:21] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   185/13416 [0:10:06<12:02:41, 0.31Hz] | epoch=0.17, loss=0.023000
[02.22 09:36:39] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   190/13416 [0:10:23<12:03:27, 0.30Hz] | epoch=0.17, loss=0.023800
[02.22 09:36:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   195/13416 [0:10:39<12:03:10, 0.30Hz] | epoch=0.17, loss=0.021200
[02.22 09:37:12] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   1%|▎                   |   200/13416 [0:10:56<12:03:20, 0.30Hz] | epoch=0.18, loss=0.021200
[02.22 09:37:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   205/13416 [0:11:12<12:02:46, 0.30Hz] | epoch=0.18, loss=0.022800
[02.22 09:37:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   210/13416 [0:11:29<12:02:13, 0.30Hz] | epoch=0.19, loss=0.020400
[02.22 09:38:01] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   215/13416 [0:11:45<12:01:57, 0.30Hz] | epoch=0.19, loss=0.023900
[02.22 09:38:17] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   220/13416 [0:12:01<12:01:28, 0.30Hz] | epoch=0.20, loss=0.022400
[02.22 09:38:33] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   225/13416 [0:12:17<12:00:41, 0.31Hz] | epoch=0.20, loss=0.022600
[02.22 09:38:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   230/13416 [0:12:33<12:00:18, 0.31Hz] | epoch=0.21, loss=0.021300
[02.22 09:39:06] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   235/13416 [0:12:50<12:00:23, 0.30Hz] | epoch=0.21, loss=0.023000
[02.22 09:39:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   240/13416 [0:13:06<11:59:50, 0.31Hz] | epoch=0.21, loss=0.019200
[02.22 09:39:39] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   245/13416 [0:13:23<11:59:58, 0.30Hz] | epoch=0.22, loss=0.021400
[02.22 09:39:55] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▎                   |   250/13416 [0:13:39<11:59:25, 0.31Hz] | epoch=0.22, loss=0.019600
[02.22 09:40:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   255/13416 [0:13:55<11:58:44, 0.31Hz] | epoch=0.23, loss=0.022000
[02.22 09:40:27] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   260/13416 [0:14:11<11:58:09, 0.31Hz] | epoch=0.23, loss=0.019600
[02.22 09:40:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   265/13416 [0:14:27<11:57:19, 0.31Hz] | epoch=0.24, loss=0.018100
[02.22 09:40:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   270/13416 [0:14:42<11:56:27, 0.31Hz] | epoch=0.24, loss=0.021600
[02.22 09:41:13] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   275/13416 [0:14:58<11:55:25, 0.31Hz] | epoch=0.25, loss=0.020600
[02.22 09:41:29] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   280/13416 [0:15:14<11:54:49, 0.31Hz] | epoch=0.25, loss=0.018500
[02.22 09:41:45] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   285/13416 [0:15:30<11:54:10, 0.31Hz] | epoch=0.26, loss=0.018600
[02.22 09:42:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   290/13416 [0:15:47<11:54:33, 0.31Hz] | epoch=0.26, loss=0.019300
[02.22 09:42:18] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   295/13416 [0:16:02<11:53:35, 0.31Hz] | epoch=0.26, loss=0.021900
[02.22 09:42:34] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   300/13416 [0:16:19<11:53:34, 0.31Hz] | epoch=0.27, loss=0.019400
[02.22 09:42:51] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   305/13416 [0:16:36<11:53:44, 0.31Hz] | epoch=0.27, loss=0.019800
[02.22 09:43:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   310/13416 [0:16:52<11:53:25, 0.31Hz] | epoch=0.28, loss=0.019800
[02.22 09:43:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   315/13416 [0:17:09<11:53:23, 0.31Hz] | epoch=0.28, loss=0.019200
[02.22 09:43:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   320/13416 [0:17:25<11:52:26, 0.31Hz] | epoch=0.29, loss=0.018800
[02.22 09:43:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   325/13416 [0:17:42<11:52:33, 0.31Hz] | epoch=0.29, loss=0.017700
[02.22 09:44:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   330/13416 [0:17:59<11:52:57, 0.31Hz] | epoch=0.29, loss=0.020700
[02.22 09:44:31] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   2%|▍                   |   335/13416 [0:18:16<11:52:44, 0.31Hz] | epoch=0.30, loss=0.020200
[02.22 09:44:47] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   340/13416 [0:18:32<11:52:25, 0.31Hz] | epoch=0.30, loss=0.017700
[02.22 09:45:03] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   345/13416 [0:18:48<11:51:53, 0.31Hz] | epoch=0.31, loss=0.017400
[02.22 09:45:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   350/13416 [0:19:05<11:52:04, 0.31Hz] | epoch=0.31, loss=0.020200
[02.22 09:45:36] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   355/13416 [0:19:21<11:51:34, 0.31Hz] | epoch=0.32, loss=0.018600
[02.22 09:45:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   360/13416 [0:19:36<11:51:00, 0.31Hz] | epoch=0.32, loss=0.016200
[02.22 09:46:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   365/13416 [0:19:52<11:50:14, 0.31Hz] | epoch=0.33, loss=0.017200
[02.22 09:46:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   370/13416 [0:20:09<11:50:20, 0.31Hz] | epoch=0.33, loss=0.017700
[02.22 09:46:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   375/13416 [0:20:25<11:50:19, 0.31Hz] | epoch=0.34, loss=0.017100
[02.22 09:46:57] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   380/13416 [0:20:41<11:49:15, 0.31Hz] | epoch=0.34, loss=0.018500
[02.22 09:47:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   385/13416 [0:20:58<11:49:32, 0.31Hz] | epoch=0.34, loss=0.017900
[02.22 09:47:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   390/13416 [0:21:15<11:49:41, 0.31Hz] | epoch=0.35, loss=0.019200
[02.22 09:47:47] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   395/13416 [0:21:32<11:50:00, 0.31Hz] | epoch=0.35, loss=0.018500
[02.22 09:48:04] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   400/13416 [0:21:48<11:49:59, 0.31Hz] | epoch=0.36, loss=0.017900
[02.22 09:48:20] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   405/13416 [0:22:04<11:49:21, 0.31Hz] | epoch=0.36, loss=0.016600
[02.22 09:48:36] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   410/13416 [0:22:20<11:48:12, 0.31Hz] | epoch=0.37, loss=0.018900
[02.22 09:48:53] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▌                   |   415/13416 [0:22:37<11:48:24, 0.31Hz] | epoch=0.37, loss=0.017100
[02.22 09:49:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   420/13416 [0:22:53<11:47:40, 0.31Hz] | epoch=0.38, loss=0.019600
[02.22 09:49:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   425/13416 [0:23:09<11:47:07, 0.31Hz] | epoch=0.38, loss=0.017800
[02.22 09:49:41] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   430/13416 [0:23:25<11:46:35, 0.31Hz] | epoch=0.39, loss=0.017100
[02.22 09:49:56] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   435/13416 [0:23:40<11:45:18, 0.31Hz] | epoch=0.39, loss=0.019100
[02.22 09:50:12] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   440/13416 [0:23:56<11:44:51, 0.31Hz] | epoch=0.39, loss=0.015900
[02.22 09:50:28] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   445/13416 [0:24:12<11:44:06, 0.31Hz] | epoch=0.40, loss=0.018700
[02.22 09:50:44] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   450/13416 [0:24:29<11:44:04, 0.31Hz] | epoch=0.40, loss=0.014900
[02.22 09:51:00] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   455/13416 [0:24:44<11:43:12, 0.31Hz] | epoch=0.41, loss=0.018500
[02.22 09:51:16] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   460/13416 [0:25:01<11:42:54, 0.31Hz] | epoch=0.41, loss=0.016500
[02.22 09:51:32] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   3%|▋                   |   465/13416 [0:25:17<11:42:43, 0.31Hz] | epoch=0.42, loss=0.017900
[02.22 09:51:49] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   470/13416 [0:25:33<11:42:38, 0.31Hz] | epoch=0.42, loss=0.017600
[02.22 09:52:05] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   475/13416 [0:25:50<11:42:27, 0.31Hz] | epoch=0.42, loss=0.017900
[02.22 09:52:22] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   480/13416 [0:26:06<11:42:16, 0.31Hz] | epoch=0.43, loss=0.018000
[02.22 09:52:38] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   485/13416 [0:26:22<11:42:20, 0.31Hz] | epoch=0.43, loss=0.018200
[02.22 09:52:54] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   490/13416 [0:26:38<11:41:12, 0.31Hz] | epoch=0.44, loss=0.019100
[02.22 09:53:11] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   495/13416 [0:26:55<11:41:17, 0.31Hz] | epoch=0.44, loss=0.016400
[02.22 09:53:26] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▋                   |   500/13416 [0:27:11<11:40:31, 0.31Hz] | epoch=0.45, loss=0.016800
[02.22 09:53:42] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   505/13416 [0:27:26<11:39:00, 0.31Hz] | epoch=0.45, loss=0.018000
[02.22 09:53:58] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   510/13416 [0:27:42<11:38:25, 0.31Hz] | epoch=0.46, loss=0.017300
[02.22 09:54:14] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   515/13416 [0:27:59<11:37:55, 0.31Hz] | epoch=0.46, loss=0.017400
[02.22 09:54:30] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   520/13416 [0:28:15<11:37:31, 0.31Hz] | epoch=0.47, loss=0.018000
[02.22 09:54:46] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   525/13416 [0:28:31<11:37:10, 0.31Hz] | epoch=0.47, loss=0.016500
[02.22 09:55:02] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   530/13416 [0:28:47<11:36:34, 0.31Hz] | epoch=0.47, loss=0.017300
[02.22 09:55:19] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   535/13416 [0:29:03<11:36:28, 0.31Hz] | epoch=0.48, loss=0.018800
[02.22 09:55:35] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   540/13416 [0:29:19<11:36:24, 0.31Hz] | epoch=0.48, loss=0.017600
[02.22 09:55:52] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   545/13416 [0:29:36<11:36:41, 0.31Hz] | epoch=0.49, loss=0.022900
[02.22 09:56:08] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   550/13416 [0:29:52<11:35:58, 0.31Hz] | epoch=0.49, loss=0.018400
[02.22 09:56:24] ┇ INFO    ┇        gner.gner_trainer ┇ [training]   4%|▊                   |   555/13416 [0:30:08<11:35:28, 0.31Hz] | epoch=0.50, loss=0.018200
[rank2]: Traceback (most recent call last):
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank2]:     AppTyper.run(main)
[rank2]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank2]:     app()
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank2]:     raise e
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank2]:     return get_command(self)(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank2]:     return self.main(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank2]:     return _main(
[rank2]:            ^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank2]:     rv = self.invoke(ctx)
[rank2]:          ^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank2]:     return ctx.invoke(self.callback, **ctx.params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank2]:     return __callback(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank2]:     return callback(**use_params)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank2]:     train_result: TrainOutput = trainer.train()
[rank2]:                                 ^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank2]:     return inner_training_loop(
[rank2]:            ^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank2]:     self._maybe_log_save_evaluate(
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank2]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank2]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank2]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank2]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank2]:     output = eval_loop(
[rank2]:              ^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 303, in evaluation_loop
[rank2]:     loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
[rank2]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 333, in prediction_step
[rank2]:     generated_tokens = self.model.generate(**generation_inputs, **gen_kwargs)
[rank2]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank2]:     return func(*args, **kwargs)
[rank2]:            ^^^^^^^^^^^^^^^^^^^^^
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 2080, in generate
[rank2]:     self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
[rank2]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 1416, in _validate_generated_length
[rank2]:     raise ValueError(
[rank2]: ValueError: Input length of input_ids is 868, but `max_length` is set to 640. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
[rank3]: Traceback (most recent call last):
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank3]:     AppTyper.run(main)
[rank3]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank3]:     app()
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank3]:     raise e
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank3]:     return get_command(self)(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank3]:     return self.main(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank3]:     return _main(
[rank3]:            ^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank3]:     rv = self.invoke(ctx)
[rank3]:          ^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank3]:     return ctx.invoke(self.callback, **ctx.params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank3]:     return __callback(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank3]:     return callback(**use_params)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank3]:     train_result: TrainOutput = trainer.train()
[rank3]:                                 ^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank3]:     return inner_training_loop(
[rank3]:            ^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank3]:     self._maybe_log_save_evaluate(
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank3]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank3]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank3]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank3]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank3]:     output = eval_loop(
[rank3]:              ^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 303, in evaluation_loop
[rank3]:     loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
[rank3]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 333, in prediction_step
[rank3]:     generated_tokens = self.model.generate(**generation_inputs, **gen_kwargs)
[rank3]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank3]:     return func(*args, **kwargs)
[rank3]:            ^^^^^^^^^^^^^^^^^^^^^
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 2080, in generate
[rank3]:     self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
[rank3]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 1416, in _validate_generated_length
[rank3]:     raise ValueError(
[rank3]: ValueError: Input length of input_ids is 657, but `max_length` is set to 640. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
[rank1]: Traceback (most recent call last):
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 758, in <module>
[rank1]:     AppTyper.run(main)
[rank1]:   File "/raid/chrisjihee/proj/GNER/chrisbase/src/chrisbase/data.py", line 48, in run
[rank1]:     app()
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 340, in __call__
[rank1]:     raise e
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 323, in __call__
[rank1]:     return get_command(self)(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1161, in __call__
[rank1]:     return self.main(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 680, in main
[rank1]:     return _main(
[rank1]:            ^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/core.py", line 198, in _main
[rank1]:     rv = self.invoke(ctx)
[rank1]:          ^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 1443, in invoke
[rank1]:     return ctx.invoke(self.callback, **ctx.params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/click/core.py", line 788, in invoke
[rank1]:     return __callback(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/typer/main.py", line 698, in wrapper
[rank1]:     return callback(**use_params)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/finetune.py", line 734, in main
[rank1]:     train_result: TrainOutput = trainer.train()
[rank1]:                                 ^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2184, in train
[rank1]:     return inner_training_loop(
[rank1]:            ^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2554, in _inner_training_loop
[rank1]:     self._maybe_log_save_evaluate(
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 3027, in _maybe_log_save_evaluate
[rank1]:     metrics = self._evaluate(trial, ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 2981, in _evaluate
[rank1]:     metrics = self.evaluate(ignore_keys=ignore_keys_for_eval)
[rank1]:               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 197, in evaluate
[rank1]:     return super().evaluate(eval_dataset, ignore_keys=ignore_keys, metric_key_prefix=metric_key_prefix)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer.py", line 4001, in evaluate
[rank1]:     output = eval_loop(
[rank1]:              ^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/gner/gner_trainer.py", line 303, in evaluation_loop
[rank1]:     loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
[rank1]:                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/trainer_seq2seq.py", line 333, in prediction_step
[rank1]:     generated_tokens = self.model.generate(**generation_inputs, **gen_kwargs)
[rank1]:                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/miniforge3/envs/GNER/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
[rank1]:     return func(*args, **kwargs)
[rank1]:            ^^^^^^^^^^^^^^^^^^^^^
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 2080, in generate
[rank1]:     self._validate_generated_length(generation_config, input_ids_length, has_default_max_length)
[rank1]:   File "/raid/chrisjihee/proj/GNER/transformers/src/transformers/generation/utils.py", line 1416, in _validate_generated_length
[rank1]:     raise ValueError(
[rank1]: ValueError: Input length of input_ids is 752, but `max_length` is set to 640. This can lead to unexpected behavior. You should consider increasing `max_length` or, better yet, setting `max_new_tokens`.
[2025-02-22 09:56:39,804] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3732353
[2025-02-22 09:56:40,300] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3732354
[2025-02-22 09:56:40,339] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3732355
[2025-02-22 09:56:40,339] [INFO] [launch.py:319:sigkill_handler] Killing subprocess 3732356
[2025-02-22 09:56:40,377] [ERROR] [launch.py:325:sigkill_handler] ['/raid/chrisjihee/miniforge3/envs/GNER/bin/python', '-u', 'finetune.py', '--local_rank=3', '--data_config_dir', 'configs/dataset/supervised', '--output_file', 'train-metrics-united-12ep.csv', '--logging_file', 'train-loggings-united-12ep.out', '--output_name', 'GNER-supervised', '--run_version', 'EAGLE-3B-BL', '--pretrained', 'etri-lirs/eagle-3b-preview', '--trainer_deepspeed', 'configs/deepspeed/ds2_llama.json', '--num_train_epochs', '12', '--eval_epochs', '0.5', '--save_epochs', '0.5', '--learning_rate', '5e-05', '--logging_steps', '5', '--per_device_eval_batch_size', '16', '--per_device_train_batch_size', '4', '--gradient_accumulation_steps', '8', '--generation_max_length', '640', '--save_total_limit', '2', '--metric_for_best_model', 'eval_average', '--no_use_flash_attention', '--no_debugging'] exits with return code = 1




(GNER) chrisjihee@dgx-a100:~/proj/GNER$
